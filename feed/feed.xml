<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
	<title>Cutreblog</title>
	<subtitle>Blog de Alejandro Montes</subtitle>
	
	<link href="https://reeseschultz.github.io/feed/feed.xml" rel="self"/>
	<link href="https://reeseschultz.github.io"/>
	<updated>2023-01-19T00:00:00Z</updated>
	<id>https://example.com/</id>
	<author> 
		<name>Reese Schultz</name>
	</author>
	
	<entry>
		<title>Instalación y configuración inicial de OpenLDAP.</title>
		<link href="https://reeseschultz.github.io/post/instalacion-y-configuracion-inicial-de-openldap./"/>
		<updated>2023-01-19T00:00:00Z</updated>
		<id>https://reeseschultz.github.io/post/instalacion-y-configuracion-inicial-de-openldap./</id>
		<content type="html">&lt;h3 id=&quot;instalaci%C3%B3n-y-configuraci%C3%B3n-del-servidor-ldap.&quot; tabindex=&quot;-1&quot;&gt;Instalación y configuración del servidor LDAP.&lt;/h3&gt;
&lt;p&gt;Lo primero que debemos de hacer es asegurarnos de que tenemos el FQND configurado correctamente. En nuestro caso, en el escenario de OpenStack está configurado correctamente ya que tenemos instalado un servidor DNS. Muestro el hostname de Alfa:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;usuario@alfa:~$ hostname -f&lt;br /&gt;alfa.alejandro-montes.gonzalonazareno.org&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Una vez comprobado de que el FQDN está configurado correctamente, comenzaremos con la instalación:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;usuario@alfa:~$ sudo apt install slapd&lt;br /&gt;Reading package lists... Done&lt;br /&gt;Building dependency tree... Done&lt;br /&gt;Reading state information... Done&lt;br /&gt;The following additional packages will be installed:&lt;br /&gt;  ldap-utils libltdl7 libodbc1&lt;br /&gt;Suggested packages:&lt;br /&gt;  libsasl2-modules-gssapi-mit | libsasl2-modules-gssapi-heimdal&lt;br /&gt;  libmyodbc odbc-postgresql tdsodbc unixodbc-bin&lt;br /&gt;The following NEW packages will be installed:&lt;br /&gt;  ldap-utils libltdl7 libodbc1 slapd&lt;br /&gt;0 upgraded, 4 newly installed, 0 to remove and 1 not upgraded.&lt;br /&gt;Need to get 2270 kB of archives.&lt;br /&gt;After this operation, 6400 kB of additional disk space will be used.&lt;br /&gt;Do you want to continue? [Y/n] y&lt;br /&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Nos pedirá una contraseña para el usuario administrador de LDAP. Ahora instalaremos el siguiente paquete:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;usuario@alfa:~$ sudo apt install ldap-utils&lt;br /&gt;Reading package lists... Done&lt;br /&gt;Building dependency tree... Done&lt;br /&gt;Reading state information... Done&lt;br /&gt;ldap-utils is already the newest version (2.4.57+dfsg-3+deb11u1).&lt;br /&gt;ldap-utils set to manually installed.&lt;br /&gt;0 upgraded, 0 newly installed, 0 to remove and 1 not upgraded.&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;No se me ha instalado ldap-utils debido a que se me ha instalado como dependencia. Para verificar que está instalado, haremos una búsqueda con las credenciales de la instalación:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;usuario@alfa:~$ ldapsearch -x -D &quot;cn=admin,dc=alejandro-montes,dc=gonzalonazareno,dc=org&quot; -b &quot;dc=alejandro-montes,dc=gonzalonazareno,dc=org&quot; -W&lt;br /&gt;Enter LDAP Password: &lt;br /&gt;# extended LDIF&lt;br /&gt;#&lt;br /&gt;# LDAPv3&lt;br /&gt;# base &amp;lt;dc=alejandro-montes,dc=gonzalonazareno,dc=org&gt; with scope subtree&lt;br /&gt;# filter: (objectclass=*)&lt;br /&gt;# requesting: ALL&lt;br /&gt;#&lt;br /&gt;&lt;br /&gt;# alejandro-montes.gonzalonazareno.org&lt;br /&gt;dn: dc=alejandro-montes,dc=gonzalonazareno,dc=org&lt;br /&gt;objectClass: top&lt;br /&gt;objectClass: dcObject&lt;br /&gt;objectClass: organization&lt;br /&gt;o: alejandro-montes.gonzalonazareno.org&lt;br /&gt;dc: alejandro-montes&lt;br /&gt;&lt;br /&gt;# search result&lt;br /&gt;search: 2&lt;br /&gt;result: 0 Success&lt;br /&gt;&lt;br /&gt;# numResponses: 2&lt;br /&gt;# numEntries: 1&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Ahora, vamos a crear dos objetos, para ello crearemos el siguiente fichero:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;usuario@alfa:~$ nano unidades.ldif&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Y ponemos lo siguiente:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;dn: ou=Personas,dc=alejandro-montes,dc=gonzalonazareno,dc=org&lt;br /&gt;objectClass: organizationalUnit&lt;br /&gt;ou: Personas&lt;br /&gt;&lt;br /&gt;dn: ou=Grupos,dc=alejandro-montes,dc=gonzalonazareno,dc=org&lt;br /&gt;objectClass: organizationalUnit&lt;br /&gt;ou: Grupos&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Ejecutamos el siguiente comando para incluirlo en nuestro árbol de directorios:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;usuario@alfa:~$ ldapadd -x -D &quot;cn=admin,dc=alejandro-montes,dc=gonzalonazareno,dc=org&quot; -f unidades.ldif -W&lt;br /&gt;Enter LDAP Password: &lt;br /&gt;adding new entry &quot;ou=Personas,dc=alejandro-montes,dc=gonzalonazareno,dc=org&quot;&lt;br /&gt;&lt;br /&gt;adding new entry &quot;ou=Grupos,dc=alejandro-montes,dc=gonzalonazareno,dc=org&quot;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Ahora crearemos el siguiente fichero para crear un usuario:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;usuario@alfa:~$ nano usuarios.ldif&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Añadimos lo siguiente:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;dn: ou=usuario, dc=alejandro-montes, dc=gonzalonazareno, dc=org&lt;br /&gt;objectClass: top&lt;br /&gt;objectClass: posixAccount&lt;br /&gt;objectClass: inetOrgPerson&lt;br /&gt;objectClass: person&lt;br /&gt;cn: usuario&lt;br /&gt;uid: usuario&lt;br /&gt;uidNumber: 2000&lt;br /&gt;gidNumber: 2000&lt;br /&gt;homeDirectory: /home/users/pruebausuario&lt;br /&gt;loginShell: /bin/bash&lt;br /&gt;userPassword: usuario&lt;br /&gt;sn: apellido&lt;br /&gt;mail: pruebausuario@prueba.com&lt;br /&gt;givenName: usuario&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Ejecutamos el siguiente comando para añadir el usuario a LDAP:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;usuario@alfa:~$ ldapadd -x -D &quot;cn=admin,dc=alejandro-montes,dc=gonzalonazareno,dc=org&quot; -W -f usuario.ldif&lt;br /&gt;Enter LDAP Password: &lt;br /&gt;adding new entry &quot;ou=usuario, dc=alejandro-montes, dc=gonzalonazareno, dc=org&quot;&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&quot;configuraci%C3%B3n-y-prueba-de-cliente-ldap-en-rocky(bravo).&quot; tabindex=&quot;-1&quot;&gt;Configuración y prueba de cliente LDAP en Rocky(Bravo).&lt;/h3&gt;
&lt;p&gt;En el cliente(Bravo), después de actualizarlo, lo primero que haremos será instalar los paquetes necesarios:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;[usuario@bravo ~]$ sudo sudo dnf -y install openldap-clients sssd sssd-ldap oddjob-mkhomedir &lt;br /&gt;Failed to set locale, defaulting to C.UTF-8&lt;br /&gt;Last metadata expiration check: 2:38:22 ago on Thu Jan 19 10:54:03 2023.&lt;br /&gt;Package oddjob-mkhomedir-0.34.7-6.el9.x86_64 is already installed.&lt;br /&gt;Dependencies resolved.&lt;br /&gt;==========================================================================&lt;br /&gt; Package               Arch       Version                Repository  Size&lt;br /&gt;==========================================================================&lt;br /&gt;Installing:&lt;br /&gt; openldap-clients      x86_64     2.6.2-3.el9            baseos     174 k&lt;br /&gt; sssd                  x86_64     2.7.3-4.el9_1.1        baseos      27 k&lt;br /&gt; sssd-ldap             x86_64     2.7.3-4.el9_1.1        baseos     156 k&lt;br /&gt;Installing dependencies:&lt;br /&gt; avahi-libs            x86_64     0.8-12.el9             baseos      67 k&lt;br /&gt; cyrus-sasl-gssapi     x86_64     2.1.27-20.el9          baseos      26 k&lt;br /&gt; libipa_hbac           x86_64     2.7.3-4.el9_1.1        baseos      35 k&lt;br /&gt; libsmbclient          x86_64     4.16.4-101.el9         baseos      75 k&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Una vez se hayan instalados las dependencias,&lt;/p&gt;
&lt;hr /&gt;
&lt;h2 id=&quot;documento-realizado-por%3A&quot; tabindex=&quot;-1&quot;&gt;&lt;strong&gt;Documento realizado por:&lt;/strong&gt;&lt;/h2&gt;
&lt;p&gt;✒️ &lt;strong&gt;Alejandro Montes Delgado&lt;/strong&gt; - &lt;em&gt;2º ASIR&lt;/em&gt;&lt;/p&gt;
</content>
	</entry>
	
	<entry>
		<title>Servidores Web, Base de Datos y DNS en nuestros escenario de OpenStack</title>
		<link href="https://reeseschultz.github.io/post/servidores-web-base-de-datos-y-dns-en-nuestros-escenario-de-openstack/"/>
		<updated>2023-01-14T00:00:00Z</updated>
		<id>https://reeseschultz.github.io/post/servidores-web-base-de-datos-y-dns-en-nuestros-escenario-de-openstack/</id>
		<content type="html">&lt;h3 id=&quot;entrega-la-configuraci%C3%B3n-dns-de-cada-m%C3%A1quina.&quot; tabindex=&quot;-1&quot;&gt;Entrega la configuración DNS de cada máquina.&lt;/h3&gt;
&lt;p&gt;Para que la configuración sea persistente en todas las máquinas tendremos que hacer lo siguiente:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;usuario@alfa:~$ sudo nano /usr/lib/systemd/resolv.conf &lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;En este fichero, añadiremos la configuración dns para que al reiniciar se mantenga.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;h4 id=&quot;alfa.&quot; tabindex=&quot;-1&quot;&gt;Alfa.&lt;/h4&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;usuario@alfa:~$ cat /etc/resolv.conf&lt;br /&gt;&lt;br /&gt;nameserver 192.168.0.2&lt;br /&gt;search alejandro-montes.gonzalonazareno.org&lt;br /&gt;nameserver 172.16.202.2&lt;br /&gt;search openstacklocal&lt;/code&gt;&lt;/pre&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;h4 id=&quot;bravo.&quot; tabindex=&quot;-1&quot;&gt;Bravo.&lt;/h4&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;[usuario@bravo ~]$ cat /etc/resolv.conf &lt;br /&gt;&lt;br /&gt;nameserver 192.168.0.2&lt;br /&gt;search alejandro-montes.gonzalonazareno.org&lt;br /&gt;nameserver 172.16.202.2&lt;/code&gt;&lt;/pre&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;h4 id=&quot;charlie.&quot; tabindex=&quot;-1&quot;&gt;Charlie.&lt;/h4&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;ubuntu@charlie:~$ cat /etc/resolv.conf &lt;br /&gt;&lt;br /&gt;nameserver 192.168.0.2&lt;br /&gt;search alejandro-montes.gonzalonazareno.org&lt;br /&gt;nameserver 127.0.0.53&lt;br /&gt;options edns0 trust-ad&lt;br /&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;h4 id=&quot;delta.&quot; tabindex=&quot;-1&quot;&gt;Delta.&lt;/h4&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;ubuntu@delta:~$ cat /etc/resolv.conf &lt;br /&gt;&lt;br /&gt;nameserver 192.168.0.2&lt;br /&gt;search alejandro-montes.gonzalonazareno.org&lt;br /&gt;nameserver 127.0.0.53&lt;br /&gt;options edns0 trust-ad&lt;br /&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&quot;entrega-la-definici%C3%B3n-de-las-vistas-y-de-las-zonas.&quot; tabindex=&quot;-1&quot;&gt;Entrega la definición de las vistas y de las zonas.&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;h4 id=&quot;configuraci%C3%B3n-de-las-vistas.&quot; tabindex=&quot;-1&quot;&gt;Configuración de las vistas.&lt;/h4&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;view externa {&lt;br /&gt;                match-clients { 172.22.0.0/16; 172.29.0.0/16; 192.168.202.2/32; };&lt;br /&gt;                allow-recursion { any; };&lt;br /&gt;                zone &quot;alejandro-montes.gonzalonazareno.org&quot;&lt;br /&gt;                {&lt;br /&gt;                        type master;&lt;br /&gt;                        file &quot;db.externa.alejandro-montesgonzalonazareno.org&quot;;&lt;br /&gt;                };&lt;br /&gt;                include &quot;/etc/bind/zones.rfc1918&quot;;&lt;br /&gt;                include &quot;/etc/bind/named.conf.default-zones&quot;;&lt;br /&gt;};&lt;br /&gt;view dmz {&lt;br /&gt;                match-clients { 172.16.0.0/16; };&lt;br /&gt;                allow-recursion { any; };&lt;br /&gt;                zone &quot;alejandro-montes.gonzalonazareno.org&quot;&lt;br /&gt;                {&lt;br /&gt;                        type master;&lt;br /&gt;                        file &quot;db.dmz.alejandro-montes.gonzalonazareno.org&quot;;&lt;br /&gt;                };&lt;br /&gt;                zone &quot;16.172.in-addr.arpa&quot;&lt;br /&gt;                {&lt;br /&gt;                        type master;&lt;br /&gt;                        file &quot;db.16.172&quot;;&lt;br /&gt;                };&lt;br /&gt;                zone &quot;0.168.192.in-addr.arpa&quot;&lt;br /&gt;                {&lt;br /&gt;                        type master;&lt;br /&gt;                        file &quot;db.0.168.192&quot;;&lt;br /&gt;                };&lt;br /&gt;                include &quot;/etc/bind/zones.rfc1918&quot;;&lt;br /&gt;                include &quot;/etc/bind/named.conf.default-zones&quot;;&lt;br /&gt;};&lt;br /&gt;view interna {&lt;br /&gt;                match-clients { 192.168.0.0/24; 127.0.0.1; };&lt;br /&gt;                allow-recursion { any; };&lt;br /&gt;                zone &quot;alejandro-montes.gonzalonazareno.org&quot;&lt;br /&gt;                {&lt;br /&gt;                        type master;&lt;br /&gt;                        file &quot;db.interna.alejandro-montes.gonzalonazareno.org&quot;;&lt;br /&gt;                };&lt;br /&gt;                zone &quot;0.168.192.in-addr.arpa&quot;&lt;br /&gt;                {&lt;br /&gt;                        type master;&lt;br /&gt;                        file &quot;db.0.168.192&quot;;&lt;br /&gt;                };&lt;br /&gt;                zone &quot;16.172.in-addr.arpa&quot;&lt;br /&gt;                {&lt;br /&gt;                        type master;&lt;br /&gt;                        file &quot;db.16.172&quot;;&lt;br /&gt;                };&lt;br /&gt;                include &quot;/etc/bind/zones.rfc1918&quot;;&lt;br /&gt;                include &quot;/etc/bind/named.conf.default-zones&quot;;&lt;br /&gt;};&lt;/code&gt;&lt;/pre&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;h4 id=&quot;configuraci%C3%B3n-de-la-zona-externa.&quot; tabindex=&quot;-1&quot;&gt;Configuración de la zona externa.&lt;/h4&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;$TTL    86400&lt;br /&gt;@       IN      SOA     alfa.alejandro-montes.gonzalonazareno.org. root.alejandro-montes.gonzalonazareno.org. (&lt;br /&gt;                              1         ; Serial&lt;br /&gt;                         604800         ; Refresh&lt;br /&gt;                          86400         ; Retry&lt;br /&gt;                        2419200         ; Expire&lt;br /&gt;                          86400 )       ; Negative Cache TTL&lt;br /&gt;;&lt;br /&gt;@       IN      NS      alfa.alejandro-montes.gonzalonazareno.org.&lt;br /&gt;&lt;br /&gt;$ORIGIN alejandro-montes.gonzalonazareno.org.&lt;br /&gt;&lt;br /&gt;alfa                    IN      A       172.22.200.13&lt;br /&gt;dns                     IN      CNAME   alfa&lt;br /&gt;www                     IN      CNAME   alfa&lt;br /&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;h4 id=&quot;configuraci%C3%B3n-de-la-zona-dmz.&quot; tabindex=&quot;-1&quot;&gt;Configuración de la zona dmz.&lt;/h4&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;$TTL    86400&lt;br /&gt;@       IN      SOA     charlie.alejandro-montes.gonzalonazareno.org. root.charlie.alejandro-montes.gonzalonazareno.org. (&lt;br /&gt;                              1         ; Serial&lt;br /&gt;                         604800         ; Refresh&lt;br /&gt;                          86400         ; Retry&lt;br /&gt;                        2419200         ; Expire&lt;br /&gt;                          86400 )       ; Negative Cache TTL&lt;br /&gt;;&lt;br /&gt;@       IN      NS      charlie.alejandro-montes.gonzalonazareno.org.&lt;br /&gt;&lt;br /&gt;$ORIGIN alejandro-montes.gonzalonazareno.org.&lt;br /&gt;&lt;br /&gt;alfa                    IN      A       172.16.0.1&lt;br /&gt;bravo                   IN      A       172.16.0.200&lt;br /&gt;charlie                 IN      A       192.168.0.2&lt;br /&gt;delta                   IN      A       192.168.0.3&lt;br /&gt;www                     IN      CNAME   bravo&lt;br /&gt;bd                      IN      CNAME   delta&lt;br /&gt;dns                     IN      CNAME   charlie&lt;/code&gt;&lt;/pre&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;h4 id=&quot;configuraci%C3%B3n-de-la-zona-interna.&quot; tabindex=&quot;-1&quot;&gt;Configuración de la zona Interna.&lt;/h4&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;$TTL    86400&lt;br /&gt;@       IN      SOA     charlie.alejandro-montes.gonzalonazareno.org. root.charlie.alejandro-montes.gonzalonazareno.org. (&lt;br /&gt;                              1         ; Serial&lt;br /&gt;                         604800         ; Refresh&lt;br /&gt;                          86400         ; Retry&lt;br /&gt;                        2419200         ; Expire&lt;br /&gt;                          86400 )       ; Negative Cache TTL&lt;br /&gt;;&lt;br /&gt;@       IN      NS      charlie.alejandro-montes.gonzalonazareno.org.&lt;br /&gt;&lt;br /&gt;$ORIGIN alejandro-montes.gonzalonazareno.org.&lt;br /&gt;&lt;br /&gt;alfa                    IN      A       192.168.0.1&lt;br /&gt;bravo                   IN      A       172.16.0.200&lt;br /&gt;charlie                 IN      A       192.168.0.2&lt;br /&gt;delta                   IN      A       192.168.0.3&lt;br /&gt;www                     IN      CNAME   bravo&lt;br /&gt;bd                      IN      CNAME   delta&lt;br /&gt;dns                     IN      CNAME   charlie&lt;br /&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;h4 id=&quot;configuraci%C3%B3n-de-la-zona-dmz-inversa.&quot; tabindex=&quot;-1&quot;&gt;Configuración de la zona DMZ inversa.&lt;/h4&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;$TTL    86400&lt;br /&gt;@       IN      SOA     charlie.alejandro-montes.gonzalonazareno.org. root.alejandro-montes.gonzalonazareno.org. (&lt;br /&gt;                              1         ; Serial&lt;br /&gt;                         604800         ; Refresh&lt;br /&gt;                          86400         ; Retry&lt;br /&gt;                        2419200         ; Expire&lt;br /&gt;                          86400 )       ; Negative Cache TTL&lt;br /&gt;;&lt;br /&gt;@       IN      NS              charlie.alejandro-montes.gonzalonazareno.org.&lt;br /&gt;&lt;br /&gt;$ORIGIN 16.172.in-addr.arpa.&lt;br /&gt;&lt;br /&gt;200.0                   IN      PTR             bravo.alejandro-montes.gonzalonazareno.org.&lt;/code&gt;&lt;/pre&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;h4 id=&quot;configuraci%C3%B3n-de-la-zona-interna-inversa.&quot; tabindex=&quot;-1&quot;&gt;Configuración de la zona interna inversa.&lt;/h4&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;$TTL    86400&lt;br /&gt;@       IN      SOA     charlie.alejandro-montes.gonzalonazareno.org. root.alejandro-montes.gonzalonazareno.org. (&lt;br /&gt;                              1         ; Serial&lt;br /&gt;                         604800         ; Refresh&lt;br /&gt;                          86400         ; Retry&lt;br /&gt;                        2419200         ; Expire&lt;br /&gt;                          86400 )       ; Negative Cache TTL&lt;br /&gt;;&lt;br /&gt;@       IN      NS              charlie.alejandro-montes.gonzalonazareno.org.&lt;br /&gt;&lt;br /&gt;$ORIGIN 0.168.192.in-addr.arpa.&lt;br /&gt;&lt;br /&gt;1                       IN      PTR             alfa.alejandro-montes.gonzalonazareno.org.&lt;br /&gt;2                       IN      PTR             charlie.alejandro-montes.gonzalonazareno.org.&lt;br /&gt;3                       IN      PTR             delta.alejandro-montes.gonzalonazareno.org.&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&quot;entrega-el-resultado-de-las-siguientes-consultas-desde-una-m%C3%A1quina-interna-a-nuestra-red-y-otro-externo%3A&quot; tabindex=&quot;-1&quot;&gt;Entrega el resultado de las siguientes consultas desde una máquina interna a nuestra red y otro externo:&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;h4 id=&quot;el-servidor-dns-con-autoridad-sobre-la-zona-del-dominio-tu_nombre.gonzalonazareno.org.&quot; tabindex=&quot;-1&quot;&gt;El servidor DNS con autoridad sobre la zona del dominio tu_nombre.gonzalonazareno.org.&lt;/h4&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;El comando es el siguiente:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;dig ns alejandro-montes.gonzalonazareno.org&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Desde alfa(Red Interna):&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://reeseschultz.github.io/img/SRI-P7.4.png&quot; alt=&quot;SRI-P7.4.png&quot; /&gt;&lt;/p&gt;
&lt;p&gt;Desde bravo(Red DMZ):&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://reeseschultz.github.io/img/SRI-P7.2.png&quot; alt=&quot;SRI-P7.2.png&quot; /&gt;&lt;/p&gt;
&lt;p&gt;Desde mi portátil:&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://reeseschultz.github.io/img/SRI-P7.3.png&quot; alt=&quot;SRI-P7.3.png&quot; /&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;h4 id=&quot;la-direcci%C3%B3n-ip-de-alfa.&quot; tabindex=&quot;-1&quot;&gt;La dirección IP de alfa.&lt;/h4&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;El comando es el siguiente:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;dig alfa.alejandro-montes.gonzalonazareno.org&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Desde alfa(Red Interna):&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://reeseschultz.github.io/img/SRI-P7.5.png&quot; alt=&quot;SRI-P7.5.png&quot; /&gt;&lt;/p&gt;
&lt;p&gt;Desde bravo(Red DMZ):&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://reeseschultz.github.io/img/SRI-P7.6.png&quot; alt=&quot;SRI-P7.6.png&quot; /&gt;&lt;/p&gt;
&lt;p&gt;Desde mi portátil:&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://reeseschultz.github.io/img/SRI-P7.7.png&quot; alt=&quot;SRI-P7.7.png&quot; /&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;h4 id=&quot;una-resoluci%C3%B3n-de-www.&quot; tabindex=&quot;-1&quot;&gt;Una resolución de www.&lt;/h4&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;El comando es el siguiente:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;dig www.alejandro-montes.gonzalonazareno.org&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Desde alfa(Red Interna):&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://reeseschultz.github.io/img/SRI-P7.8.png&quot; alt=&quot;SRI-P7.8.png&quot; /&gt;&lt;/p&gt;
&lt;p&gt;Desde bravo(Red DMZ):&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://reeseschultz.github.io/img/SRI-P7.9.png&quot; alt=&quot;SRI-P7.9.png&quot; /&gt;&lt;/p&gt;
&lt;p&gt;Desde mi portátil:&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://reeseschultz.github.io/img/SRI-P7.10.png&quot; alt=&quot;SRI-P7.10.png&quot; /&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;h4 id=&quot;una-resoluci%C3%B3n-de-bd.&quot; tabindex=&quot;-1&quot;&gt;Una resolución de bd.&lt;/h4&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;El comando es el siguiente:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;dig bd.alejandro-montes.gonzalonazareno.org&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Desde alfa(Red Interna):&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://reeseschultz.github.io/img/SRI-P7.11.png&quot; alt=&quot;SRI-P7.11.png&quot; /&gt;&lt;/p&gt;
&lt;p&gt;Desde bravo(Red DMZ):&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://reeseschultz.github.io/img/SRI-P7.12.png&quot; alt=&quot;SRI-P7.12.png&quot; /&gt;&lt;/p&gt;
&lt;p&gt;Desde mi portátil:&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://reeseschultz.github.io/img/SRI-P7.13.png&quot; alt=&quot;SRI-P7.13.png&quot; /&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;h4 id=&quot;un-resoluci%C3%B3n-inversa-de-ip-fija-en-cada-una-de-las-redes.-(esta-consulta-s%C3%B3lo-funcionar%C3%A1-desde-una-m%C3%A1quina-interna).&quot; tabindex=&quot;-1&quot;&gt;Un resolución inversa de IP fija en cada una de las redes. (Esta consulta sólo funcionará desde una máquina interna).&lt;/h4&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;El comando es el siguiente:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;dig -x 0.0.0.0&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Desde alfa(Red Interna) a la red interna:&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://reeseschultz.github.io/img/SRI-P7.14.png&quot; alt=&quot;SRI-P7.14.png&quot; /&gt;&lt;/p&gt;
&lt;p&gt;Desde alfa(Red Interna) a la red dmz:&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://reeseschultz.github.io/img/SRI-P7.15.png&quot; alt=&quot;SRI-P7.15.png&quot; /&gt;&lt;/p&gt;
&lt;p&gt;Desde bravo(Red DMZ) a la red interna:&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://reeseschultz.github.io/img/SRI-P7.16.png&quot; alt=&quot;SRI-P7.16.png&quot; /&gt;&lt;/p&gt;
&lt;p&gt;Desde bravo(Red DMZ) a la red dmz:&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://reeseschultz.github.io/img/SRI-P7.17.png&quot; alt=&quot;SRI-P7.17.png&quot; /&gt;&lt;/p&gt;
&lt;h3 id=&quot;entrega-una-captura-de-pantalla-accediendo-a-www.tunombre.gonzalonazareno.org%2Finfo.php-donde-se-vea-la-salida-del-fichero-info.php.&quot; tabindex=&quot;-1&quot;&gt;Entrega una captura de pantalla accediendo a &lt;a href=&quot;http://www.tunombre.gonzalonazareno.org/info.php&quot;&gt;www.tunombre.gonzalonazareno.org/info.php&lt;/a&gt; donde se vea la salida del fichero info.php.&lt;/h3&gt;
&lt;p&gt;&lt;img src=&quot;https://reeseschultz.github.io/img/SRI-P7.18.png&quot; alt=&quot;SRI-P7.18.png&quot; /&gt;&lt;/p&gt;
&lt;h3 id=&quot;entrega-una-prueba-de-funcionamiento-donde-se-vea-como-se-realiza-una-conexi%C3%B3n-a-la-base-de-datos-desde-bravo.&quot; tabindex=&quot;-1&quot;&gt;Entrega una prueba de funcionamiento donde se vea como se realiza una conexión a la base de datos desde bravo.&lt;/h3&gt;
&lt;p&gt;Desde Bravo, conecto al servidor de bases de datos usando el CNAME &lt;code&gt;bd&lt;/code&gt; de delta:&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://reeseschultz.github.io/img/SRI-P7.1.png&quot; alt=&quot;SRI-P7.1.png&quot; /&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;h2 id=&quot;documento-realizado-por%3A&quot; tabindex=&quot;-1&quot;&gt;&lt;strong&gt;Documento realizado por:&lt;/strong&gt;&lt;/h2&gt;
&lt;p&gt;✒️ &lt;strong&gt;Alejandro Montes Delgado&lt;/strong&gt; - &lt;em&gt;2º ASIR&lt;/em&gt;&lt;/p&gt;
</content>
	</entry>
	
	<entry>
		<title>Configurar servidor VPN en OpenVPN y WireGuard.</title>
		<link href="https://reeseschultz.github.io/post/configurar-servidor-vpn-en-openvpn-y-wireguard./"/>
		<updated>2023-01-10T00:00:00Z</updated>
		<id>https://reeseschultz.github.io/post/configurar-servidor-vpn-en-openvpn-y-wireguard./</id>
		<content type="html">&lt;h3 id=&quot;openvpn&quot; tabindex=&quot;-1&quot;&gt;OpenVPN&lt;/h3&gt;
&lt;h4 id=&quot;1.1.-vpn-de-acceso-remoto-con-openvpn-y-certificados-x509.-(5-puntos)&quot; tabindex=&quot;-1&quot;&gt;1.1. VPN de acceso remoto con OpenVPN y certificados x509. (5 puntos)&lt;/h4&gt;
&lt;p&gt;&lt;strong&gt;Configura una conexión VPN de acceso remoto entre dos equipos del cloud:&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Uno de los dos equipos (el que actuará como servidor) estará conectado a dos redes&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Para la autenticación de los extremos se usarán obligatoriamente certificados digitales, que se generarán utilizando openssl y se almacenarán en el directorio /etc/openvpn, junto con  los parámetros Diffie-Helman y el certificado de la propia Autoridad de Certificación.&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Se utilizarán direcciones de la red 10.99.99.0/24 para las direcciones virtuales de la VPN. La dirección 10.99.99.1 se asignará al servidor VPN.&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Los ficheros de configuración del servidor y del cliente se crearán en el directorio /etc/openvpn de cada máquina, y se llamarán servidor.conf y cliente.conf respectivamente.&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Tras el establecimiento de la VPN, la máquina cliente debe ser capaz de acceder a una máquina que esté en la otra red a la que está conectado el servidor.&lt;/strong&gt;
&lt;strong&gt;Documenta el proceso detalladamente.&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Antes que nada, tendremos que tener un escenario donde realizaremos la práctica. Crearé dos instancias en OpenStack, y el equipo servidor estará conectado a 2 redes distintas.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://reeseschultz.github.io/img/SAD-P6.1.png&quot; alt=&quot;SAD-P6.1.png&quot; /&gt;&lt;/p&gt;
&lt;p&gt;Una vez creado el escenario, empezaremos con la práctica.&lt;/p&gt;
&lt;h5 id=&quot;configuraci%C3%B3n-del-servidor.&quot; tabindex=&quot;-1&quot;&gt;Configuración del servidor.&lt;/h5&gt;
&lt;p&gt;Lo primero que haremos será instalar openvpn.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://reeseschultz.github.io/img/SAD-P6.2.png&quot; alt=&quot;SAD-P6.2.png&quot; /&gt;&lt;/p&gt;
&lt;p&gt;Ahora, activaremos el bit de forwarding en el servidor.&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;root@servidor-vpn:~$  nano /etc/sysctl.conf&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;editamos la siguiente línea:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;# Uncomment the next line to enable packet forwarding for IPv4&lt;br /&gt;net.ipv4.ip_forward=1&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Por precaución, copiaremos la configuración que se encuentra en &lt;code&gt;/usr/share/easy-rsa&lt;/code&gt; a &lt;code&gt;/etc/openvpn&lt;/code&gt; para evitar que en una próxima actualización del paquete sobreescriba los cambios que hagamos:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;root@servidor-vpn:~$  cp -r /usr/share/easy-rsa /etc/openvpn&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Ahora dentro del directorio &lt;code&gt;/etc/openvpn/easy-rsa/&lt;/code&gt;, ejecutaremos el siguiente script para inicializar el directorio PKI:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;root@servidor-vpn:/etc/openvpn/easy-rsa# ./easyrsa init-pki&lt;br /&gt;&lt;br /&gt;init-pki complete; you may now create a CA or requests.&lt;br /&gt;Your newly created PKI dir is: /etc/openvpn/easy-rsa/pki&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;A continuación, vamos a generar el certificado de la CA y la clave con la que firmaremos los certificados. Tendremos que introducir una contraseña para el certificado y un nombre para la autoridad certificadora.&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;root@servidor-vpn:/etc/openvpn/easy-rsa# ./easyrsa build-ca&lt;br /&gt;Using SSL: openssl OpenSSL 1.1.1n  15 Mar 2022&lt;br /&gt;&lt;br /&gt;Enter New CA Key Passphrase: &lt;br /&gt;Re-Enter New CA Key Passphrase: &lt;br /&gt;Generating RSA private key, 2048 bit long modulus (2 primes)&lt;br /&gt;..............+++++&lt;br /&gt;................................+++++&lt;br /&gt;e is 65537 (0x010001)&lt;br /&gt;You are about to be asked to enter information that will be incorporated&lt;br /&gt;into your certificate request.&lt;br /&gt;What you are about to enter is what is called a Distinguished Name or a DN.&lt;br /&gt;There are quite a few fields but you can leave some blank&lt;br /&gt;For some fields there will be a default value,&lt;br /&gt;If you enter &#39;.&#39;, the field will be left blank.&lt;br /&gt;-----&lt;br /&gt;Common Name (eg: your user, host, or server name) [Easy-RSA CA]:alejandro-montes&lt;br /&gt;&lt;br /&gt;CA creation complete and you may now import and sign cert requests.&lt;br /&gt;Your new CA certificate file for publishing is at:&lt;br /&gt;/etc/openvpn/easy-rsa/pki/ca.crt&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Como indica la salida del comando, el certificado se ha generado en la ruta &lt;code&gt;/etc/openvpn/easy-rsa/pki/ca.crt&lt;/code&gt; mientras que la clave privada se encuentra en &lt;code&gt;/etc/openvpn/easy-rsa/pki/private/ca.key&lt;/code&gt;. Ahora tendremos que generar los parámetros Diffie-Hellman, los cuáles se usan para el intercambio de claves entre el servidor de openvpn y los clientes.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://reeseschultz.github.io/img/SAD-P6.3.png&quot; alt=&quot;SAD-P6.3.png&quot; /&gt;&lt;/p&gt;
&lt;p&gt;El archivo ha sido generado en el directorio &lt;code&gt;/etc/openvpn/easy-rsa/pki/dh.pem&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Ahora generaremos el certificado y la clave privada del servidor openvpn:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;root@servidor-vpn:/etc/openvpn/easy-rsa# ./easyrsa build-server-full server nopass&lt;br /&gt;Using SSL: openssl OpenSSL 1.1.1n  15 Mar 2022&lt;br /&gt;Generating a RSA private key&lt;br /&gt;.........................+++++&lt;br /&gt;.......................+++++&lt;br /&gt;writing new private key to &#39;/etc/openvpn/easy-rsa/pki/easy-rsa-22061.NS9Bww/tmp.gmhUC5&#39;&lt;br /&gt;-----&lt;br /&gt;Using configuration from /etc/openvpn/easy-rsa/pki/easy-rsa-22061.NS9Bww/tmp.xcbWer&lt;br /&gt;Enter pass phrase for /etc/openvpn/easy-rsa/pki/private/ca.key:&lt;br /&gt;Check that the request matches the signature&lt;br /&gt;Signature ok&lt;br /&gt;The Subject&#39;s Distinguished Name is as follows&lt;br /&gt;commonName            :ASN.1 12:&#39;server&#39;&lt;br /&gt;Certificate is to be certified until Apr 17 11:03:08 2025 GMT (825 days)&lt;br /&gt;&lt;br /&gt;Write out database with 1 new entries&lt;br /&gt;Data Base Updated&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;El certificado ha sido guardado en la ruta &lt;code&gt;/etc/openvpn/easy-rsa/pki/issued/server.crt&lt;/code&gt; y la clave privada se ha generado en &lt;code&gt;/etc/openvpn/easy-rsa/pki/private/server.key&lt;/code&gt;. La opción nopass es para deshabilitar la frase de paso.&lt;/p&gt;
&lt;p&gt;Una vez hecho esto, generaremos el certificado y la clave privada del cliente de la vpn:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;root@servidor-vpn:/etc/openvpn/easy-rsa# ./easyrsa build-client-full cliente-vpn nopass&lt;br /&gt;Using SSL: openssl OpenSSL 1.1.1n  15 Mar 2022&lt;br /&gt;Generating a RSA private key&lt;br /&gt;.................................+++++&lt;br /&gt;..........+++++&lt;br /&gt;writing new private key to &#39;/etc/openvpn/easy-rsa/pki/easy-rsa-22138.MZyJbQ/tmp.MWGIDo&#39;&lt;br /&gt;-----&lt;br /&gt;Using configuration from /etc/openvpn/easy-rsa/pki/easy-rsa-22138.MZyJbQ/tmp.1G19BJ&lt;br /&gt;Enter pass phrase for /etc/openvpn/easy-rsa/pki/private/ca.key:&lt;br /&gt;Check that the request matches the signature&lt;br /&gt;Signature ok&lt;br /&gt;The Subject&#39;s Distinguished Name is as follows&lt;br /&gt;commonName            :ASN.1 12:&#39;cliente-vpn&#39;&lt;br /&gt;Certificate is to be certified until Apr 17 11:06:42 2025 GMT (825 days)&lt;br /&gt;&lt;br /&gt;Write out database with 1 new entries&lt;br /&gt;Data Base Updated&lt;br /&gt;&lt;br /&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;El certificado esta generado en &lt;code&gt;etc/openvpn/easy-rsa/pki/issued/Clientevpn1.crt&lt;/code&gt; y la clave privada en &lt;code&gt;/etc/openvpn/easy-rsa/pki/private/Clientevpn1.key&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Ahora pasaremos al cliente los ficheros necesarios. Para ello, primero en el servidor crearemos una carpeta con los ficheros del cliente vpn y posteriormente lo pasaremos al cliente por scp mediante mi máquina local:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;root@servidor-vpn:/etc/openvpn/easy-rsa# mkdir /home/debian/cliente-vpn&lt;br /&gt;root@servidor-vpn:/etc/openvpn/easy-rsa# cp -rp /etc/openvpn/easy-rsa/pki/{ca.crt,issued/cliente-vpn.crt,private/cliente-vpn.key} /home/debian/cliente-vpn/&lt;br /&gt;root@servidor-vpn:/etc/openvpn/easy-rsa# chown debian: /home/debian/cliente-vpn/&lt;br /&gt;alemd@172.22.0.161&#39;s password: &lt;br /&gt;cliente-vpn.key                           100% 1704   201.0KB/s   00:00    &lt;br /&gt;ca.crt                                    100% 1224   138.4KB/s   00:00    &lt;br /&gt;cliente-vpn.crt                           100% 4525   325.1KB/s   00:00   &lt;br /&gt;&lt;br /&gt;&lt;br /&gt;alemd@debian:~$ scp -r cliente-vpn/ debian@172.22.201.177:&lt;br /&gt;cliente-vpn.key                           100% 1704   125.8KB/s   00:00    &lt;br /&gt;ca.crt                                    100% 1224     5.1KB/s   00:00    &lt;br /&gt;cliente-vpn.crt                           100% 4525   329.6KB/s   00:00  &lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Una vez hecho esto, desde el lado del servidor aún, crearemos el archivo de configuración del tunel que crearemos a partir del fichero de ejemplo:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;root@servidor-vpn:/home/debian# cp /usr/share/doc/openvpn/examples/sample-config-files/server.conf /etc/openvpn/server/servidor.conf&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Lo editamos y el resultado es el siguiente:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;root@servidor-vpn:/home/debian# nano /etc/openvpn/server/servidor.conf&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;&lt;br /&gt;port 1194&lt;br /&gt;proto udp&lt;br /&gt;dev tun&lt;br /&gt;&lt;br /&gt;ca /etc/openvpn/easy-rsa/pki/ca.crt&lt;br /&gt;cert /etc/openvpn/easy-rsa/pki/issued/server.crt&lt;br /&gt;key /etc/openvpn/easy-rsa/pki/private/server.key  # This file should be kept&lt;br /&gt; secret&lt;br /&gt;dh  /etc/openvpn/easy-rsa/pki/dh.pem&lt;br /&gt;&lt;br /&gt;topology subnet&lt;br /&gt;&lt;br /&gt;server 10.100.200.0 255.255.255.0&lt;br /&gt;ifconfig-pool-persist /var/log/openvpn/ipp.txt&lt;br /&gt;&lt;br /&gt;push &quot;route 192.168.100.0 255.255.255.0&quot;&lt;br /&gt;&lt;br /&gt;keepalive 10 120&lt;br /&gt;cipher AES-256-CBC&lt;br /&gt;persist-key&lt;br /&gt;persist-tun&lt;br /&gt;status /var/log/openvpn/openvpn-status.log&lt;br /&gt;verb 3&lt;br /&gt;&lt;br /&gt;explicit-exit-notify 1&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Ahora que hemos terminado de crear el fichero de configuración, habilitaremos el servicio:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;root@servidor-vpn:/home/debian# systemctl enable --now openvpn-server@servidor&lt;br /&gt;Created symlink /etc/systemd/system/multi-user.target.wants/openvpn-server@servidor.service → /lib/systemd/system/openvpn-server@.service.&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Muestro el estado del servicio:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;root@servidor-vpn:/home/debian# systemctl status openvpn-server@servidor&lt;br /&gt;&lt;br /&gt;● openvpn-server@servidor.service - OpenVPN service for servidor&lt;br /&gt;     Loaded: loaded (/lib/systemd/system/openvpn-server@.service; enabled; vendor preset: enabled)&lt;br /&gt;     Active: active (running) since Fri 2023-01-13 11:37:51 UTC; 1min 8s ago&lt;br /&gt;       Docs: man:openvpn(8)&lt;br /&gt;             https://community.openvpn.net/openvpn/wiki/Openvpn24ManPage&lt;br /&gt;             https://community.openvpn.net/openvpn/wiki/HOWTO&lt;br /&gt;   Main PID: 22260 (openvpn)&lt;br /&gt;     Status: &quot;Initialization Sequence Completed&quot;&lt;br /&gt;      Tasks: 1 (limit: 527)&lt;br /&gt;     Memory: 988.0K&lt;br /&gt;        CPU: 14ms&lt;br /&gt;     CGroup: /system.slice/system-openvpn\x2dserver.slice/openvpn-server@servidor.service&lt;br /&gt;             └─22260 /usr/sbin/openvpn --status /run/openvpn-server/status-servidor.log --status-version 2 --suppress-timestamps --config servidor.conf&lt;br /&gt;&lt;br /&gt;Jan 13 11:37:51 servidor-vpn openvpn[22260]: net_iface_up: set tun0 up&lt;br /&gt;Jan 13 11:37:51 servidor-vpn openvpn[22260]: net_addr_v4_add: 10.100.200.1/24 dev tun0&lt;br /&gt;Jan 13 11:37:51 servidor-vpn openvpn[22260]: Could not determine IPv4/IPv6 protocol. Using AF_INET&lt;br /&gt;Jan 13 11:37:51 servidor-vpn openvpn[22260]: Socket Buffers: R=[212992-&gt;212992] S=[212992-&gt;212992]&lt;br /&gt;Jan 13 11:37:51 servidor-vpn openvpn[22260]: UDPv4 link local (bound): [AF_INET][undef]:1194&lt;br /&gt;Jan 13 11:37:51 servidor-vpn openvpn[22260]: UDPv4 link remote: [AF_UNSPEC]&lt;br /&gt;Jan 13 11:37:51 servidor-vpn openvpn[22260]: MULTI: multi_init called, r=256 v=256&lt;br /&gt;Jan 13 11:37:51 servidor-vpn openvpn[22260]: IFCONFIG POOL IPv4: base=10.100.200.2 size=252&lt;br /&gt;Jan 13 11:37:51 servidor-vpn openvpn[22260]: IFCONFIG POOL LIST&lt;br /&gt;Jan 13 11:37:51 servidor-vpn openvpn[22260]: Initialization Sequence Completed&lt;br /&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;h5 id=&quot;configuraci%C3%B3n-del-cliente-vpn.&quot; tabindex=&quot;-1&quot;&gt;Configuración del cliente VPN.&lt;/h5&gt;
&lt;p&gt;Ahora tomaremos el control del cliente e instalaremos openvpn:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;debian@cliente-vpn:~$ sudo apt install openvpn&lt;br /&gt;Reading package lists... Done&lt;br /&gt;Building dependency tree... Done&lt;br /&gt;Reading state information... Done&lt;br /&gt;The following additional packages will be installed:&lt;br /&gt;  easy-rsa libccid liblzo2-2 libpcsclite1 libpkcs11-helper1 libusb-1.0-0&lt;br /&gt;  opensc opensc-pkcs11 pcscd&lt;br /&gt;Suggested packages:&lt;br /&gt;  pcmciautils openvpn-systemd-resolved&lt;br /&gt;The following NEW packages will be installed:&lt;br /&gt;  easy-rsa libccid liblzo2-2 libpcsclite1 libpkcs11-helper1 libusb-1.0-0&lt;br /&gt;  opensc opensc-pkcs11 openvpn pcscd&lt;br /&gt;0 upgraded, 10 newly installed, 0 to remove and 0 not upgraded.&lt;br /&gt;Need to get 2551 kB of archives.&lt;br /&gt;After this operation, 7667 kB of additional disk space will be used.&lt;br /&gt;Do you want to continue? [Y/n] y&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Movemos el contenido del directorio que nos hemos pasado anteriormente por scp:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;root@cliente-vpn:/home/debian# mv cliente-vpn/* /etc/openvpn/client/&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Le cambiamos el propietario a root a los archivos que hemos movido:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;root@cliente-vpn:/home/debian# chown root: /etc/openvpn/client/*&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Creamos el siguiente archivo:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;root@cliente-vpn:/home/debian# nano /etc/openvpn/client/cliente.conf&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Le añadimos lo siguiente:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;client&lt;br /&gt;dev tun&lt;br /&gt;proto udp&lt;br /&gt;&lt;br /&gt;remote 10.0.0.15 1194&lt;br /&gt;resolv-retry infinite&lt;br /&gt;nobind&lt;br /&gt;persist-key&lt;br /&gt;persist-tun&lt;br /&gt;&lt;br /&gt;ca /etc/openvpn/client/ca.crt&lt;br /&gt;cert /etc/openvpn/client/cliente-vpn.crt&lt;br /&gt;key /etc/openvpn/client/cliente-vpn.key&lt;br /&gt;&lt;br /&gt;remote-cert-tls server&lt;br /&gt;cipher AES-256-CBC&lt;br /&gt;verb 3&lt;br /&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Ahora miramos si el servicio está funcionando correctamente:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;root@cliente-vpn:/etc/openvpn/client# systemctl status openvpn-client@cliente&lt;br /&gt;● openvpn-client@cliente.service - OpenVPN tunnel for cliente&lt;br /&gt;     Loaded: loaded (/lib/systemd/system/openvpn-client@.service; enabled; vendor preset: enabled)&lt;br /&gt;     Active: active (running) since Fri 2023-01-13 19:44:09 UTC; 15s ago&lt;br /&gt;       Docs: man:openvpn(8)&lt;br /&gt;             https://community.openvpn.net/openvpn/wiki/Openvpn24ManPage&lt;br /&gt;             https://community.openvpn.net/openvpn/wiki/HOWTO&lt;br /&gt;   Main PID: 22514 (openvpn)&lt;br /&gt;     Status: &quot;Initialization Sequence Completed&quot;&lt;br /&gt;      Tasks: 1 (limit: 527)&lt;br /&gt;     Memory: 1004.0K&lt;br /&gt;        CPU: 22ms&lt;br /&gt;     CGroup: /system.slice/system-openvpn\x2dclient.slice/openvpn-client@cliente.service&lt;br /&gt;             └─22514 /usr/sbin/openvpn --suppress-timestamps --nobind --config cliente.conf&lt;br /&gt;&lt;br /&gt;Jan 13 19:44:09 cliente-vpn openvpn[22514]: net_route_v4_best_gw query: dst 0.0.0.0&lt;br /&gt;Jan 13 19:44:09 cliente-vpn openvpn[22514]: net_route_v4_best_gw result: via 10.0.0.1 dev ens3&lt;br /&gt;Jan 13 19:44:09 cliente-vpn openvpn[22514]: ROUTE_GATEWAY 10.0.0.1/255.255.255.0 IFACE=ens3 HWADDR=fa:16:3e:7a:78:88&lt;br /&gt;Jan 13 19:44:10 cliente-vpn openvpn[22514]: TUN/TAP device tun0 opened&lt;br /&gt;Jan 13 19:44:10 cliente-vpn openvpn[22514]: net_iface_mtu_set: mtu 1500 for tun0&lt;br /&gt;Jan 13 19:44:10 cliente-vpn openvpn[22514]: net_iface_up: set tun0 up&lt;br /&gt;Jan 13 19:44:10 cliente-vpn openvpn[22514]: net_addr_v4_add: 10.100.200.2/24 dev tun0&lt;br /&gt;Jan 13 19:44:10 cliente-vpn openvpn[22514]: net_route_v4_add: 192.168.100.0/24 via 10.100.200.1 dev [NULL] table 0 metric -1&lt;br /&gt;Jan 13 19:44:10 cliente-vpn openvpn[22514]: WARNING: this configuration may cache passwords in memory -- use the auth-nocache option to prevent &gt;&lt;br /&gt;Jan 13 19:44:10 cliente-vpn openvpn[22514]: Initialization Sequence Completed&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Como podemos ver, el servicio está activo y el servidor le ha asignado una ip correctamente. Ahora mostraré las interfaces de red del cliente y veremos que se ha creado un tun0 con la dirección ip de la vpn:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;root@cliente-vpn:/etc/openvpn/client# ip a&lt;br /&gt;1: lo: &amp;lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000&lt;br /&gt;    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00&lt;br /&gt;    inet 127.0.0.1/8 scope host lo&lt;br /&gt;       valid_lft forever preferred_lft forever&lt;br /&gt;    inet6 ::1/128 scope host &lt;br /&gt;       valid_lft forever preferred_lft forever&lt;br /&gt;2: ens3: &amp;lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1450 qdisc pfifo_fast state UP group default qlen 1000&lt;br /&gt;    link/ether fa:16:3e:7a:78:88 brd ff:ff:ff:ff:ff:ff&lt;br /&gt;    altname enp0s3&lt;br /&gt;    inet 10.0.0.186/24 brd 10.0.0.255 scope global dynamic ens3&lt;br /&gt;       valid_lft 68878sec preferred_lft 68878sec&lt;br /&gt;    inet6 fe80::f816:3eff:fe7a:7888/64 scope link &lt;br /&gt;       valid_lft forever preferred_lft forever&lt;br /&gt;3: tun0: &amp;lt;POINTOPOINT,MULTICAST,NOARP,UP,LOWER_UP&gt; mtu 1500 qdisc pfifo_fast state UNKNOWN group default qlen 500&lt;br /&gt;    link/none &lt;br /&gt;    inet 10.100.200.2/24 scope global tun0&lt;br /&gt;       valid_lft forever preferred_lft forever&lt;br /&gt;    inet6 fe80::e7f5:181c:a293:e455/64 scope link stable-privacy &lt;br /&gt;       valid_lft forever preferred_lft forever&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Ahora muestro las interfaces de red del servidor:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;root@servidor-vpn:/home/debian# ip a&lt;br /&gt;1: lo: &amp;lt;LOOPBACK,UP,LOWER_UP&gt; mtu 65536 qdisc noqueue state UNKNOWN group default qlen 1000&lt;br /&gt;    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00&lt;br /&gt;    inet 127.0.0.1/8 scope host lo&lt;br /&gt;       valid_lft forever preferred_lft forever&lt;br /&gt;    inet6 ::1/128 scope host &lt;br /&gt;       valid_lft forever preferred_lft forever&lt;br /&gt;2: ens3: &amp;lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1450 qdisc pfifo_fast state UP group default qlen 1000&lt;br /&gt;    link/ether fa:16:3e:b6:d0:79 brd ff:ff:ff:ff:ff:ff&lt;br /&gt;    altname enp0s3&lt;br /&gt;    inet 192.168.100.66/24 brd 192.168.100.255 scope global dynamic ens3&lt;br /&gt;       valid_lft 78208sec preferred_lft 78208sec&lt;br /&gt;    inet6 fe80::f816:3eff:feb6:d079/64 scope link &lt;br /&gt;       valid_lft forever preferred_lft forever&lt;br /&gt;3: ens4: &amp;lt;BROADCAST,MULTICAST,UP,LOWER_UP&gt; mtu 1450 qdisc pfifo_fast state UP group default qlen 1000&lt;br /&gt;    link/ether fa:16:3e:23:26:50 brd ff:ff:ff:ff:ff:ff&lt;br /&gt;    altname enp0s4&lt;br /&gt;    inet 10.0.0.15/24 brd 10.0.0.255 scope global dynamic ens4&lt;br /&gt;       valid_lft 83174sec preferred_lft 83174sec&lt;br /&gt;    inet6 fe80::f816:3eff:fe23:2650/64 scope link &lt;br /&gt;       valid_lft forever preferred_lft forever&lt;br /&gt;4: tun0: &amp;lt;POINTOPOINT,MULTICAST,NOARP,UP,LOWER_UP&gt; mtu 1500 qdisc pfifo_fast state UNKNOWN group default qlen 500&lt;br /&gt;    link/none &lt;br /&gt;    inet 10.100.200.1/24 scope global tun0&lt;br /&gt;       valid_lft forever preferred_lft forever&lt;br /&gt;    inet6 fe80::c656:fa09:7f9c:ffb4/64 scope link stable-privacy &lt;br /&gt;       valid_lft forever preferred_lft forever&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Ahora añadiremos un cliente conectado a la red de la vpn. Añadiremos una ruta estática por defecto para que use el servidor:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;ip route del default&lt;br /&gt;ip route add default via 192.168.11.10&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;strong&gt;Atención he vuelto a hacer el escenario en Vagrant ya que en OpenStack da problemas al cambiar las rutas estáticas de la máquina.&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Hay que remarcar que en el servidor tenemos que añadir una regla de encaminamiento desde la red de la vpn a la red con la que queremos que se vea. La regla es la siguiente:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;root@servidor-vpn:/home/vagrant# sudo iptables -A POSTROUTING -t nat -s 172.111.222.0/24 -o eth2 -j MASQUERADE&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Muestro como desde el cliente externo a la red vpn realiza ping al cliente de la vpn:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;vagrant@clientevpn:~$ ping 172.111.222.2&lt;br /&gt;PING 172.111.222.2 (172.111.222.2) 56(84) bytes of data.&lt;br /&gt;64 bytes from 172.111.222.2: icmp_seq=1 ttl=63 time=1.70 ms&lt;br /&gt;64 bytes from 172.111.222.2: icmp_seq=2 ttl=63 time=3.05 ms&lt;br /&gt;64 bytes from 172.111.222.2: icmp_seq=3 ttl=63 time=2.35 ms&lt;br /&gt;64 bytes from 172.111.222.2: icmp_seq=4 ttl=63 time=2.78 ms&lt;br /&gt;64 bytes from 172.111.222.2: icmp_seq=5 ttl=63 time=2.72 ms&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Ahora muestro un traceroute:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;vagrant@clientevpn:~$ traceroute 172.111.222.2&lt;br /&gt;traceroute to 172.111.222.2 (172.111.222.2), 30 hops max, 60 byte packets&lt;br /&gt; 1  10.100.200.1 (10.100.200.1)  0.349 ms  0.267 ms  0.306 ms&lt;br /&gt; 2  172.111.222.2 (172.111.222.2)  2.544 ms  2.526 ms  2.547 ms&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Ahora desde el cliente de la vpn hago ping y un traceroute al cliente externo a la vpn:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;vagrant@clientevpn:~$ ping 10.100.200.10&lt;br /&gt;PING 10.100.200.10 (10.100.200.10) 56(84) bytes of data.&lt;br /&gt;64 bytes from 10.100.200.10: icmp_seq=1 ttl=63 time=3.63 ms&lt;br /&gt;64 bytes from 10.100.200.10: icmp_seq=2 ttl=63 time=2.50 ms&lt;br /&gt;64 bytes from 10.100.200.10: icmp_seq=3 ttl=63 time=3.00 ms&lt;br /&gt;64 bytes from 10.100.200.10: icmp_seq=4 ttl=63 time=3.08 ms&lt;br /&gt;^C&lt;br /&gt;--- 10.100.200.10 ping statistics ---&lt;br /&gt;4 packets transmitted, 4 received, 0% packet loss, time 3005ms&lt;br /&gt;rtt min/avg/max/mdev = 2.497/3.053/3.633/0.402 ms&lt;br /&gt;vagrant@clientevpn:~$ traceroute 10.100.200.10&lt;br /&gt;traceroute to 10.100.200.10 (10.100.200.10), 30 hops max, 60 byte packets&lt;br /&gt; 1  172.111.222.1 (172.111.222.1)  1.059 ms  0.955 ms  0.904 ms&lt;br /&gt; 2  10.100.200.10 (10.100.200.10)  1.773 ms  1.640 ms  2.039 ms&lt;br /&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&quot;1.2.-vpn-sitio-a-sitio-con-openvpn-y-certificados-x509.-(10-puntos)&quot; tabindex=&quot;-1&quot;&gt;1.2. VPN sitio a sitio con OpenVPN y certificados x509. (10 puntos)&lt;/h4&gt;
&lt;p&gt;&lt;strong&gt;Configura una conexión VPN sitio a sitio entre dos equipos del cloud:&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;strong&gt;Cada equipo estará conectado a dos redes, una de ellas en común.&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Para la autenticación de los extremos se usarán obligatoriamente certificados digitales, que se generarán utilizando openssl y se almacenarán en el directorio /etc/openvpn, junto con con los parámetros Diffie-Helman y el certificado de la propia Autoridad de Certificación.&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Se utilizarán direcciones de la red 10.99.99.0/24 para las direcciones virtuales de la VPN.&lt;/strong&gt;&lt;/li&gt;
&lt;li&gt;&lt;strong&gt;Tras el establecimiento de la VPN, una máquina de cada red detrás de cada servidor VPN debe ser capaz de acceder a una máquina del otro extremo.&lt;/strong&gt;
&lt;strong&gt;Documenta el proceso detalladamente.&lt;/strong&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;En este apartado, necesitaremos dos clientes y dos servidores y tendremos que conectar los servidores a través de una vpn. Adjunto un esquema lógico para que se vea más claro:&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://reeseschultz.github.io/img/site2site.png&quot; alt=&quot;site2site.png&quot; /&gt;&lt;/p&gt;
&lt;p&gt;El escenario será realizado en Vagrant. Adjunto el Vagrantfile con el escenario completo:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;Vagrant.configure(&quot;2&quot;) do |config|&lt;br /&gt;&lt;br /&gt;    config.vm.define :nodo1 do |nodo1|&lt;br /&gt;      nodo1.vm.box = &quot;debian/bullseye64&quot;&lt;br /&gt;      nodo1.vm.hostname = &quot;servidor-vpn&quot;&lt;br /&gt;      nodo1.vm.synced_folder &quot;.&quot;, &quot;/vagrant&quot;, disabled: true&lt;br /&gt;      nodo1.vm.network :private_network,&lt;br /&gt;      :libvirt__network_name =&gt; &quot;net1&quot;,&lt;br /&gt;      :libvirt__dhcp_enabled =&gt; false,&lt;br /&gt;      :ip =&gt; &quot;10.0.0.10&quot;,&lt;br /&gt;      :libvirt__forward_mode =&gt; &quot;veryisolated&quot;&lt;br /&gt;    end&lt;br /&gt;  config.vm.define :nodo2 do |nodo2|&lt;br /&gt;    nodo2.vm.box = &quot;debian/bullseye64&quot;&lt;br /&gt;    nodo2.vm.hostname = &quot;clientevpn&quot;&lt;br /&gt;    nodo2.vm.synced_folder &quot;.&quot;, &quot;/vagrant&quot;, disabled: true&lt;br /&gt;    nodo2.vm.network :private_network,&lt;br /&gt;      :libvirt__network_name =&gt; &quot;net1&quot;,&lt;br /&gt;      :libvirt__dhcp_enabled =&gt; false,&lt;br /&gt;      :ip =&gt; &quot;10.0.0.11&quot;,&lt;br /&gt;      :libvirt__forward_mode =&gt; &quot;veryisolated&quot;&lt;br /&gt;    end&lt;br /&gt;   config.vm.define :nodo3 do |nodo3|&lt;br /&gt;     nodo3.vm.box = &quot;debian/bullseye64&quot;&lt;br /&gt;     nodo3.vm.hostname = &quot;servidor2-vpn&quot;&lt;br /&gt;     nodo3.vm.synced_folder &quot;.&quot;, &quot;/vagrant&quot;, disabled: true      &lt;br /&gt;     nodo3.vm.network :private_network,&lt;br /&gt;      :libvirt__network_name =&gt; &quot;net2&quot;,&lt;br /&gt;      :libvirt__dhcp_enabled =&gt; false,&lt;br /&gt;      :ip =&gt; &quot;10.1.2.1&quot;,&lt;br /&gt;      :libvirt__forward_mode =&gt; &quot;veryisolated&quot;&lt;br /&gt;    end&lt;br /&gt;  config.vm.define :nodo4 do |nodo4|&lt;br /&gt;    nodo4.vm.box = &quot;debian/bullseye64&quot;&lt;br /&gt;    nodo4.vm.hostname = &quot;cliente2vpn&quot;&lt;br /&gt;    nodo4.vm.synced_folder &quot;.&quot;, &quot;/vagrant&quot;, disabled: true&lt;br /&gt;    nodo4.vm.network :private_network,&lt;br /&gt;      :libvirt__network_name =&gt; &quot;net2&quot;,&lt;br /&gt;      :libvirt__dhcp_enabled =&gt; false,&lt;br /&gt;      :ip =&gt; &quot;10.1.2.2&quot;,&lt;br /&gt;      :libvirt__forward_mode =&gt; &quot;veryisolated&quot;&lt;br /&gt;    end&lt;br /&gt;  end&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Como podemos ver, son dos servidores totalmente aislados con un cliente cada uno y lo que haremos será configurar una vpn para que ambas redes sean visibles entre sí.&lt;/p&gt;
&lt;h5 id=&quot;configuraci%C3%B3n-del-servidor1.&quot; tabindex=&quot;-1&quot;&gt;Configuración del servidor1.&lt;/h5&gt;
&lt;p&gt;Lo primero que haremos, será instalar openvpn y configurar un fichero llamado vars, cogeremos de ejemplo un fichero que se encontrará en el mismo directorio:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;vagrant@servidor-vpn:~$ sudo apt install openvpn&lt;br /&gt;Reading package lists... Done&lt;br /&gt;Building dependency tree... Done&lt;br /&gt;Reading state information... Done&lt;br /&gt;The following additional packages will be installed:&lt;br /&gt;  easy-rsa libccid liblzo2-2 libpcsclite1 libpkcs11-helper1 libusb-1.0-0&lt;br /&gt;  opensc opensc-pkcs11 pcscd&lt;br /&gt;Suggested packages:&lt;br /&gt;  pcmciautils resolvconf openvpn-systemd-resolved&lt;br /&gt;The following NEW packages will be installed:&lt;br /&gt;  easy-rsa libccid liblzo2-2 libpcsclite1 libpkcs11-helper1 libusb-1.0-0&lt;br /&gt;  opensc opensc-pkcs11 openvpn pcscd&lt;br /&gt;0 upgraded, 10 newly installed, 0 to remove and 31 not upgraded.&lt;br /&gt;Need to get 2551 kB of archives.&lt;br /&gt;After this operation, 7667 kB of additional disk space will be used.&lt;br /&gt;Do you want to continue? [Y/n] y&lt;br /&gt;vagrant@servidor-vpn:~$ cd /usr/share/easy-rsa/&lt;br /&gt;vagrant@servidor-vpn:/usr/share/easy-rsa$ sudo su&lt;br /&gt;root@servidor-vpn:/usr/share/easy-rsa# cp vars.example vars&lt;br /&gt;root@servidor-vpn:/usr/share/easy-rsa# nano vars&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;El archivo vars contiene lo siguiente:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;set_var EASYRSA_REQ_COUNTRY     &quot;ES&quot;&lt;br /&gt;set_var EASYRSA_REQ_PROVINCE    &quot;Sevilla&quot;&lt;br /&gt;set_var EASYRSA_REQ_CITY        &quot;Utrera&quot;&lt;br /&gt;set_var EASYRSA_REQ_ORG         &quot;amontes&quot;&lt;br /&gt;set_var EASYRSA_REQ_EMAIL       &quot;aaleemd11@gmail.com&quot;&lt;br /&gt;set_var EASYRSA_REQ_OU          &quot;Practica VPN&quot;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Ahora crearemos el directorio donde se almacenaran los documentos de la CA:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;root@servidor-vpn:/usr/share/easy-rsa# ./easyrsa init-pki&lt;br /&gt;&lt;br /&gt;Note: using Easy-RSA configuration from: /usr/share/easy-rsa/vars&lt;br /&gt;&lt;br /&gt;init-pki complete; you may now create a CA or requests.&lt;br /&gt;Your newly created PKI dir is: /usr/share/easy-rsa/pki&lt;br /&gt;&lt;br /&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Ahora crearemos una clave Diffie-Hellman:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;root@servidor-vpn:/usr/share/easy-rsa# ./easyrsa gen-dh&lt;br /&gt;&lt;br /&gt;Note: using Easy-RSA configuration from: /usr/share/easy-rsa/vars&lt;br /&gt;Using SSL: openssl OpenSSL 1.1.1n  15 Mar 2022&lt;br /&gt;Generating DH parameters, 2048 bit long safe prime, generator 2&lt;br /&gt;This is going to take a long time&lt;br /&gt;........................+............................................................+....+..............................+.............................................................................................+..............................................+...........................................................................................................................................................................................................................+...................................&lt;br /&gt;&lt;br /&gt;DH parameters of size 2048 created at /usr/share/easy-rsa/pki/dh.pem&lt;br /&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Una vez hecho esto, crearemos la CA:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;root@servidor-vpn:/usr/share/easy-rsa# ./easyrsa build-ca&lt;br /&gt;&lt;br /&gt;Note: using Easy-RSA configuration from: /usr/share/easy-rsa/vars&lt;br /&gt;Using SSL: openssl OpenSSL 1.1.1n  15 Mar 2022&lt;br /&gt;&lt;br /&gt;Enter New CA Key Passphrase: &lt;br /&gt;Re-Enter New CA Key Passphrase: &lt;br /&gt;Generating RSA private key, 2048 bit long modulus (2 primes)&lt;br /&gt;.....................+++++&lt;br /&gt;......................................+++++&lt;br /&gt;e is 65537 (0x010001)&lt;br /&gt;You are about to be asked to enter information that will be incorporated&lt;br /&gt;into your certificate request.&lt;br /&gt;What you are about to enter is what is called a Distinguished Name or a DN.&lt;br /&gt;There are quite a few fields but you can leave some blank&lt;br /&gt;For some fields there will be a default value,&lt;br /&gt;If you enter &#39;.&#39;, the field will be left blank.&lt;br /&gt;-----&lt;br /&gt;Common Name (eg: your user, host, or server name) [Easy-RSA CA]:Alejandro Montes&lt;br /&gt;&lt;br /&gt;CA creation complete and you may now import and sign cert requests.&lt;br /&gt;Your new CA certificate file for publishing is at:&lt;br /&gt;/usr/share/easy-rsa/pki/ca.crt&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Cuando tengamos lista nuestra CA, lo primero que haremos será crear y firmar el certificado que usará nuestra máquina servidor.&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;root@servidor-vpn:/usr/share/easy-rsa# ./easyrsa gen-req server&lt;br /&gt;&lt;br /&gt;Note: using Easy-RSA configuration from: /usr/share/easy-rsa/vars&lt;br /&gt;Using SSL: openssl OpenSSL 1.1.1n  15 Mar 2022&lt;br /&gt;Generating a RSA private key&lt;br /&gt;..........................+++++&lt;br /&gt;.................................................................................................+++++&lt;br /&gt;writing new private key to &#39;/usr/share/easy-rsa/pki/easy-rsa-613.56pi8H/tmp.zJd9ro&#39;&lt;br /&gt;Enter PEM pass phrase:&lt;br /&gt;Verifying - Enter PEM pass phrase:&lt;br /&gt;-----&lt;br /&gt;You are about to be asked to enter information that will be incorporated&lt;br /&gt;into your certificate request.&lt;br /&gt;What you are about to enter is what is called a Distinguished Name or a DN.&lt;br /&gt;There are quite a few fields but you can leave some blank&lt;br /&gt;For some fields there will be a default value,&lt;br /&gt;If you enter &#39;.&#39;, the field will be left blank.&lt;br /&gt;-----&lt;br /&gt;Common Name (eg: your user, host, or server name) [server]:Alejandro Montes&lt;br /&gt;&lt;br /&gt;Keypair and certificate request completed. Your files are:&lt;br /&gt;req: /usr/share/easy-rsa/pki/reqs/server.req&lt;br /&gt;key: /usr/share/easy-rsa/pki/private/server.key&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Ahora firmamos el certificado:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;root@servidor-vpn:/usr/share/easy-rsa# ./easyrsa sign-req server server&lt;br /&gt;&lt;br /&gt;Note: using Easy-RSA configuration from: /usr/share/easy-rsa/vars&lt;br /&gt;Using SSL: openssl OpenSSL 1.1.1n  15 Mar 2022&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;You are about to sign the following certificate.&lt;br /&gt;Please check over the details shown below for accuracy. Note that this request&lt;br /&gt;has not been cryptographically verified. Please be sure it came from a trusted&lt;br /&gt;source or that you have verified the request checksum with the sender.&lt;br /&gt;&lt;br /&gt;Request subject, to be signed as a server certificate for 825 days:&lt;br /&gt;&lt;br /&gt;subject=&lt;br /&gt;    commonName                = Alejandro Montes&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;Type the word &#39;yes&#39; to continue, or any other input to abort.&lt;br /&gt;  Confirm request details: yes&lt;br /&gt;Using configuration from /usr/share/easy-rsa/pki/easy-rsa-635.4wZS7o/tmp.l26dgD&lt;br /&gt;Enter pass phrase for /usr/share/easy-rsa/pki/private/ca.key:&lt;br /&gt;Check that the request matches the signature&lt;br /&gt;Signature ok&lt;br /&gt;The Subject&#39;s Distinguished Name is as follows&lt;br /&gt;commonName            :ASN.1 12:&#39;Alejandro Montes&#39;&lt;br /&gt;Certificate is to be certified until Apr 29 09:05:56 2025 GMT (825 days)&lt;br /&gt;&lt;br /&gt;Write out database with 1 new entries&lt;br /&gt;Data Base Updated&lt;br /&gt;&lt;br /&gt;Certificate created at: /usr/share/easy-rsa/pki/issued/server.crt&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Tras crear y firmar el certificado, crearemos y firmaremos el certificado que usará el servidor2.:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;root@servidor-vpn:/usr/share/easy-rsa# ./easyrsa gen-req vpn_server2&lt;br /&gt;&lt;br /&gt;Note: using Easy-RSA configuration from: /usr/share/easy-rsa/vars&lt;br /&gt;Using SSL: openssl OpenSSL 1.1.1n  15 Mar 2022&lt;br /&gt;Generating a RSA private key&lt;br /&gt;.....+++++&lt;br /&gt;.............................................+++++&lt;br /&gt;writing new private key to &#39;/usr/share/easy-rsa/pki/easy-rsa-698.V9av96/tmp.uT7ClE&#39;&lt;br /&gt;Enter PEM pass phrase:&lt;br /&gt;Verifying - Enter PEM pass phrase:&lt;br /&gt;-----&lt;br /&gt;You are about to be asked to enter information that will be incorporated&lt;br /&gt;into your certificate request.&lt;br /&gt;What you are about to enter is what is called a Distinguished Name or a DN.&lt;br /&gt;There are quite a few fields but you can leave some blank&lt;br /&gt;For some fields there will be a default value,&lt;br /&gt;If you enter &#39;.&#39;, the field will be left blank.&lt;br /&gt;-----&lt;br /&gt;Common Name (eg: your user, host, or server name) [vpn_server2]:Servidor 2&lt;br /&gt;&lt;br /&gt;Keypair and certificate request completed. Your files are:&lt;br /&gt;req: /usr/share/easy-rsa/pki/reqs/vpn_server2.req&lt;br /&gt;key: /usr/share/easy-rsa/pki/private/vpn_server2.key&lt;br /&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Y lo firmamos:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;root@servidor-vpn:/usr/share/easy-rsa# ./easyrsa sign-req client vpn_server2&lt;br /&gt;&lt;br /&gt;Note: using Easy-RSA configuration from: /usr/share/easy-rsa/vars&lt;br /&gt;Using SSL: openssl OpenSSL 1.1.1n  15 Mar 2022&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;You are about to sign the following certificate.&lt;br /&gt;Please check over the details shown below for accuracy. Note that this request&lt;br /&gt;has not been cryptographically verified. Please be sure it came from a trusted&lt;br /&gt;source or that you have verified the request checksum with the sender.&lt;br /&gt;&lt;br /&gt;Request subject, to be signed as a client certificate for 825 days:&lt;br /&gt;&lt;br /&gt;subject=&lt;br /&gt;    commonName                = Servidor 2&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;Type the word &#39;yes&#39; to continue, or any other input to abort.&lt;br /&gt;  Confirm request details: yes&lt;br /&gt;Using configuration from /usr/share/easy-rsa/pki/easy-rsa-747.Dd9qde/tmp.YOHohQ&lt;br /&gt;Enter pass phrase for /usr/share/easy-rsa/pki/private/ca.key:&lt;br /&gt;Check that the request matches the signature&lt;br /&gt;Signature ok&lt;br /&gt;The Subject&#39;s Distinguished Name is as follows&lt;br /&gt;commonName            :ASN.1 12:&#39;Servidor 2&#39;&lt;br /&gt;Certificate is to be certified until Apr 29 09:10:37 2025 GMT (825 days)&lt;br /&gt;&lt;br /&gt;Write out database with 1 new entries&lt;br /&gt;Data Base Updated&lt;br /&gt;&lt;br /&gt;Certificate created at: /usr/share/easy-rsa/pki/issued/vpn_server2.crt&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Ahora copiaremos los ficheros a la ruta &lt;code&gt;/etc/openvpn&lt;/code&gt; para que funcione el servidor:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;root@servidor-vpn:/usr/share/easy-rsa/pki# cp ca.crt /etc/openvpn/server/&lt;br /&gt;root@servidor-vpn:/usr/share/easy-rsa/pki# cp dh.pem /etc/openvpn/server/&lt;br /&gt;root@servidor-vpn:/usr/share/easy-rsa/pki# cp issued/server.crt /etc/openvpn/server/&lt;br /&gt;root@servidor-vpn:/usr/share/easy-rsa/pki# cp private/server.key /etc/openvpn/server/&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Ahora pasamos al otro servidor los archivos necesarios para que se conecte al servidor vpn:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;root@servidor-vpn:/usr/share/easy-rsa# scp pki/ca.crt vagrant@192.168.121.252:&lt;br /&gt;ca.crt                                  100% 1224   672.0KB/s   00:00    &lt;br /&gt;root@servidor-vpn:/usr/share/easy-rsa# scp pki/issued/vpn_server2.crt vagrant@192.168.121.252:&lt;br /&gt;vpn_server2.crt                         100% 4527   134.1KB/s   00:00    &lt;br /&gt;root@servidor-vpn:/usr/share/easy-rsa# scp pki/private/vpn_server2.key vagrant@192.168.121.252:&lt;br /&gt;vpn_server2.key    &lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Una vez hayamos pasados los archivos al otro servidor y hayamos copiado los ficheros a su ruta correspondiente, crearemos el fichero de configuración del servidor vpn.&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;dev tun&lt;br /&gt;ifconfig 100.0.123.1 100.0.123.2&lt;br /&gt;route 10.1.2.0 255.255.255.0&lt;br /&gt;tls-server&lt;br /&gt;ca ca.crt&lt;br /&gt;cert server.crt&lt;br /&gt;key server.key&lt;br /&gt;dh dh.pem&lt;br /&gt;comp-lzo&lt;br /&gt;keepalive 10 120&lt;br /&gt;log /var/log/openvpn/server.log&lt;br /&gt;verb 3&lt;br /&gt;askpass passwd.txt&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Creamos en /etc/openvpn/server un fichero llamado passwd.txt con la contraseña de frase de paso que hemos introducido anteriormente.&lt;/p&gt;
&lt;p&gt;Iniciamos el servidor vpn:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;root@servidor-vpn:/etc/openvpn/server# systemctl start openvpn-server@servidor&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Ahora hacemos un status para ver que se ha iniciado correctamente:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;● openvpn-server@servidor.service - OpenVPN service for servidor&lt;br /&gt;     Loaded: loaded (/lib/systemd/system/openvpn-server@.service; disable&gt;&lt;br /&gt;     Active: active (running) since Wed 2023-01-25 12:21:45 UTC; 39s ago&lt;br /&gt;       Docs: man:openvpn(8)&lt;br /&gt;             https://community.openvpn.net/openvpn/wiki/Openvpn24ManPage&lt;br /&gt;             https://community.openvpn.net/openvpn/wiki/HOWTO&lt;br /&gt;   Main PID: 11960 (openvpn)&lt;br /&gt;     Status: &quot;Pre-connection initialization successful&quot;&lt;br /&gt;      Tasks: 1 (limit: 527)&lt;br /&gt;     Memory: 936.0K&lt;br /&gt;        CPU: 27ms&lt;br /&gt;     CGroup: /system.slice/system-openvpn\x2dserver.slice/openvpn-server@&gt;&lt;br /&gt;             └─11960 /usr/sbin/openvpn --status /run/openvpn-server/statu&gt;&lt;br /&gt;&lt;br /&gt;Jan 25 12:21:44 servidor-vpn systemd[1]: Starting OpenVPN service for ser&gt;&lt;br /&gt;Jan 25 12:21:45 servidor-vpn openvpn[11960]: WARNING: Compression for rec&gt;&lt;br /&gt;Jan 25 12:21:45 servidor-vpn systemd[1]: Started OpenVPN service for serv&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Si no lo hemos hecho antes, activamos el bit de forwarding a 1:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;root@servidor-vpn:/etc/openvpn/server# echo 1 &gt; /proc/sys/net/ipv4/ip_forward&lt;/code&gt;&lt;/pre&gt;
&lt;h5 id=&quot;configuraci%C3%B3n-del-cliente1.&quot; tabindex=&quot;-1&quot;&gt;Configuración del cliente1.&lt;/h5&gt;
&lt;p&gt;Cambiaremos la ruta por defecto del cliente1:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;vagrant@clientevpn:~$ sudo ip r del default&lt;br /&gt;vagrant@clientevpn:~$ sudo ip r add default via 10.0.0.10&lt;br /&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;h5 id=&quot;configuraci%C3%B3n-del-servidor2&quot; tabindex=&quot;-1&quot;&gt;Configuración del servidor2&lt;/h5&gt;
&lt;p&gt;Ahora configuraremos el servidor 2 que es el otro extremo del túnel vpn. Lo primero que haremos será instalar openvpn y mover los ficheros que pasamos anteriormente por scp a las rutas adecuadas:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;vagrant@servidor2-vpn:~$ sudo apt install openvpn&lt;br /&gt;Reading package lists... Done&lt;br /&gt;Building dependency tree... Done&lt;br /&gt;Reading state information... Done&lt;br /&gt;The following additional packages will be installed:&lt;br /&gt;  easy-rsa libccid liblzo2-2 libpcsclite1 libpkcs11-helper1 libusb-1.0-0&lt;br /&gt;  opensc opensc-pkcs11 pcscd&lt;br /&gt;Suggested packages:&lt;br /&gt;  pcmciautils resolvconf openvpn-systemd-resolved&lt;br /&gt;The following NEW packages will be installed:&lt;br /&gt;  easy-rsa libccid liblzo2-2 libpcsclite1 libpkcs11-helper1 libusb-1.0-0&lt;br /&gt;  opensc opensc-pkcs11 openvpn pcscd&lt;br /&gt;0 upgraded, 10 newly installed, 0 to remove and 0 not upgraded.&lt;br /&gt;Need to get 2551 kB of archives.&lt;br /&gt;After this operation, 7667 kB of additional disk space will be used.&lt;br /&gt;Do you want to continue? [Y/n] y&lt;br /&gt;vagrant@servidor2-vpn:~$ sudo su&lt;br /&gt;root@servidor2-vpn:/home/vagrant# mv ca.crt /etc/openvpn/client/&lt;br /&gt;root@servidor2-vpn:/home/vagrant# mv vpn_server2.crt /etc/openvpn/client/&lt;br /&gt;root@servidor2-vpn:/home/vagrant# mv vpn_server2.key /etc/openvpn/client/&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Creamos un archivo de configuración para este servidor:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;root@servidor2-vpn:/home/vagrant# nano /etc/openvpn/client/client.conf&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;dev tun&lt;br /&gt;remote 192.168.121.6&lt;br /&gt;ifconfig 100.0.123.2 100.0.123.1&lt;br /&gt;route 10.0.0.0 255.255.255.0&lt;br /&gt;tls-client&lt;br /&gt;ca ca.crt&lt;br /&gt;cert vpn_server2.crt&lt;br /&gt;key vpn_server2.key&lt;br /&gt;comp-lzo&lt;br /&gt;keepalive 10 60&lt;br /&gt;verb 3&lt;br /&gt;askpass passwd2.txt&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Ahora arrancamos el servicio:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;root@servidor2-vpn:/etc/openvpn/client# systemctl start openvpn-client@client&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Muestro el estado del servicio:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;openvpn-client@client.service - OpenVPN tunnel for client&lt;br /&gt;     Loaded: loaded (/lib/systemd/system/openvpn-client@.service; disable&gt;&lt;br /&gt;     Active: active (running) since Wed 2023-01-25 14:25:56 UTC; 2min 14s&gt;&lt;br /&gt;       Docs: man:openvpn(8)&lt;br /&gt;             https://community.openvpn.net/openvpn/wiki/Openvpn24ManPage&lt;br /&gt;             https://community.openvpn.net/openvpn/wiki/HOWTO&lt;br /&gt;   Main PID: 12472 (openvpn)&lt;br /&gt;     Status: &quot;Pre-connection initialization successful&quot;&lt;br /&gt;      Tasks: 1 (limit: 527)&lt;br /&gt;     Memory: 1.1M&lt;br /&gt;        CPU: 50ms&lt;br /&gt;     CGroup: /system.slice/system-openvpn\x2dclient.slice/openvpn-client@&gt;&lt;br /&gt;             └─12472 /usr/sbin/openvpn --suppress-timestamps --nobind --c&gt;&lt;br /&gt;&lt;br /&gt;Jan 25 14:28:06 servidor2-vpn openvpn[12472]: ROUTE_GATEWAY 192.168.121.1&gt;&lt;br /&gt;Jan 25 14:28:06 servidor2-vpn openvpn[12472]: TUN/TAP device tun0 opened&lt;br /&gt;Jan 25 14:28:06 servidor2-vpn openvpn[12472]: net_iface_mtu_set: mtu 1500&gt;&lt;br /&gt;Jan 25 14:28:06 servidor2-vpn openvpn[12472]: net_iface_up: set tun0 up&lt;br /&gt;Jan 25 14:28:06 servidor2-vpn openvpn[12472]: net_addr_ptp_v4_add: 100.0.&gt;&lt;br /&gt;Jan 25 14:28:06 servidor2-vpn openvpn[12472]: net_route_v4_add: 10.0.0.0/&gt;&lt;br /&gt;Jan 25 14:28:06 servidor2-vpn openvpn[12472]: TCP/UDP: Preserving recentl&gt;&lt;br /&gt;Jan 25 14:28:06 servidor2-vpn openvpn[12472]: Socket Buffers: R=[212992-&gt;&gt;&lt;br /&gt;Jan 25 14:28:06 servidor2-vpn openvpn[12472]: UDP link local: (not bound)&lt;br /&gt;Jan 25 14:28:06 servidor2-vpn openvpn[12472]: UDP link remote: [AF_INET]1&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;No debemos olvidarnos de activar el bit de forwarding en este servidor también:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;echo 1 &gt; /proc/sys/net/ipv4/ip_forward&lt;/code&gt;&lt;/pre&gt;
&lt;h5 id=&quot;configuraci%C3%B3n-cliente-2.&quot; tabindex=&quot;-1&quot;&gt;Configuración cliente 2.&lt;/h5&gt;
&lt;p&gt;Cambiamos la ruta por defecto del cliente2:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;vagrant@cliente2vpn:~$ sudo ip r del default&lt;br /&gt;vagrant@cliente2vpn:~$ sudo ip r add default via 10.1.2.1&lt;/code&gt;&lt;/pre&gt;
&lt;h5 id=&quot;comprobaciones.&quot; tabindex=&quot;-1&quot;&gt;Comprobaciones.&lt;/h5&gt;
&lt;p&gt;IPs:&lt;/p&gt;
&lt;p&gt;Servidor1-vpn:10.0.0.10,192.168.121.6&lt;/p&gt;
&lt;p&gt;Cliente1-vpn:10.0.0.11&lt;/p&gt;
&lt;p&gt;Servidor2-vpn:10.1.2.1.1,192.168.121.252&lt;/p&gt;
&lt;p&gt;Cliente2-vpn:10.1.2.1.2&lt;/p&gt;
&lt;p&gt;Ping y traceroute desde el cliente del servidor 1 al cliente del servidor 2:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;vagrant@clientevpn:~$ ping 10.1.2.2&lt;br /&gt;PING 10.1.2.2 (10.1.2.2) 56(84) bytes of data.&lt;br /&gt;64 bytes from 10.1.2.2: icmp_seq=1 ttl=62 time=3.13 ms&lt;br /&gt;64 bytes from 10.1.2.2: icmp_seq=2 ttl=62 time=3.48 ms&lt;br /&gt;64 bytes from 10.1.2.2: icmp_seq=3 ttl=62 time=3.55 ms&lt;br /&gt;64 bytes from 10.1.2.2: icmp_seq=4 ttl=62 time=3.14 ms&lt;br /&gt;^C&lt;br /&gt;--- 10.1.2.2 ping statistics ---&lt;br /&gt;4 packets transmitted, 4 received, 0% packet loss, time 3005ms&lt;br /&gt;rtt min/avg/max/mdev = 3.130/3.325/3.549/0.191 ms&lt;br /&gt;vagrant@clientevpn:~$ traceroute 10.1.2.2&lt;br /&gt;traceroute to 10.1.2.2 (10.1.2.2), 30 hops max, 60 byte packets&lt;br /&gt; 1  10.0.0.10 (10.0.0.10)  0.470 ms  0.414 ms  0.469 ms&lt;br /&gt; 2  pool-100-0-123-2.bstnma.fios.verizon.net (100.0.123.2)  1.674 ms  3.207 ms  3.144 ms&lt;br /&gt; 3  10.1.2.2 (10.1.2.2)  3.090 ms  3.072 ms  2.993 ms&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Ping y traceroute desde el cliente del servidor 2 al cliente del servidor 1:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;vagrant@cliente2vpn:~$ ping 10.0.0.11&lt;br /&gt;PING 10.0.0.11 (10.0.0.11) 56(84) bytes of data.&lt;br /&gt;64 bytes from 10.0.0.11: icmp_seq=1 ttl=62 time=3.55 ms&lt;br /&gt;64 bytes from 10.0.0.11: icmp_seq=2 ttl=62 time=3.91 ms&lt;br /&gt;64 bytes from 10.0.0.11: icmp_seq=3 ttl=62 time=3.89 ms&lt;br /&gt;^C&lt;br /&gt;--- 10.0.0.11 ping statistics ---&lt;br /&gt;3 packets transmitted, 3 received, 0% packet loss, time 2003ms&lt;br /&gt;rtt min/avg/max/mdev = 3.551/3.782/3.910/0.163 ms&lt;br /&gt;vagrant@cliente2vpn:~$ traceroute 10.0.0.11&lt;br /&gt;traceroute to 10.0.0.11 (10.0.0.11), 30 hops max, 60 byte packets&lt;br /&gt; 1  10.1.2.1 (10.1.2.1)  0.577 ms  0.532 ms  0.476 ms&lt;br /&gt; 2  lo0-100.BSTNMA-VFTTP-306.verizon-gni.net (100.0.123.1)  2.497 ms  2.832 ms  3.371 ms&lt;br /&gt; 3  10.0.0.11 (10.0.0.11)  3.341 ms  3.210 ms  3.121 ms&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&quot;wireguard&quot; tabindex=&quot;-1&quot;&gt;WireGuard&lt;/h3&gt;
&lt;h4 id=&quot;2.1.-vpn-de-acceso-remoto-con-wireguard.-(5-puntos)&quot; tabindex=&quot;-1&quot;&gt;2.1. VPN de acceso remoto con WireGuard. (5 puntos)&lt;/h4&gt;
&lt;p&gt;&lt;strong&gt;Monta una VPN de acceso remoto usando Wireguard. Intenta probarla con clientes Windows, Linux y Android. Documenta el proceso adecuadamente y compáralo con el del apartado A.&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Para crear el escenario he usado este Vagrantfile:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;Vagrant.configure(&quot;2&quot;) do |config|&lt;br /&gt;&lt;br /&gt;    config.vm.define :nodo1 do |nodo1|&lt;br /&gt;      nodo1.vm.box = &quot;debian/bullseye64&quot;&lt;br /&gt;      nodo1.vm.hostname = &quot;wireguard-server&quot;&lt;br /&gt;      nodo1.vm.synced_folder &quot;.&quot;, &quot;/vagrant&quot;, disabled: true&lt;br /&gt;      nodo1.vm.network :private_network,&lt;br /&gt;      :libvirt__network_name =&gt; &quot;net1&quot;,&lt;br /&gt;      :libvirt__dhcp_enabled =&gt; false,&lt;br /&gt;      :ip =&gt; &quot;192.168.100.1&quot;,&lt;br /&gt;      :libvirt__forward_mode =&gt; &quot;veryisolated&quot;&lt;br /&gt;      nodo1.vm.network :private_network,&lt;br /&gt;      :libvirt__network_name =&gt; &quot;net-privada&quot;,&lt;br /&gt;      :libvirt__dhcp_enabled =&gt; false,&lt;br /&gt;      :ip =&gt; &quot;192.168.50.1&quot;,&lt;br /&gt;      :libvirt__forward_mode =&gt; &quot;veryisolated&quot;&lt;br /&gt;&lt;br /&gt;    end&lt;br /&gt;    config.vm.define :nodo2 do |nodo2|&lt;br /&gt;      nodo2.vm.box = &quot;debian/bullseye64&quot;&lt;br /&gt;      nodo2.vm.hostname = &quot;wireguard-client&quot;&lt;br /&gt;      nodo2.vm.synced_folder &quot;.&quot;, &quot;/vagrant&quot;, disabled: true&lt;br /&gt;      nodo2.vm.network :private_network,&lt;br /&gt;      :libvirt__network_name =&gt; &quot;net3&quot;,&lt;br /&gt;      :libvirt__dhcp_enabled =&gt; false,&lt;br /&gt;      :ip =&gt; &quot;192.168.100.2&quot;,&lt;br /&gt;      :libvirt__forward_mode =&gt; &quot;veryisolated&quot;&lt;br /&gt;    end&lt;br /&gt;    config.vm.define :nodo3 do |nodo3|&lt;br /&gt;      nodo3.vm.box = &quot;debian/bullseye64&quot;&lt;br /&gt;      nodo3.vm.hostname = &quot;private-client&quot;&lt;br /&gt;      nodo3.vm.synced_folder &quot;.&quot;, &quot;/vagrant&quot;, disabled: true&lt;br /&gt;      nodo3.vm.network :private_network,&lt;br /&gt;      :libvirt__network_name =&gt; &quot;net-privada&quot;,&lt;br /&gt;      :libvirt__dhcp_enabled =&gt; false,&lt;br /&gt;      :ip =&gt; &quot;192.168.50.10&quot;,&lt;br /&gt;      :libvirt__forward_mode =&gt; &quot;veryisolated&quot;&lt;br /&gt;    end&lt;br /&gt;  end&lt;/code&gt;&lt;/pre&gt;
&lt;h5 id=&quot;configuraci%C3%B3n-del-servidor%3A&quot; tabindex=&quot;-1&quot;&gt;Configuración del servidor:&lt;/h5&gt;
&lt;p&gt;Una vez creado el escenario, entraremos al servidor y lo configuraremos, para ello lo primero que haremos será instalar wireguard:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;vagrant@wireguard-server:~$ sudo apt install wireguard&lt;br /&gt;Reading package lists... Done&lt;br /&gt;Building dependency tree... Done&lt;br /&gt;Reading state information... Done&lt;br /&gt;The following additional packages will be installed:&lt;br /&gt;  wireguard-tools&lt;br /&gt;Suggested packages:&lt;br /&gt;  openresolv | resolvconf&lt;br /&gt;The following NEW packages will be installed:&lt;br /&gt;  wireguard wireguard-tools&lt;br /&gt;0 upgraded, 2 newly installed, 0 to remove and 31 not upgraded.&lt;br /&gt;Need to get 94.3 kB of archives.&lt;br /&gt;After this operation, 344 kB of additional disk space will be used.&lt;br /&gt;Do you want to continue? [Y/n] y&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Como he tenido problemas en el apartado anterior, lo primero que haremos será activar el bit de forwarding:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;vagrant@wireguard-server:~$ sudo nano /etc/sysctl.conf&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Y descomentamos la línea:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;net.ipv4.ip_forward=1&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Creamos un par de claves usando el siguiente comando:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;vagrant@wireguard-server:~$ sudo su&lt;br /&gt;root@wireguard-server:/home/vagrant# cd /etc/wireguard/&lt;br /&gt;root@wireguard-server:/etc/wireguard# wg genkey | tee serverprivatekey | wg pubkey &gt; serverpublickey&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Creamos el archivo de configuración:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;root@wireguard-server:/etc/wireguard# nano wg0.conf&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;[Interface]&lt;br /&gt;Address = 10.0.100.1 #IP de la nueva interfaz&lt;br /&gt;PrivateKey = yMILnmrL3ACptes5tfVdGQE7aeMRjX04t1KgOF811W8= #Clave privada generada anteriormente.&lt;br /&gt;ListenPort = 51820 #Puerto de escucha.&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Levantamos la interfaz creada con el siguiente comando:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;root@wireguard-server:/etc/wireguard# wg-quick up wg0&lt;br /&gt;[#] ip link add wg0 type wireguard&lt;br /&gt;[#] wg setconf wg0 /dev/fd/63&lt;br /&gt;[#] ip -4 address add 10.0.100.1 dev wg0&lt;br /&gt;[#] ip link set mtu 1420 up dev wg0&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Como vemos con el siguiente comanfo, la interfaz está activa:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;root@wireguard-server:/etc/wireguard# wg&lt;br /&gt;interface: wg0&lt;br /&gt;  public key: bEnc2dZ0wBF6R3GBNmeGWidnyng+w4I2QZNFqFA2emA=&lt;br /&gt;  private key: (hidden)&lt;br /&gt;  listening port: 51820&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Ahora que el servidor ya está configurado, procederemos a configurar los clientes:&lt;/p&gt;
&lt;h5 id=&quot;configuraci%C3%B3n-cliente-debian.&quot; tabindex=&quot;-1&quot;&gt;Configuración cliente debian.&lt;/h5&gt;
&lt;p&gt;Instalamos wireguard y creamos el par de claves:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;vagrant@wireguard-client:~$ sudo apt install wireguard&lt;br /&gt;vagrant@wireguard-client:~$ sudo su&lt;br /&gt;cdroot@wireguard-client:/home/vagrant# cd /etc/wireguard/&lt;br /&gt;root@wireguard-client:/etc/wireguard# wg genkey | tee clientprivatekey | wg pubkey &gt; clientpublickey&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Creamos el fichero de configuración:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;root@wireguard-client:/etc/wireguard# nano wg0.conf&lt;br /&gt;&lt;br /&gt;[Interface]&lt;br /&gt;Address = 10.0.100.2&lt;br /&gt;PrivateKey = kDCxFoW5x4U41A826+d1l8k6J1frGKHYk5PsK2A7Y2k=&lt;br /&gt;ListenPort = 51820&lt;br /&gt;&lt;br /&gt;[Peer]&lt;br /&gt;PublicKey = bEnc2dZ0wBF6R3GBNmeGWidnyng+w4I2QZNFqFA2emA=&lt;br /&gt;AllowedIPs = 0.0.0.0/0&lt;br /&gt;Endpoint = 192.168.100.1:51820&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Ahora del lado del servidor editamos la configuración y añadimos un bloque peer:&lt;/p&gt;
&lt;h4 id=&quot;2.2.-vpn-sitio-a-sitio-con-wireguard.-(10-puntos)&quot; tabindex=&quot;-1&quot;&gt;2.2. VPN sitio a sitio con WireGuard. (10 puntos)&lt;/h4&gt;
&lt;p&gt;&lt;strong&gt;Configura una VPN sitio a sitio usando WireGuard. Documenta el proceso adecuadamente y compáralo con el del apartado B.&lt;/strong&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;h2 id=&quot;documento-realizado-por%3A&quot; tabindex=&quot;-1&quot;&gt;&lt;strong&gt;Documento realizado por:&lt;/strong&gt;&lt;/h2&gt;
&lt;p&gt;✒️ &lt;strong&gt;Alejandro Montes Delgado&lt;/strong&gt; - &lt;em&gt;2º ASIR&lt;/em&gt;&lt;/p&gt;
</content>
	</entry>
	
	<entry>
		<title>Criptografía III. Certificados Digitales. HTTPS.</title>
		<link href="https://reeseschultz.github.io/post/criptografia-iii.-certificados-digitales.-https./"/>
		<updated>2023-01-05T00:00:00Z</updated>
		<id>https://reeseschultz.github.io/post/criptografia-iii.-certificados-digitales.-https./</id>
		<content type="html">&lt;h2 id=&quot;certificado-digital-de-persona-f%C3%ADsica.&quot; tabindex=&quot;-1&quot;&gt;Certificado digital de persona física.&lt;/h2&gt;
&lt;h3 id=&quot;tarea-1%3A-instalaci%C3%B3n-del-certificado.&quot; tabindex=&quot;-1&quot;&gt;Tarea 1: Instalación del certificado.&lt;/h3&gt;
&lt;h4 id=&quot;una-vez-que-hayas-obtenido-tu-certificado%2C-explica-brevemente-como-se-instala-en-tu-navegador-favorito.&quot; tabindex=&quot;-1&quot;&gt;Una vez que hayas obtenido tu certificado, explica brevemente como se instala en tu navegador favorito.&lt;/h4&gt;
&lt;p&gt;Para importarlo en Firefox hacemos los siguientes pasos:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Abrimos los ajustes de Firefox.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Vamos a la pestaña Privacidad &amp;amp; Seguridad.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;En seguridad, hay un apartado de certificados y le damos a la opción de ver certificados. Se nos abrirá la siguiente pestaña:&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&lt;img src=&quot;https://reeseschultz.github.io/img/SAD-cripto3.t1.1.png&quot; alt=&quot;SAD-cripto3.t1.1.png&quot; /&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Como vemos mi certificado ya está importado, pero tenemos que elegir la opción de importar y elegimos nuestro certificado. Le damos a aceptar para que se guarden los cambios y lo habremos instalado correctamente.&lt;/li&gt;
&lt;/ul&gt;
&lt;h4 id=&quot;muestra-una-captura-de-pantalla-donde-se-vea-las-preferencias-del-navegador-donde-se-ve-instalado-tu-certificado.&quot; tabindex=&quot;-1&quot;&gt;Muestra una captura de pantalla donde se vea las preferencias del navegador donde se ve instalado tu certificado.&lt;/h4&gt;
&lt;p&gt;Para no repetir la captura, en el anterior apartado muestro mi certificado instalado.&lt;/p&gt;
&lt;h4 id=&quot;%C2%BFc%C3%B3mo-puedes-hacer-una-copia-de-tu-certificado%3F%2C-%C2%BFcomo-vas-a-realizar-la-copia-de-seguridad-de-tu-certificado%3F.-razona-la-respuesta.&quot; tabindex=&quot;-1&quot;&gt;¿Cómo puedes hacer una copia de tu certificado?, ¿Como vas a realizar la copia de seguridad de tu certificado?. Razona la respuesta.&lt;/h4&gt;
&lt;p&gt;Estando en el mismo apartado de ajuste que en el primer apartado, si seleccionamos nuestro certificado, nos da una opción que es  &lt;code&gt;Hacer copia...&lt;/code&gt; .&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://reeseschultz.github.io/img/SAD-cripto3.t1.2.png&quot; alt=&quot;SAD-cripto3.t1.2.png&quot; /&gt;&lt;/p&gt;
&lt;p&gt;Elegimos un nombre para la copia y lo guardamos. Tendremos que elegir una contraseña de respaldo de la copia del certificado, para cuando vayamos a restaurarla la introduzcamos.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://reeseschultz.github.io/img/SAD-cripto3.t1.3.png&quot; alt=&quot;SAD-cripto3.t1.3.png&quot; /&gt;&lt;/p&gt;
&lt;h4 id=&quot;investiga-como-exportar-la-clave-p%C3%BAblica-de-tu-certificado.&quot; tabindex=&quot;-1&quot;&gt;Investiga como exportar la clave pública de tu certificado.&lt;/h4&gt;
&lt;p&gt;Lo primero que hacemos es generar el par de claves del certificado con el siguiente comando:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;alemd@debian:~/2ASIR$ openssl pkcs12 -in MONTES_DELGADO_ALEJANDRO___49125015M.p12 -nocerts -nodes -out MONTES_DELGADO_ALEJANDRO___49125015M.key&lt;br /&gt;Enter Import Password:&lt;br /&gt;alemd@debian:~/2ASIR$&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Ahora usamos el siguiente comando para extraer la clave pública:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;alemd@debian:~/2ASIR$ openssl rsa -in MONTES_DELGADO_ALEJANDRO___49125015M.key -pubout -out MONTES_DELGADO_ALEJANDRO___49125015M.pub&lt;br /&gt;writing RSA key&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;muestro un ls del directorio para comprobar que se han generado los ficheros correspondientes:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;alemd@debian:~/2ASIR$ ls | grep ^MONTES*&lt;br /&gt;MONTES_DELGADO_ALEJANDRO___49125015M.key&lt;br /&gt;MONTES_DELGADO_ALEJANDRO___49125015M.p12&lt;br /&gt;MONTES_DELGADO_ALEJANDRO___49125015M.pub&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&quot;tarea-2%3A-validaci%C3%B3n-del-certificado.&quot; tabindex=&quot;-1&quot;&gt;Tarea 2: Validación del certificado.&lt;/h3&gt;
&lt;h4 id=&quot;instala-en-tu-ordenador-el-software-autofirma-y-desde-la-p%C3%A1gina-de-valide-valida-tu-certificado.-muestra-capturas-de-pantalla-donde-se-comprueba-la-validaci%C3%B3n.&quot; tabindex=&quot;-1&quot;&gt;Instala en tu ordenador el software autofirma y desde la página de VALIDe valida tu certificado. Muestra capturas de pantalla donde se comprueba la validación.&lt;/h4&gt;
&lt;p&gt;Lo primero que haremos será instalar las dependencias correspondiente para que funcione autofirma:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;sudo apt install default-jdk libnss3-tools&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Desde la página de &lt;a href=&quot;https://autofirma.net/como-instalar-autofirma-en-linux/&quot;&gt;autofirma&lt;/a&gt; descargaremos el zip y lo descomprimiremos.&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;alemd@debian:~/2ASIR$ unzip AutoFirma_Linux.zip&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Como podemos comprobar autofirma funciona correctamente.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://reeseschultz.github.io/img/SAD-cripto3.t2.1.png&quot; alt=&quot;SAD-cripto3.t2.1.png&quot; /&gt;&lt;/p&gt;
&lt;p&gt;Ahora en la página web de VALIDe, validaremos el certificado en la sección de validar el certificado, subiremos nuestro certificado y validaremos el captcha.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://reeseschultz.github.io/img/SAD-cripto3.t2.png&quot; alt=&quot;SAD-cripto3.t2.png&quot; /&gt;&lt;/p&gt;
&lt;h3 id=&quot;tarea-3%3A-firma-electr%C3%B3nica.&quot; tabindex=&quot;-1&quot;&gt;Tarea 3: Firma electrónica.&lt;/h3&gt;
&lt;h4 id=&quot;utilizando-la-p%C3%A1gina-valide-y-el-programa-autofirma%2C-firma-un-documento-con-tu-certificado-y-env%C3%ADalo-por-correo-a-un-compa%C3%B1ero.&quot; tabindex=&quot;-1&quot;&gt;Utilizando la página VALIDe y el programa autofirma, firma un documento con tu certificado y envíalo por correo a un compañero.&lt;/h4&gt;
&lt;p&gt;Si usamos VALIDe, en la sección de realizar firma, pulsamos sobre el botón firmar y subimos un archivo nuestro. Guardaremos el documento y se lo enviaremos a nuestro compañero.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://reeseschultz.github.io/img/SAD-cripto3.t3.1.png&quot; alt=&quot;SAD-cripto3.t3.1.png&quot; /&gt;&lt;/p&gt;
&lt;p&gt;Ahora muestro como he firmado otro documento con Autofirma. Pulsamos sobre seleccionar ficheros a firmar y buscamos el fichero que queremos firmar. Como podemos ver en los detalles está firmado por mí.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://reeseschultz.github.io/img/SAD-cripto3.t3.2.png&quot; alt=&quot;SAD-cripto3.t3.2.png&quot; /&gt;&lt;/p&gt;
&lt;p&gt;Ahora envío los ficheros a mi compañero Juanje por correo.&lt;/p&gt;
&lt;h4 id=&quot;tu-debes-recibir-otro-documento-firmado-por-un-compa%C3%B1ero-y-utilizando-las-herramientas-anteriores-debes-visualizar-la-firma-(visualizar-firma)-y-(verificar-firma).-%C2%BFpuedes-verificar-la-firma-aunque-no-tengas-la-clave-p%C3%BAblica-de-tu-compa%C3%B1ero%3F%2C-%C2%BFes-necesario-estar-conectado-a-internet-para-hacer-la-validaci%C3%B3n-de-la-firma%3F.-razona-tus-respuestas.&quot; tabindex=&quot;-1&quot;&gt;Tu debes recibir otro documento firmado por un compañero y utilizando las herramientas anteriores debes visualizar la firma (Visualizar Firma) y (Verificar Firma). ¿Puedes verificar la firma aunque no tengas la clave pública de tu compañero?, ¿Es necesario estar conectado a internet para hacer la validación de la firma?. Razona tus respuestas.&lt;/h4&gt;
&lt;p&gt;Visualizo la firma en VALIDe:&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://reeseschultz.github.io/img/SAD-cripto3.t3.6.png&quot; alt=&quot;SAD-cripto3.t3.6.png&quot; /&gt;&lt;/p&gt;
&lt;p&gt;Visualizo la firma en Autofirma:&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://reeseschultz.github.io/img/SAD-cripto3.t3.5.png&quot; alt=&quot;SAD-cripto3.t3.5.png&quot; /&gt;&lt;/p&gt;
&lt;p&gt;Juanje me ha enviado 2 ficheros. El primero lo valido con VALIDe:&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://reeseschultz.github.io/img/SAD-cripto3.t3.4.png&quot; alt=&quot;SAD-cripto3.t3.4.png&quot; /&gt;&lt;/p&gt;
&lt;p&gt;Ahora valido el otro fichero con Autofirma:&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://reeseschultz.github.io/img/SAD-cripto3.t3.3.png&quot; alt=&quot;SAD-cripto3.t3.3.png&quot; /&gt;&lt;/p&gt;
&lt;h4 id=&quot;entre-dos-compa%C3%B1eros%2C-firmar-los-dos-un-documento%2C-verificar-la-firma-para-comprobar-que-est%C3%A1-firmado-por-los-dos.&quot; tabindex=&quot;-1&quot;&gt;Entre dos compañeros, firmar los dos un documento, verificar la firma para comprobar que está firmado por los dos.&lt;/h4&gt;
&lt;p&gt;Ahora con Autofirma, firmo un documento que me ha enviado Juanje:&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://reeseschultz.github.io/img/SAD-cripto3.t3.7.png&quot; alt=&quot;SAD-cripto3.t3.7.png&quot; /&gt;&lt;/p&gt;
&lt;p&gt;Como podemos ver, el fichero es firmado por Juanje y por mí. También lo he firmado con VALIDe:&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://reeseschultz.github.io/img/SAD-cripto3.t3.8.png&quot; alt=&quot;SAD-cripto3.t3.8.png&quot; /&gt;&lt;/p&gt;
&lt;h3 id=&quot;tarea-4%3A-autentificaci%C3%B3n.&quot; tabindex=&quot;-1&quot;&gt;Tarea 4: Autentificación.&lt;/h3&gt;
&lt;h4 id=&quot;utilizando-tu-certificado-accede-a-alguna-p%C3%A1gina-de-la-administraci%C3%B3n-p%C3%BAblica-)cita-m%C3%A9dica%2C-becas%2C-puntos-del-carnet%2C%E2%80%A6).-entrega-capturas-de-pantalla-donde-se-demuestre-el-acceso-a-ellas.&quot; tabindex=&quot;-1&quot;&gt;Utilizando tu certificado accede a alguna página de la administración pública )cita médica, becas, puntos del carnet,…). Entrega capturas de pantalla donde se demuestre el acceso a ellas.&lt;/h4&gt;
&lt;p&gt;Entraré en la &lt;a href=&quot;https://sede.dgt.gob.es/es/&quot;&gt;Sede de la DGT&lt;/a&gt; con mi certificado digital. Puelsaremos en el botón de arriba a la derecha &lt;code&gt;Acceso a mi dgt&lt;/code&gt; :&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://reeseschultz.github.io/img/SAD-cripto3.t3.9.png&quot; alt=&quot;SAD-cripto3.t3.9.png&quot; /&gt;&lt;/p&gt;
&lt;p&gt;Nos llevará a la pasarela de clave para iniciar sesión con el certificado electrónico y elegiremos nuestro certificado.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://reeseschultz.github.io/img/SAD-cripto3.t3.10.png&quot; alt=&quot;SAD-cripto3.t3.10.png&quot; /&gt;&lt;/p&gt;
&lt;p&gt;Como podemos ver, hemos iniciado sesión con mi certificado digital.&lt;/p&gt;
&lt;hr /&gt;
&lt;h2 id=&quot;https-%2F-ssl.&quot; tabindex=&quot;-1&quot;&gt;HTTPS / SSL.&lt;/h2&gt;
&lt;h3 id=&quot;tarea-1%3A-certificado-autofirmado.-ca&quot; tabindex=&quot;-1&quot;&gt;Tarea 1: Certificado autofirmado. CA&lt;/h3&gt;
&lt;h4 id=&quot;crear-su-autoridad-certificadora-(generar-el-certificado-digital-de-la-ca).-mostrar-el-fichero-de-configuraci%C3%B3n-de-la-ac.&quot; tabindex=&quot;-1&quot;&gt;Crear su autoridad certificadora (generar el certificado digital de la CA). Mostrar el fichero de configuración de la AC.&lt;/h4&gt;
&lt;p&gt;Lo primero que haré, será crear carpetas para mantener una organización con los archivos.&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;alemd@debian:~/2ASIR/SAD/cripto3/CA$ mkdir certs csr crl newcerts private&lt;br /&gt;alemd@debian:~/2ASIR/SAD/cripto3/CA$ chmod 700 private&lt;br /&gt;alemd@debian:~/2ASIR/SAD/cripto3/CA$ touch index.txt&lt;br /&gt;alemd@debian:~/2ASIR/SAD/cripto3/CA$ touch index.txt.attr&lt;br /&gt;alemd@debian:~/2ASIR/SAD/cripto3/CA$ echo 1000 &gt; serial&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Añado las siguientes variables de entorno:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;alemd@debian:~/2ASIR/SAD/cripto3/CA$ countryName_default=&quot;ES&quot;&lt;br /&gt;alemd@debian:~/2ASIR/SAD/cripto3/CA$ stateOrProvinceName_default=&quot;Sevilla&quot;&lt;br /&gt;alemd@debian:~/2ASIR/SAD/cripto3/CA$ localityName_default=&quot;Utrera&quot;&lt;br /&gt;alemd@debian:~/2ASIR/SAD/cripto3/CA$ organizationName_default=&quot;Alejandro&quot;&lt;br /&gt;alemd@debian:~/2ASIR/SAD/cripto3/CA$ organizationalUnitName_default=&quot;ASIR2&quot;&lt;br /&gt;alemd@debian:~/2ASIR/SAD/cripto3/CA$ emailAddress_default=&quot;aaleemd11@gmail.com&quot;&lt;br /&gt;alemd@debian:~/2ASIR/SAD/cripto3/CA$ DIR_CA=&quot;./&quot;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;A continuación, creo el archivo openssl.cnf&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt; cat &amp;lt;&amp;lt;EOF&gt;$DIR_CA/openssl.conf&lt;br /&gt;[ ca ]&lt;br /&gt;# man ca&lt;br /&gt;default_ca = CA_default&lt;br /&gt;&lt;br /&gt;[ CA_default ]&lt;br /&gt;# Directory and file locations.&lt;br /&gt;dir               = ${DIR_CA}&lt;br /&gt;certs             = ${DIR_CA}certs&lt;br /&gt;crl_dir           = ${DIR_CA}crl&lt;br /&gt;new_certs_dir     = ${DIR_CA}newcerts&lt;br /&gt;database          = ${DIR_CA}index.txt&lt;br /&gt;serial            = ${DIR_CA}serial&lt;br /&gt;RANDFILE          = ${DIR_CA}private/.rand&lt;br /&gt;&lt;br /&gt;# The root key and root certificate.&lt;br /&gt;private_key       = ${DIR_CA}private/private.key&lt;br /&gt;certificate       = ${DIR_CA}certs/cacert.crt&lt;br /&gt;&lt;br /&gt;# For certificate revocation lists.&lt;br /&gt;crlnumber         = ${DIR_CA}crlnumber&lt;br /&gt;crl               = ${DIR_CA}crl/ca.crl.pem&lt;br /&gt;crl_extensions    = crl_ext&lt;br /&gt;default_crl_days  = 30&lt;br /&gt;&lt;br /&gt;# SHA-1 is deprecated, so use SHA-2 instead.&lt;br /&gt;default_md        = sha256&lt;br /&gt;&lt;br /&gt;name_opt          = ca_default&lt;br /&gt;cert_opt          = ca_default&lt;br /&gt;default_days      = 375&lt;br /&gt;preserve          = no&lt;br /&gt;policy            = policy_strict&lt;br /&gt;&lt;br /&gt;[ policy_strict ]&lt;br /&gt;# The root CA should only sign intermediate certificates that match.&lt;br /&gt;EOFendedKeyUsage = critical, OCSPSignings (man ocsp).tg).yEnciphermentes.&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Generamos la clave privada y le cambiamos los permisos a la misma:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;alemd@debian:~/2ASIR/SAD/cripto3/CA$ openssl genrsa -aes256 -out private/private.key 4096&lt;br /&gt;Generating RSA private key, 4096 bit long modulus (2 primes)&lt;br /&gt;...........................................................++++&lt;br /&gt;.......................................................................................................................................................................................................................................................++++&lt;br /&gt;e is 65537 (0x010001)&lt;br /&gt;Enter pass phrase for private/private.key:&lt;br /&gt;Verifying - Enter pass phrase for private/private.key:&lt;br /&gt;alemd@debian:~/2ASIR/SAD/cripto3/CA$ chmod 400 private/private.key&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Con el siguiente comando, editamos el fichero openssl.cnf:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;alemd@debian:~/2ASIR/SAD/cripto3/CA$ sed -i &#39;s|xxxsubjectAltNamexxx =|subjectAltName = ${ENV::SAN}|g&#39; openssl.conf&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Y ahora, creamos el certificado autofirmado para la CA:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;alemd@debian:~/2ASIR/SAD/cripto3/CA$ URL=juanjesus.iesgn.org&lt;br /&gt;alemd@debian:~/2ASIR/SAD/cripto3/CA$ export SAN=DNS:$URL&lt;br /&gt;alemd@debian:~/2ASIR/SAD/cripto3/CA$ openssl req -config openssl.conf -key private/private.key -new -x509 -days 3650 -sha256 -extensions v3_ca -out certs/cacert.crt&lt;br /&gt;Enter pass phrase for private/private.key:&lt;br /&gt;You are about to be asked to enter information that will be incorporated&lt;br /&gt;into your certificate request.&lt;br /&gt;What you are about to enter is what is called a Distinguished Name or a DN.&lt;br /&gt;There are quite a few fields but you can leave some blank&lt;br /&gt;For some fields there will be a default value,&lt;br /&gt;If you enter &#39;.&#39;, the field will be left blank.&lt;br /&gt;-----&lt;br /&gt;Country Name (2 letter code) [ES]:&lt;br /&gt;State or Province Name [Sevilla]:&lt;br /&gt;Locality Name [Utrera]:&lt;br /&gt;Organization Name [Alejandro]:&lt;br /&gt;Organizational Unit Name [ASIR2]:&lt;br /&gt;Common Name []:alejandro.montes&lt;br /&gt;Email Address [aaleemd11@gmail.com]:&lt;br /&gt;alemd@debian:~/2ASIR/SAD/cripto3/CA$ chmod 444 certs/cacert.crt&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&quot;debe-recibir-el-fichero-csr-(solicitud-de-firmar-un-certificado)-de-su-compa%C3%B1ero%2C-debe-firmarlo-y-enviar-el-certificado-generado-a-su-compa%C3%B1ero.&quot; tabindex=&quot;-1&quot;&gt;Debe recibir el fichero CSR (Solicitud de Firmar un Certificado) de su compañero, debe firmarlo y enviar el certificado generado a su compañero.&lt;/h4&gt;
&lt;p&gt;Una vez que mi compañero Juanje me ha enviado el fichero, lo firmo:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;alemd@debian:~/2ASIR/SAD/cripto3/CA$ openssl ca -config openssl.conf -extensions v3_req -days 3650 -notext -md sha256 -in csr/juanjesus-aleca.csr -out certs/juanjesus-aleca.crt&lt;br /&gt;Using configuration from openssl.conf&lt;br /&gt;Enter pass phrase for ./private/private.key:&lt;br /&gt;Check that the request matches the signature&lt;br /&gt;Signature ok&lt;br /&gt;Certificate Details:&lt;br /&gt;        Serial Number: 4096 (0x1000)&lt;br /&gt;        Validity&lt;br /&gt;            Not Before: Jan  8 12:21:19 2023 GMT&lt;br /&gt;            Not After : Jan  5 12:21:19 2033 GMT&lt;br /&gt;        Subject:&lt;br /&gt;            countryName               = ES&lt;br /&gt;            stateOrProvinceName       = Sevilla&lt;br /&gt;            organizationName          = Alejandro&lt;br /&gt;            organizationalUnitName    = ASIR2&lt;br /&gt;            commonName                = juanjesus.debian&lt;br /&gt;            emailAddress              = githubemail1asir@gmail.com&lt;br /&gt;        X509v3 extensions:&lt;br /&gt;            X509v3 Basic Constraints: &lt;br /&gt;                CA:FALSE&lt;br /&gt;            X509v3 Key Usage: &lt;br /&gt;                Digital Signature, Non Repudiation, Key Encipherment&lt;br /&gt;            X509v3 Subject Alternative Name: &lt;br /&gt;                DNS:juanjesus.iesgn.org&lt;br /&gt;Certificate is to be certified until Jan  5 12:21:19 2033 GMT (3650 days)&lt;br /&gt;Sign the certificate? [y/n]:y&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;1 out of 1 certificate requests certified, commit? [y/n]y&lt;br /&gt;Write out database with 1 new entries&lt;br /&gt;Data Base Updated&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Ahora le envío a Juanje los ficheros &lt;code&gt;juanjesus-aleca.crt&lt;/code&gt; y el fichero &lt;code&gt;cacert.crt&lt;/code&gt;&lt;/p&gt;
&lt;h4 id=&quot;%C2%BFqu%C3%A9-otra-informaci%C3%B3n-debes-aportar-a-tu-compa%C3%B1ero-para-que-%C3%A9ste-configure-de-forma-adecuada-su-servidor-web-con-el-certificado-generado%3F&quot; tabindex=&quot;-1&quot;&gt;¿Qué otra información debes aportar a tu compañero para que éste configure de forma adecuada su servidor web con el certificado generado?&lt;/h4&gt;
&lt;p&gt;Mi compañero necesitara el fichero &lt;code&gt;cacert.crt&lt;/code&gt; que es el certificado autofirmado de la CA para que se pueda verificar la firma del certificado que le he enviado.&lt;/p&gt;
&lt;h3 id=&quot;tarea-1%3A-certificado-autofirmado.-administrador-web&quot; tabindex=&quot;-1&quot;&gt;Tarea 1: Certificado autofirmado. Administrador Web&lt;/h3&gt;
&lt;p&gt;Antes que nada, dejo un resumen de los comandos usados para crear el servidor web con el virtualhost &lt;code&gt;alejandro.iesgn.org&lt;/code&gt;.&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;usuario@alejandro:~$ sudo apt update&lt;br /&gt;usuario@alejandro:~$ sudo apt install apache2&lt;br /&gt;usuario@alejandro:~$ sudo a2dissite 000-default.conf&lt;br /&gt;usuario@alejandro:~$ sudo nano -cl /etc/apache2/sites-available/alejandro.iesgn.org.conf&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Añadimos lo siguiente a la configuración del virtualhost:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;&amp;lt;VirtualHost *:80&gt;&lt;br /&gt;    ServerName alejandro.iesgn.org&lt;br /&gt;    DocumentRoot /var/www/html/alejandro.iesgn.org&lt;br /&gt;    ErrorLog ${APACHE_LOG_DIR}/error-alejandro.log&lt;br /&gt;    CustomLog ${APACHE_LOG_DIR}/access-alejandro.log combined&lt;br /&gt;&amp;lt;/VirtualHost&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;He puesto un fichero de prueba para visualizar la página web. Activamos el virtual host:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;usuario@alejandro:~$ sudo a2ensite alejandro.iesgn.org.conf&lt;br /&gt;Enabling site alejandro.iesgn.org.&lt;br /&gt;To activate the new configuration, you need to run:&lt;br /&gt;  systemctl reload apache2&lt;br /&gt;usuario@alejandro:~$ sudo systemctl reload apache2&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Y por último en mi máquina cliente añadimos al /etc/hosts lo siguiente:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;172.22.9.231 alejandro.iesgn.org&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&quot;crea-una-clave-privada-rsa-de-4096-bits-para-identificar-el-servidor.&quot; tabindex=&quot;-1&quot;&gt;Crea una clave privada RSA de 4096 bits para identificar el servidor.&lt;/h4&gt;
&lt;p&gt;Usamos el siguiente comando para crear la clave y le cambiamos los permisos al fichero:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;usuario@alejandro:~$ sudo openssl genrsa -aes256 -out /etc/ssl/private/alejandro-priv.key 4096&lt;br /&gt;Generating RSA private key, 4096 bit long modulus (2 primes)&lt;br /&gt;........................++++&lt;br /&gt;...............................................................................................................................................................++++&lt;br /&gt;e is 65537 (0x010001)&lt;br /&gt;Enter pass phrase for /etc/ssl/private/alejandro-priv.key:&lt;br /&gt;Verifying - Enter pass phrase for /etc/ssl/private/alejandro-priv.key:&lt;br /&gt;usuario@alejandro:~$ sudo chmod 400 /etc/ssl/private/alejandro-priv.key&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&quot;utiliza-la-clave-anterior-para-generar-un-csr%2C-considerando-que-deseas-acceder-al-servidor-con-el-fqdn-(tunombre.iesgn.org).&quot; tabindex=&quot;-1&quot;&gt;Utiliza la clave anterior para generar un CSR, considerando que deseas acceder al servidor con el FQDN (&lt;a href=&quot;http://tunombre.iesgn.org/&quot;&gt;tunombre.iesgn.org&lt;/a&gt;).&lt;/h4&gt;
&lt;p&gt;El comando es el siguiente:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;usuario@alejandro:~$ sudo openssl req -new -sha256 -key /etc/ssl/private/alejandro-priv.key -out alejandro.csr&lt;br /&gt;Enter pass phrase for /etc/ssl/private/alejandro-priv.key:&lt;br /&gt;You are about to be asked to enter information that will be incorporated&lt;br /&gt;into your certificate request.&lt;br /&gt;What you are about to enter is what is called a Distinguished Name or a DN.&lt;br /&gt;There are quite a few fields but you can leave some blank&lt;br /&gt;For some fields there will be a default value,&lt;br /&gt;If you enter &#39;.&#39;, the field will be left blank.&lt;br /&gt;-----&lt;br /&gt;Country Name (2 letter code) [AU]:ES&lt;br /&gt;State or Province Name (full name) [Some-State]:Sevilla&lt;br /&gt;Locality Name (eg, city) []:Dos Hermanas&lt;br /&gt;Organization Name (eg, company) [Internet Widgits Pty Ltd]:Juanje&lt;br /&gt;Organizational Unit Name (eg, section) []:ASIR2&lt;br /&gt;Common Name (e.g. server FQDN or YOUR name) []:alejandro.montes&lt;br /&gt;Email Address []:aaleemd11@gmail.com&lt;br /&gt;&lt;br /&gt;Please enter the following &#39;extra&#39; attributes&lt;br /&gt;to be sent with your certificate request&lt;br /&gt;A challenge password []:       &lt;br /&gt;An optional company name []:&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&quot;env%C3%ADa-la-solicitud-de-firma-a-la-entidad-certificadora-(su-compa%C3%B1ero).&quot; tabindex=&quot;-1&quot;&gt;Envía la solicitud de firma a la entidad certificadora (su compañero).&lt;/h4&gt;
&lt;p&gt;El fichero CSR ha sido enviado a mi compañero Juanje.&lt;/p&gt;
&lt;h4 id=&quot;recibe-como-respuesta-un-certificado-x.509-para-el-servidor-firmado-y-el-certificado-de-la-autoridad-certificadora.&quot; tabindex=&quot;-1&quot;&gt;Recibe como respuesta un certificado X.509 para el servidor firmado y el certificado de la autoridad certificadora.&lt;/h4&gt;
&lt;p&gt;Juanje me envía los ficheros &lt;code&gt;alejandro.crt&lt;/code&gt; y &lt;code&gt;cacert.crt&lt;/code&gt;.&lt;/p&gt;
&lt;h4 id=&quot;configura-tu-servidor-web-con-https-en-el-puerto-443%2C-haciendo-que-las-peticiones-http-se-redireccionen-a-https-(forzar-https).&quot; tabindex=&quot;-1&quot;&gt;Configura tu servidor web con https en el puerto 443, haciendo que las peticiones http se redireccionen a https (forzar https).&lt;/h4&gt;
&lt;p&gt;Creo el virtualhost para https:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;usuario@alejandro:~$ sudo nano -cl /etc/apache2/sites-available/ssl-alejandro.iesgn.org.conf&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Añado lo siguiente:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt; &amp;lt;IfModule mod_ssl.c&gt;&lt;br /&gt;     &amp;lt;VirtualHost *:443&gt;&lt;br /&gt;         ServerName alejandro.iesgn.org&lt;br /&gt;         DocumentRoot /var/www/html/alejandro.iesgn.org&lt;br /&gt;         ErrorLog ${APACHE_LOG_DIR}/error-alejandro.log&lt;br /&gt;         CustomLog ${APACHE_LOG_DIR}/access-alejandro.log combined&lt;br /&gt;&lt;br /&gt;         SSLEngine on&lt;br /&gt;         SSLCertificateFile /etc/ssl/certs/alejandro.crt&lt;br /&gt;         SSLCertificateKeyFile /etc/ssl/private/alejandro-priv.key&lt;br /&gt;         SSLCertificateChainFile /etc/ssl/certs/cacert.crt&lt;br /&gt;&lt;br /&gt;         &amp;lt;Directory /var/www/html/alejandro.iesgn.org&gt;&lt;br /&gt;             Options Indexes FollowSymLinks&lt;br /&gt;             AllowOverride None&lt;br /&gt;             Require all granted&lt;br /&gt;         &amp;lt;/Directory&gt;&lt;br /&gt;     &amp;lt;/VirtualHost&gt;&lt;br /&gt; &amp;lt;/IfModule&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;A continuación, muevo los ficheros a sus directorios correspondientes:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;usuario@alejandro:~$ sudo mv alejandro.crt /etc/ssl/certs/&lt;br /&gt;usuario@alejandro:~$ sudo mv cacert.crt /etc/ssl/certs/&lt;br /&gt;usuario@alejandro:~$ sudo chown root:root /etc/ssl/certs/alejandro.crt&lt;br /&gt;usuario@alejandro:~$ sudo chown root:root /etc/ssl/certs/cacert.crt&lt;br /&gt;usuario@alejandro:~$ sudo chmod 644 /etc/ssl/certs/alejandro.crt&lt;br /&gt;usuario@alejandro:~$ sudo chmod 644 /etc/ssl/certs/cacert.crt&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;por último, activamos el módulo SSL de apache, el virtualhost y recargamos el servicio:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;usuario@alejandro:~$ sudo a2enmod ssl&lt;br /&gt;Considering dependency setenvif for ssl:&lt;br /&gt;Module setenvif already enabled&lt;br /&gt;Considering dependency mime for ssl:&lt;br /&gt;Module mime already enabled&lt;br /&gt;Considering dependency socache_shmcb for ssl:&lt;br /&gt;Enabling module socache_shmcb.&lt;br /&gt;Enabling module ssl.&lt;br /&gt;See /usr/share/doc/apache2/README.Debian.gz on how to configure SSL and create self-signed certificates.&lt;br /&gt;To activate the new configuration, you need to run:&lt;br /&gt;  systemctl restart apache2&lt;br /&gt;usuario@alejandro:~$ sudo a2ensite ssl-alejandro.iesgn.org.conf&lt;br /&gt;Enabling site ssl-alejandro.iesgn.org.&lt;br /&gt;To activate the new configuration, you need to run:&lt;br /&gt;  systemctl reload apache2&lt;br /&gt;usuario@alejandro:~$ sudo systemctl reload apache2&lt;br /&gt;🔐 Enter passphrase for SSL/TLS keys for alejandro.iesgn.org:443 (RSA): (p*********             &lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Para que nos redirija a HTTPS, tenemos que hacer lo siguiente:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;alemd@debian:~$ sudo nano -cl /etc/apache2/sites-available/ssl-alejandro.iesgn.org.conf&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Tenemos que dejar el fichero de la siguiente manera:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;&amp;lt;VirtualHost *:80&gt;&lt;br /&gt;     ServerName alejandro.iesgn.org&lt;br /&gt;     DocumentRoot /var/www/html/alejandro.iesgn.org&lt;br /&gt;     ErrorLog ${APACHE_LOG_DIR}/error-alejandro.log&lt;br /&gt;     CustomLog ${APACHE_LOG_DIR}/access-alejandro.log combined&lt;br /&gt;     Redirect 301 / https://alejandro.iesgn.org/&lt;br /&gt;&amp;lt;/VirtualHost&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Volvemos a recargar apache para que se apliquen los cambios.&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;usuario@alejandro:~$ sudo systemctl reload apache2&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Para que al entrar no nos aparezca el mensaje de que el certificado no es reconocido por mi navegador tendremos que importar en el navegador el certificado autofirmado de la CA  de Juanje que es el archivo &lt;code&gt;cacert.crt&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://reeseschultz.github.io/img/SAD-cripto3.t6.2.png&quot; alt=&quot;SAD-cripto3.t6.2.png&quot; /&gt;&lt;/p&gt;
&lt;h4 id=&quot;instala-ahora-un-servidor-nginx%2C-y-realiza-la-misma-configuraci%C3%B3n-que-anteriormente-para-que-se-sirva-la-p%C3%A1gina-con-https.&quot; tabindex=&quot;-1&quot;&gt;Instala ahora un servidor nginx, y realiza la misma configuración que anteriormente para que se sirva la página con HTTPS.&lt;/h4&gt;
&lt;p&gt;Lo primero que haremos será deshabilitar apache2:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;usuario@alejandro:~$ sudo systemctl disable --now apache2&lt;br /&gt;Synchronizing state of apache2.service with SysV service script with /lib/systemd/systemd-sysv-install.&lt;br /&gt;Executing: /lib/systemd/systemd-sysv-install disable apache2&lt;br /&gt;Removed /etc/systemd/system/multi-user.target.wants/apache2.service.&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Instalamos nginx:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;usuario@alejandro:~$ sudo apt install nginx&lt;br /&gt;Reading package lists... Done&lt;br /&gt;Building dependency tree... Done&lt;br /&gt;Reading state information... Done&lt;br /&gt;The following additional packages will be installed:&lt;br /&gt;  fontconfig-config fonts-dejavu-core geoip-database libdeflate0&lt;br /&gt;  libfontconfig1 libgd3 libgeoip1 libjbig0 libjpeg62-turbo&lt;br /&gt;  libnginx-mod-http-geoip libnginx-mod-http-image-filter&lt;br /&gt;  libnginx-mod-http-xslt-filter libnginx-mod-mail libnginx-mod-stream&lt;br /&gt;  libnginx-mod-stream-geoip libtiff5 libwebp6 libx11-6 libx11-data&lt;br /&gt;  libxau6 libxcb1 libxdmcp6 libxpm4 libxslt1.1 nginx-common nginx-core&lt;br /&gt;Suggested packages:&lt;br /&gt;  libgd-tools geoip-bin fcgiwrap nginx-doc&lt;br /&gt;The following NEW packages will be installed:&lt;br /&gt;  fontconfig-config fonts-dejavu-core geoip-database libdeflate0&lt;br /&gt;  libfontconfig1 libgd3 libgeoip1 libjbig0 libjpeg62-turbo&lt;br /&gt;  libnginx-mod-http-geoip libnginx-mod-http-image-filter&lt;br /&gt;  libnginx-mod-http-xslt-filter libnginx-mod-mail libnginx-mod-stream&lt;br /&gt;  libnginx-mod-stream-geoip libtiff5 libwebp6 libx11-6 libx11-data&lt;br /&gt;  libxau6 libxcb1 libxdmcp6 libxpm4 libxslt1.1 nginx nginx-common&lt;br /&gt;  nginx-core&lt;br /&gt;0 upgraded, 27 newly installed, 0 to remove and 0 not upgraded.&lt;br /&gt;Need to get 8715 kB of archives.&lt;br /&gt;After this operation, 24.2 MB of additional disk space will be used.&lt;br /&gt;Do you want to continue? [Y/n] y&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Creamos el fichero de configuración del virtualhost de la web:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;usuario@alejandro:~$ sudo nano -cl /etc/nginx/sites-available/alejandro.iesgn.org.conf&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;agregamos lo siguiente:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;server {&lt;br /&gt;    listen 80;&lt;br /&gt;    listen [::]:80;&lt;br /&gt;    server_name alejandro.iesgn.org;&lt;br /&gt;    return 301 https://$server_name$request_uri;&lt;br /&gt;}&lt;br /&gt;&lt;br /&gt;server {&lt;br /&gt;    listen 443 ssl http2;&lt;br /&gt;    listen [::]:443 ssl http2;&lt;br /&gt;    server_name alejandro.iesgn.org;&lt;br /&gt;&lt;br /&gt;    ssl_certificate /etc/ssl/certs/alejandro.crt;&lt;br /&gt;    ssl_certificate_key /etc/ssl/private/alejandro-priv.key;&lt;br /&gt;    ssl_trusted_certificate /etc/ssl/certs/cacert.crt;&lt;br /&gt;&lt;br /&gt;    root /var/www/html/alejandro.iesgn.org;&lt;br /&gt;    index index.html;&lt;br /&gt;&lt;br /&gt;    location / {&lt;br /&gt;        try_files $uri $uri/ =404;&lt;br /&gt;    }&lt;br /&gt;}&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Ahora creamos el enlace simbólico del virtualhost:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt; sudo ln -s /etc/nginx/sites-available/alejandro.iesgn.org.conf /etc/nginx/sites-enabled/&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Modifico la página y reinicio el servicio:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;usuario@alejandro:~$ sudo systemctl restart nginx&lt;br /&gt;usuario@alejandro:~$ sudo nano -cl /var/www/html/alejandro.iesgn.org/index.html&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Accedo a la web:&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://reeseschultz.github.io/img/SAD-cripto3.t6.1.png&quot; alt=&quot;SAD-cripto3.t6.1.png&quot; /&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;h2 id=&quot;documento-realizado-por%3A&quot; tabindex=&quot;-1&quot;&gt;&lt;strong&gt;Documento realizado por:&lt;/strong&gt;&lt;/h2&gt;
&lt;p&gt;✒️ &lt;strong&gt;Alejandro Montes Delgado&lt;/strong&gt; - &lt;em&gt;2º ASIR&lt;/em&gt;&lt;/p&gt;
</content>
	</entry>
	
	<entry>
		<title>Recolección centralizada de logs de sistema, mediante journald.</title>
		<link href="https://reeseschultz.github.io/post/recoleccion-centralizada-de-logs-de-sistema-mediante-journald./"/>
		<updated>2023-01-04T00:00:00Z</updated>
		<id>https://reeseschultz.github.io/post/recoleccion-centralizada-de-logs-de-sistema-mediante-journald./</id>
		<content type="html">&lt;p&gt;Lo primero que tendremos que hacer es instalar el paquete &lt;code&gt;systemd-journal-remote&lt;/code&gt; en todas las máquinas del escenario. Para ello ejecutaremos el siguiente comando&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;usuario@alfa:~$ sudo apt install systemd-journal-remote&lt;br /&gt;[usuario@bravo ~]$ sudo dnf install systemd-journal-remote&lt;br /&gt;ubuntu@charlie:~$ sudo apt install systemd-journal-remote&lt;br /&gt;ubuntu@delta:~$ sudo apt install systemd-journal-remote&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&quot;https://reeseschultz.github.io/img/ASO-P7.1.png&quot; alt=&quot;ASO-P7.1.png&quot; /&gt;&lt;/p&gt;
&lt;h3 id=&quot;configuraci%C3%B3n-del-servidor-alfa.&quot; tabindex=&quot;-1&quot;&gt;Configuración del Servidor Alfa.&lt;/h3&gt;
&lt;p&gt;Una vez hayamos instalado el paquete en todo el escenario, lo siguiente que realizaremos será configurar el servidor que recogerá los logs.&lt;/p&gt;
&lt;p&gt;Ya que no utilizaremos https, desactivaremos esa opción en el fichero:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;usuario@alfa:~$ sudo grep --color -E -- &#39;--listen-http&#39; /lib/systemd/system/systemd-journal-remote.service &lt;br /&gt;ExecStart=/lib/systemd/systemd-journal-remote --listen-https=-3 --output=/var/log/journal/remote/                                                    &lt;br /&gt;usuario@alfa:~$ sudo sed -i &#39;s/--listen-https=-3/--listen-http=-3/g&#39; /lib/systemd/system/systemd-journal-remote.service                               &lt;br /&gt;usuario@alfa:~$ sudo grep --color -E -- &#39;--listen-http&#39; /lib/systemd/system/systemd-journal-remote.service systemd-journal-remote-250-12.el9_1.86_64                              &lt;br /&gt;ExecStart=/lib/systemd/systemd-journal-remote --listen-http=-3 --output=/var/log/journal/remote/         &lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Ahora habilitamos el servicio:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;usuario@alfa:~$ sudo systemctl enable --now systemd-journal-remote.socket&lt;br /&gt;Created symlink /etc/systemd/system/sockets.target.wants/systemd-journal-remote.socket → /lib/systemd/system/systemd-journal-remote.socket.&lt;br /&gt;usuario@alfa:~$ sudo systemctl enable --now systemd-journal-remote.service&lt;br /&gt;usuario@alfa:~$&lt;br /&gt;---&lt;br /&gt;&lt;br /&gt;Si no existe el siguiente directorio, lo creamos:&lt;br /&gt;&lt;br /&gt;```txt&lt;br /&gt;usuario@alfa:~$ sudo mkdir -p /var/log/journal/remote/&lt;br /&gt;usuario@alfa:~$ sudo chown systemd-journal-remote:systemd-journal-remote /var/log/journal/remote&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&quot;configuraci%C3%B3n-de-los-clientes-bravo%2C-charlie-y-delta.&quot; tabindex=&quot;-1&quot;&gt;Configuración de los clientes Bravo, Charlie y Delta.&lt;/h3&gt;
&lt;p&gt;Lo primero que haremos será crear un usuario llamado &lt;code&gt;systemd-journal-upload&lt;/code&gt; con el home &lt;code&gt;/run/systemd&lt;/code&gt; y en el grupo &lt;code&gt;systemd-journal-upload&lt;/code&gt;:&lt;/p&gt;
&lt;p&gt;Bravo&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;[usuario@bravo ~]$ sudo adduser --system --home-dir /run/systemd --no-create-home --user-group systemd-journal-upload&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Charlie y Delta(son iguales)&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;ubuntu@charlie:~$ sudo adduser --system --home /run/systemd --no-create-home --disabled-login --group systemd-journal-upload                                  &lt;br /&gt;[sudo] password for ubuntu:&lt;br /&gt;Adding system user `systemd-journal-upload&#39; (UID 109) ...&lt;br /&gt;Adding new group `systemd-journal-upload&#39; (GID 114) ...&lt;br /&gt;Adding new user `systemd-journal-upload&#39; (UID 109) with group `systemd-journal-upload&#39; ...                                                                    &lt;br /&gt;Not creating home directory `/run/systemd&#39;.&lt;br /&gt;&lt;br /&gt;&lt;br /&gt;ubuntu@delta:~$ sudo adduser --system --home /run/systemd --no-create-home --disabled-login --group systemd-journal-upload                          &lt;br /&gt;[sudo] password for ubuntu:                                               &lt;br /&gt;Adding system user `systemd-journal-upload&#39; (UID 108) ...                 &lt;br /&gt;Adding new group `systemd-journal-upload&#39; (GID 113) ...                   &lt;br /&gt;Adding new user `systemd-journal-upload&#39; (UID 108) with group `systemd-journal-upload&#39; ...                                                          &lt;br /&gt;Not creating home directory `/run/systemd&#39;.                               &lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Una vez creado los usuarios, tenemos que modificar la configuración del journal-upload para indicar que los clientes envíen los logs a alfa.&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;[usuario@bravo ~]$ sudo sed -i &#39;s/# URL=/URL=http:\/\/alfa.alejandro-montes.gonzalonazareno.org:19532/g&#39; /etc/systemd/journal-upload.conf&lt;br /&gt;[usuario@bravo ~]$ sudo grep &#39;URL=&#39; /etc/systemd/journal-upload.conf&lt;br /&gt;URL=http://alfa.alejandro-montes.gonzalonazareno.org:19532&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Repetiremos los mismos comandos en charlie y delta.&lt;/p&gt;
&lt;p&gt;Una vez realizado esto, reiniciaremos el servicio en todos los clientes:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;[usuario@bravo ~]$ sudo systemctl restart systemd-journal-upload.service&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&quot;comprobaciones.&quot; tabindex=&quot;-1&quot;&gt;Comprobaciones.&lt;/h3&gt;
&lt;p&gt;Si en el servidor le hacemos un ls a la ruta donde se guardan los logs de los clientes, se habrán creado 3 archivos distintos:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;usuario@alfa:~$ ls /var/log/journal/remote/&lt;br /&gt;remote-172.16.0.200.journal  remote-192.168.0.3.journal&lt;br /&gt;remote-192.168.0.2.journal&lt;br /&gt;usuario@alfa:~$ &lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Si queremos comprobarlo con el comando journalctl ejecutamos lo siguiente indicando el archivo con la ip del cliente:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;usuario@alfa:~$ sudo journalctl --file /var/log/journal/remote/remote-172.16.0.200.journal&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Y nos aparecerá esto:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;-- Journal begins at Mon 2022-11-28 21:25:01 UTC, ends at Sun 2023-01-08 23:04:44 UTC. --&lt;br /&gt;Nov 28 21:25:01 localhost kernel: Linux version 5.14.0-162.6.1.el9_1.x86_64 (mockbuild@dal1-prod-builder001.bld.equ.rockylinux.org) (gcc (GCC) 11.3.1&gt;&lt;br /&gt;Nov 28 21:25:01 localhost kernel: The list of certified hardware and cloud instances for Red Hat Enterprise Linux 9 can be viewed at the Red Hat Ecos&gt;&lt;br /&gt;Nov 28 21:25:01 localhost kernel: Command line: BOOT_IMAGE=(hd0,gpt2)/vmlinuz-5.14.0-162.6.1.el9_1.x86_64 root=UUID=4814451b-2177-4679-bda1-e10797d12&gt;&lt;br /&gt;Nov 28 21:25:01 localhost kernel: x86/fpu: Supporting XSAVE feature 0x001: &#39;x87 floating point registers&#39;&lt;br /&gt;Nov 28 21:25:01 localhost kernel: x86/fpu: Supporting XSAVE feature 0x002: &#39;SSE registers&#39;&lt;br /&gt;Nov 28 21:25:01 localhost kernel: x86/fpu: Supporting XSAVE feature 0x004: &#39;AVX registers&#39;&lt;br /&gt;Nov 28 21:25:01 localhost kernel: x86/fpu: Supporting XSAVE feature 0x020: &#39;AVX-512 opmask&#39;&lt;br /&gt;Nov 28 21:25:01 localhost kernel: x86/fpu: Supporting XSAVE feature 0x040: &#39;AVX-512 Hi256&#39;&lt;br /&gt;Nov 28 21:25:01 localhost kernel: x86/fpu: Supporting XSAVE feature 0x080: &#39;AVX-512 ZMM_Hi256&#39;&lt;br /&gt;Nov 28 21:25:01 localhost kernel: x86/fpu: Supporting XSAVE feature 0x200: &#39;Protection Keys User registers&#39;&lt;br /&gt;Nov 28 21:25:01 localhost kernel: x86/fpu: xstate_offset[2]:  576, xstate_sizes[2]:  256&lt;br /&gt;Nov 28 21:25:01 localhost kernel: x86/fpu: xstate_offset[5]:  832, xstate_sizes[5]:   64&lt;br /&gt;Nov 28 21:25:01 localhost kernel: x86/fpu: xstate_offset[6]:  896, xstate_sizes[6]:  512&lt;br /&gt;Nov 28 21:25:01 localhost kernel: x86/fpu: xstate_offset[7]: 1408, xstate_sizes[7]: 1024&lt;br /&gt;Nov 28 21:25:01 localhost kernel: x86/fpu: xstate_offset[9]: 2432, xstate_sizes[9]:    8&lt;br /&gt;Nov 28 21:25:01 localhost kernel: x86/fpu: Enabled xstate features 0x2e7, context size is 2440 bytes, using &#39;compacted&#39; format.&lt;br /&gt;Nov 28 21:25:01 localhost kernel: signal: max sigframe size: 3632&lt;br /&gt;Nov 28 21:25:01 localhost kernel: BIOS-provided physical RAM map:&lt;br /&gt;Nov 28 21:25:01 localhost kernel: BIOS-e820: [mem 0x0000000000000000-0x000000000009fbff] usable&lt;br /&gt;Nov 28 21:25:01 localhost kernel: BIOS-e820: [mem 0x000000000009fc00-0x000000000009ffff] reserved&lt;br /&gt;Nov 28 21:25:01 localhost kernel: BIOS-e820: [mem 0x00000000000f0000-0x00000000000fffff] reserved&lt;br /&gt;Nov 28 21:25:01 localhost kernel: BIOS-e820: [mem 0x0000000000100000-0x000000003ffdcfff] usable&lt;br /&gt;Nov 28 21:25:01 localhost kernel: BIOS-e820: [mem 0x000000003ffdd000-0x000000003fffffff] reserved&lt;br /&gt;Nov 28 21:25:01 localhost kernel: BIOS-e820: [mem 0x00000000feffc000-0x00000000feffffff] reserved&lt;br /&gt;Nov 28 21:25:01 localhost kernel: BIOS-e820: [mem 0x00000000fffc0000-0x00000000ffffffff] reserved&lt;br /&gt;Nov 28 21:25:01 localhost kernel: NX (Execute Disable) protection: active&lt;br /&gt;Nov 28 21:25:01 localhost kernel: SMBIOS 2.8 present.&lt;br /&gt;Nov 28 21:25:01 localhost kernel: DMI: OpenStack Foundation OpenStack Nova, BIOS 1.15.0-1 04/01/2014&lt;br /&gt;Nov 28 21:25:01 localhost kernel: Hypervisor detected: KVM&lt;br /&gt;Nov 28 21:25:01 localhost kernel: kvm-clock: Using msrs 4b564d01 and 4b564d00&lt;br /&gt;Nov 28 21:25:01 localhost kernel: kvm-clock: using sched offset of 13231497159309 cycles&lt;br /&gt;Nov 28 21:25:01 localhost kernel: clocksource: kvm-clock: mask: 0xffffffffffffffff max_cycles: 0x1cd42e4dffb, max_idle_ns: 881590591483 ns&lt;br /&gt;Nov 28 21:25:01 localhost kernel: tsc: Detected 2095.082 MHz processor&lt;br /&gt;Nov 28 21:25:01 localhost kernel: e820: update [mem 0x00000000-0x00000fff] usable ==&gt; reserved&lt;br /&gt;Nov 28 21:25:01 localhost kernel: e820: remove [mem 0x000a0000-0x000fffff] usable&lt;br /&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&quot;documento-realizado-por%3A&quot; tabindex=&quot;-1&quot;&gt;&lt;strong&gt;Documento realizado por:&lt;/strong&gt;&lt;/h2&gt;
&lt;p&gt;✒️ &lt;strong&gt;Alejandro Montes Delgado&lt;/strong&gt; - &lt;em&gt;2º ASIR&lt;/em&gt;&lt;/p&gt;
</content>
	</entry>
	
	<entry>
		<title>Despliegue de aplicaciones python.</title>
		<link href="https://reeseschultz.github.io/post/despliegue-de-aplicaciones-python./"/>
		<updated>2023-01-04T00:00:00Z</updated>
		<id>https://reeseschultz.github.io/post/despliegue-de-aplicaciones-python./</id>
		<content type="html">&lt;h3 id=&quot;tarea-1%3A-entorno-de-desarrollo.&quot; tabindex=&quot;-1&quot;&gt;Tarea 1: Entorno de desarrollo.&lt;/h3&gt;
&lt;p&gt;Lo primero que haremos será forkear el repositorio y clonarlo a bravo.&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;[usuario@bravo ~]$ git clone https://github.com/alemd01/django_tutorial.git&lt;br /&gt;Cloning into &#39;django_tutorial&#39;...&lt;br /&gt;remote: Enumerating objects: 158, done.&lt;br /&gt;remote: Counting objects: 100% (5/5), done.&lt;br /&gt;remote: Compressing objects: 100% (5/5), done.&lt;br /&gt;remote: Total 158 (delta 0), reused 2 (delta 0), pack-reused 153&lt;br /&gt;Receiving objects: 100% (158/158), 4.25 MiB | 6.63 MiB/s, done.&lt;br /&gt;Resolving deltas: 100% (50/50), done.&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Una vez clonado el repositorio, lo que haremos será crear un entorno virtual. para ello, Crearemos una carpeta donde guardaremos todos los entornos virtuales y dentro crearemos el entorno virtual.&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;[usuario@bravo ~]$ mkdir venv&lt;br /&gt;[usuario@bravo ~]$ cd venv&lt;br /&gt;[usuario@bravo venv]$ python3 -m venv venv&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Una vez creado el entorno virtual, lo activamos.&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;[usuario@bravo venv]$ source bin/activate&lt;br /&gt;(venv) [usuario@bravo venv]$&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Instalamos los requisitos usando el requirements.txt&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;(venv) [usuario@bravo django_tutorial]$ pip install -r requirements.txt &lt;br /&gt;Collecting Django&lt;br /&gt;  Downloading Django-4.1.5-py3-none-any.whl (8.1 MB)&lt;br /&gt;     |████████████████████████████████| 8.1 MB 1.7 MB/s &lt;br /&gt;Collecting asgiref&amp;lt;4,&gt;=3.5.2&lt;br /&gt;  Downloading asgiref-3.6.0-py3-none-any.whl (23 kB)&lt;br /&gt;Collecting sqlparse&gt;=0.2.2&lt;br /&gt;  Downloading sqlparse-0.4.3-py3-none-any.whl (42 kB)&lt;br /&gt;     |████████████████████████████████| 42 kB 946 kB/s &lt;br /&gt;Installing collected packages: sqlparse, asgiref, Django&lt;br /&gt;Successfully installed Django-4.1.5 asgiref-3.6.0 sqlparse-0.4.3&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Como podemos observar en el fichero &lt;a href=&quot;http://settings.py/&quot;&gt;settings.py&lt;/a&gt;, usaremos sqlite y el nombre de la base de datos será db.sqlite3&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;DATABASES = {&lt;br /&gt;    &#39;default&#39;: {&lt;br /&gt;        &#39;ENGINE&#39;: &#39;django.db.backends.sqlite3&#39;,&lt;br /&gt;        &#39;NAME&#39;: BASE_DIR / &#39;db.sqlite3&#39;,&lt;br /&gt;    }&lt;br /&gt;}&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Para generar la base de datos, tenemos que realizar una migración del fichero &lt;a href=&quot;http://manage.py/&quot;&gt;manage.py&lt;/a&gt; y así se creará un archivo sqlite3.&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;(venv) [usuario@bravo django_tutorial]$ python3 manage.py migrate&lt;br /&gt;Operations to perform:&lt;br /&gt;  Apply all migrations: admin, auth, contenttypes, polls, sessions&lt;br /&gt;Running migrations:&lt;br /&gt;  Applying contenttypes.0001_initial... OK&lt;br /&gt;  Applying auth.0001_initial... OK&lt;br /&gt;  Applying admin.0001_initial... OK&lt;br /&gt;  Applying admin.0002_logentry_remove_auto_add... OK&lt;br /&gt;  Applying admin.0003_logentry_add_action_flag_choices... OK&lt;br /&gt;  Applying contenttypes.0002_remove_content_type_name... OK&lt;br /&gt;  Applying auth.0002_alter_permission_name_max_length... OK&lt;br /&gt;  Applying auth.0003_alter_user_email_max_length... OK&lt;br /&gt;  Applying auth.0004_alter_user_username_opts... OK&lt;br /&gt;  Applying auth.0005_alter_user_last_login_null... OK&lt;br /&gt;  Applying auth.0006_require_contenttypes_0002... OK&lt;br /&gt;  Applying auth.0007_alter_validators_add_error_messages... OK&lt;br /&gt;  Applying auth.0008_alter_user_username_max_length... OK&lt;br /&gt;  Applying auth.0009_alter_user_last_name_max_length... OK&lt;br /&gt;  Applying auth.0010_alter_group_name_max_length... OK&lt;br /&gt;  Applying auth.0011_update_proxy_permissions... OK&lt;br /&gt;  Applying auth.0012_alter_user_first_name_max_length... OK&lt;br /&gt;  Applying polls.0001_initial... OK&lt;br /&gt;  Applying sessions.0001_initial... OK&lt;br /&gt;(venv) [usuario@bravo django_tutorial]$ ls&lt;br /&gt;README.md   django_tutorial  polls&lt;br /&gt;db.sqlite3  manage.py        requirements.txt&lt;br /&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Con el siguiente comando crearemos un usuario para la base de datos:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;(venv) [usuario@bravo django_tutorial]$ python3 manage.py createsuperuser&lt;br /&gt;Username (leave blank to use &#39;usuario&#39;): alejandro&lt;br /&gt;Email address: aaleemd11@gmail.com&lt;br /&gt;Password: &lt;br /&gt;Password (again): &lt;br /&gt;This password is too short. It must contain at least 8 characters.&lt;br /&gt;Bypass password validation and create user anyway? [y/N]: y&lt;br /&gt;Superuser created successfully.&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;probaremos el servidor en desarrollo, para ello utilizaremos el siguiente comando:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;(venv) [usuario@bravo django_tutorial]$ python3 manage.py runserver 0.0.0.0:8000&lt;br /&gt;Watching for file changes with StatReloader&lt;br /&gt;Performing system checks...&lt;br /&gt;&lt;br /&gt;System check identified no issues (0 silenced).&lt;br /&gt;January 19, 2023 - 10:05:34&lt;br /&gt;Django version 4.1.5, using settings &#39;django_tutorial.settings&#39;&lt;br /&gt;Starting development server at http://0.0.0.0:8000/&lt;br /&gt;Quit the server with CONTROL-C.&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Ahora en alfa, añadiremos una regla DNAT para que el tráfico del puerto 8000 vaya a bravo.&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;usuario@alfa:~$ sudo iptables -t nat -A PREROUTING -p tcp --dport 8000 -i ens3 -j DNAT --to 172.16.0.200&lt;br /&gt;usuario@alfa:~$ sudo iptables -L -t nat&lt;br /&gt;Chain PREROUTING (policy ACCEPT)&lt;br /&gt;target     prot opt source               destination         &lt;br /&gt;DNAT       tcp  --  anywhere             anywhere             tcp dpt:http to:172.16.0.200:80&lt;br /&gt;DNAT       udp  --  anywhere             anywhere             udp dpt:domain to:192.168.0.2:53&lt;br /&gt;DNAT       tcp  --  anywhere             anywhere             tcp dpt:smtp to:192.168.0.3&lt;br /&gt;DNAT       tcp  --  anywhere             anywhere             tcp dpt:8000 to:172.16.0.200&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Una vez hecho esto, podremos acceder desde nuestro navegador web a django en fase de desarrollo:&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://reeseschultz.github.io/img/IAW-T4.P1.1.png&quot; alt=&quot;IAW-T4.P1.1.png&quot; /&gt;&lt;/p&gt;
&lt;p&gt;Nos logeamos con el usuario y contraseña que creamos anteriormente y nos aparecerá el siguiente menú:&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://reeseschultz.github.io/img/IAW-T4.P1.2.png&quot; alt=&quot;IAW-T4.P1.2.png&quot; /&gt;&lt;/p&gt;
&lt;p&gt;En el apartado &lt;code&gt;Questions&lt;/code&gt; pulsamos &lt;code&gt;Add&lt;/code&gt; para añadir preguntas.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://reeseschultz.github.io/img/IAW-T4.P1.3.png&quot; alt=&quot;IAW-T4.P1.3.png&quot; /&gt;&lt;/p&gt;
&lt;p&gt;Rellenamos 2 preguntas con sus respuestas y pulsamos sobre &lt;code&gt;Questions&lt;/code&gt; el resultado será el siguiente:&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://reeseschultz.github.io/img/IAW-T4.P1.4.png&quot; alt=&quot;IAW-T4.P1.4.png&quot; /&gt;&lt;/p&gt;
&lt;p&gt;Ahora si nos metemos en /polls veremos las preguntas creadas:&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://reeseschultz.github.io/img/IAW-T4.P1.5.png&quot; alt=&quot;IAW-T4.P1.5.png&quot; /&gt;&lt;/p&gt;
&lt;p&gt;Una vez hecho esto, pondremos en producción django en bravo. Lo primero que haremos será mover django que está en el home a &lt;code&gt;/var/www&lt;/code&gt;&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;(venv) [usuario@bravo ~]$ sudo mv django_tutorial/ /var/www&lt;br /&gt;(venv) [usuario@bravo ~]$ sudo chown -R apache:apache /var/www/django_tutorial/&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Ahora editamos la configuración de django para indicar la nueva ruta estática:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;(venv) [usuario@bravo www]$ sudo nano django_tutorial/settings.py &lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Al final del archivo añadimos:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;STATIC_ROOT = &#39;/var/www/django_tutorial/static&#39;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Ahora ejecutamos:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;(django) [usuario@bravo django_tutorial]$ python3 manage.py collectstatic&lt;br /&gt;&lt;br /&gt;133 static files copied to &#39;/var/www/django_tutorial/static&#39;.&lt;br /&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Nos salimos del entorno virtual e instalaremos mod_wsgi:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;(django) [usuario@bravo django_tutorial]$ deactivate&lt;br /&gt;[usuario@bravo django_tutorial]$ sudo dnf install python3-mod_wsgi -y&lt;br /&gt;Failed to set locale, defaulting to C.UTF-8&lt;br /&gt;Last metadata expiration check: 2:14:47 ago on Sun Jan 22 12:59:59 2023.&lt;br /&gt;Dependencies resolved.&lt;br /&gt;==========================================================================&lt;br /&gt; Package               Arch        Version           Repository      Size&lt;br /&gt;==========================================================================&lt;br /&gt;Installing:&lt;br /&gt; python3-mod_wsgi      x86_64      4.7.1-11.el9      appstream      931 k&lt;br /&gt;&lt;br /&gt;Transaction Summary&lt;br /&gt;==========================================================================&lt;br /&gt;Install  1 Package&lt;br /&gt;&lt;br /&gt;Total download size: 931 k&lt;br /&gt;Installed size: 5.6 M&lt;br /&gt;Downloading Packages:&lt;br /&gt;python3-mod_wsgi-4.7.1-11.el9.x86_64.rpm  1.7 MB/s | 931 kB     00:00    &lt;br /&gt;--------------------------------------------------------------------------&lt;br /&gt;Total                                     857 kB/s | 931 kB     00:01     &lt;br /&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Ahora tendríamos que crear el fichero &lt;a href=&quot;http://wsgi.py/&quot;&gt;wsgi.py&lt;/a&gt; en django pero ya viene creado. Lo que haremos será crear el virtual host:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;[usuario@bravo django_tutorial]$ sudo nano /etc/httpd/sites-available/django.conf&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Añadimos lo siguiente:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;&amp;lt;VirtualHost *:80&gt;&lt;br /&gt;        ServerName python.alejandro-montes.gonzalonazareno.org&lt;br /&gt;        DocumentRoot /var/www/django_tutorial&lt;br /&gt;        Alias /static/ /var/www/django_tutorial/static/&lt;br /&gt;        WSGIDaemonProcess django_tutorial python-path=/var/www/django_tutorial:/var/www/django/lib/python3.9/site-packages/&lt;br /&gt;        WSGIProcessGroup django_tutorial&lt;br /&gt;        WSGIScriptAlias / /var/www/django_tutorial/django_tutorial/wsgi.py&lt;br /&gt;        ErrorLog /var/log/httpd/django_tutorial_error.log&lt;br /&gt;        CustomLog /var/log/httpd/django_tutorial_access.log combined&lt;br /&gt;&amp;lt;/VirtualHost&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Activamos el virtual host:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;[usuario@bravo django_tutorial]$ sudo ln -s /etc/httpd/sites-available/django.conf /etc/httpd/sites-enabled/django.conf&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Reiniciamos apache para que se apliquen los cambios:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;[usuario@bravo django_tutorial]$ sudo systemctl restart httpd&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Ahora en charlie añadimos un CNAME para todas las zonas llamado python.&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;ubuntu@charlie:~$ sudo nano /var/cache/bind/db.dmz.alejandro-montes.gonzalonazareno.org&lt;br /&gt;ubuntu@charlie:~$ sudo nano /var/cache/bind/db.interna.alejandro-montes.gonzalonazareno.org&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;añadimos al final lo siguiente:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;python                  IN      CNAME   bravo&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;ahora reiniciamos el servidor dns y borramos la cache:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;ubuntu@charlie:~$ sudo rndc flush&lt;br /&gt;ubuntu@charlie:~$ sudo systemctl restart bind9&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Una vez hecho esto, estaría funcionando el servidor dns y el virtualhost. Ahora probaremos a acceder a &lt;a href=&quot;http://python.alejandro-montes.gonzalonazareno.org/&quot;&gt;python.alejandro-montes.gonzalonazareno.org&lt;/a&gt; a través de internet:&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://reeseschultz.github.io/img/IAW-T4.P1.6.png&quot; alt=&quot;IAW-T4.P1.6.png&quot; /&gt;&lt;/p&gt;
&lt;p&gt;Por últimos subimos los cambios a git para realizar la migración al vps.&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;[usuario@bravo django_tutorial]$ git add .&lt;br /&gt;[usuario@bravo django_tutorial]$ git commit -m &quot;corregido&quot;&lt;br /&gt;[usuario@bravo django_tutorial]$ git push&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&quot;tarea-2%3A-entorno-de-producci%C3%B3n.&quot; tabindex=&quot;-1&quot;&gt;Tarea 2: Entorno de producción.&lt;/h3&gt;
&lt;p&gt;Lo primero que haremos será conectarnos al vps a traves de ssh e instalaremos git:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;alemd@nabil:~$ sudo apt install git&lt;br /&gt;Reading package lists... Done&lt;br /&gt;Building dependency tree... Done&lt;br /&gt;Reading state information... Done&lt;br /&gt;The following additional packages will be installed:&lt;br /&gt;  git-man libcurl3-gnutls liberror-perl patch&lt;br /&gt;Suggested packages:&lt;br /&gt;  git-daemon-run | git-daemon-sysvinit git-doc git-el git-email git-gui&lt;br /&gt;  gitk gitweb git-cvs git-mediawiki git-svn ed diffutils-doc&lt;br /&gt;The following NEW packages will be installed:&lt;br /&gt;  git git-man libcurl3-gnutls liberror-perl patch&lt;br /&gt;0 upgraded, 5 newly installed, 0 to remove and 3 not upgraded.&lt;br /&gt;Need to get 7855 kB of archives.&lt;br /&gt;After this operation, 38.9 MB of additional disk space will be used.&lt;br /&gt;Do you want to continue? [Y/n] y&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Clonaremos el repositorio con el siguiente comando:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;alemd@nabil:~$ git clone git@github.com:alemd01/django_tutorial.git&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Ahora instalamos si es necesario el módulo de python para crear entornos virtuales:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;alemd@nabil:~$ sudo apt install python3-venv&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Y creamos uno:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;alemd@nabil:~$ mkdir django&lt;br /&gt;alemd@nabil:~$ python3 -m venv django&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Activamos el entorno virtual:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;alemd@nabil:~$ source django/bin/activate&lt;br /&gt;(django) alemd@nabil:~$ &lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Instalaremos las dependencias de nuestra aplicación:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;(django) alemd@nabil:~/django_tutorial$ pip install -r requirements.txt &lt;br /&gt;Collecting Django&lt;br /&gt;  Downloading Django-4.1.5-py3-none-any.whl (8.1 MB)&lt;br /&gt;     |████████████████████████████████| 8.1 MB 4.9 MB/s &lt;br /&gt;Collecting asgiref&amp;lt;4,&gt;=3.5.2&lt;br /&gt;  Downloading asgiref-3.6.0-py3-none-any.whl (23 kB)&lt;br /&gt;Collecting sqlparse&gt;=0.2.2&lt;br /&gt;  Downloading sqlparse-0.4.3-py3-none-any.whl (42 kB)&lt;br /&gt;     |████████████████████████████████| 42 kB 1.5 MB/s &lt;br /&gt;Installing collected packages: sqlparse, asgiref, Django&lt;br /&gt;Successfully installed Django-4.1.5 asgiref-3.6.0 sqlparse-0.4.3&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;También instalaremos mysqlclient ya que la aplicación trabajará con una base de datos de mariadb:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;(django) alemd@nabil:~/django_tutorial$ sudo apt install python3-dev default-libmysqlclient-dev build-essential -y&lt;br /&gt;(django) alemd@nabil:~/django_tutorial$ pip install mysqlclient&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Ahora crearemos una base de datos en mysql, con un usuario y sus respectivos privilegios para la base de datos:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;root@nabil:/home/alemd/django_tutorial# mysql -u root&lt;br /&gt;&lt;br /&gt;MariaDB [(none)]&gt; CREATE DATABASE DJANGO;&lt;br /&gt;Query OK, 1 row affected (0.009 sec)&lt;br /&gt;&lt;br /&gt;MariaDB [(none)]&gt; CREATE USER &#39;alejandro&#39;@&#39;%&#39; IDENTIFIED BY &#39;usuario&#39;;&lt;br /&gt;Query OK, 0 rows affected (0.021 sec)&lt;br /&gt;&lt;br /&gt;MariaDB [(none)]&gt; GRANT ALL PRIVILEGES ON DJANGO.* TO &#39;alejandro&#39;@&#39;%&#39;;&lt;br /&gt;Query OK, 0 rows affected (0.007 sec)&lt;br /&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Ahora editaremos la aplicación para que utilice MySQL en vez de sqlite3:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;(django) alemd@nabil:~/django_tutorial$ nano django_tutorial/settings.py&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;editamos la zona de databases y tiene que quedar así:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;DATABASES = {&lt;br /&gt;    &#39;default&#39;: {&lt;br /&gt;        &#39;ENGINE&#39;: &#39;django.db.backends.mysql&#39;,&lt;br /&gt;        &#39;NAME&#39;: &#39;DJANGO&#39;,&lt;br /&gt;        &#39;USER&#39;: &#39;alejandro&#39;,&lt;br /&gt;        &#39;PASSWORD&#39;: &#39;usuario&#39;,&lt;br /&gt;        &#39;HOST&#39;: &#39;localhost&#39;,&lt;br /&gt;        &#39;PORT&#39;: &#39;&#39;,&lt;br /&gt;    }&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Ahora creamos una copia de seguridad de la base de datos del entorno de desarrollo(bravo) y la subimos a github y actualizamos el repositorio en el vps:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;(django) [usuario@bravo django_tutorial]$ python3 manage.py dumpdata &gt; db.json&lt;br /&gt;(django) [usuario@bravo django_tutorial]$ git add .&lt;br /&gt;(django) [usuario@bravo django_tutorial]$ git commit -m &quot;copia de seguridad&quot;&lt;br /&gt;(django) [usuario@bravo django_tutorial]$ git push&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Ahora hacemos un pull al vps para que sincronice con el repositorio:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;(django) alemd@nabil:~/django_tutorial$ git pull&lt;br /&gt;(django) alemd@nabil:~/django_tutorial$ ls&lt;br /&gt;README.md  django_tutorial  polls             static&lt;br /&gt;db.json    manage.py        requirements.txt&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Una vez tengamos la copia de seguridad en el vps, realizaremos la migración:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;(django) alemd@nabil:~/django_tutorial$ python3 manage.py migrate&lt;br /&gt;Operations to perform:&lt;br /&gt;  Apply all migrations: admin, auth, contenttypes, polls, sessions&lt;br /&gt;Running migrations:&lt;br /&gt;  Applying contenttypes.0001_initial... OK&lt;br /&gt;  Applying auth.0001_initial... OK&lt;br /&gt;  Applying admin.0001_initial... OK&lt;br /&gt;  Applying admin.0002_logentry_remove_auto_add... OK&lt;br /&gt;  Applying admin.0003_logentry_add_action_flag_choices... OK&lt;br /&gt;  Applying contenttypes.0002_remove_content_type_name... OK&lt;br /&gt;  Applying auth.0002_alter_permission_name_max_length... OK&lt;br /&gt;  Applying auth.0003_alter_user_email_max_length... OK&lt;br /&gt;  Applying auth.0004_alter_user_username_opts... OK&lt;br /&gt;  Applying auth.0005_alter_user_last_login_null... OK&lt;br /&gt;  Applying auth.0006_require_contenttypes_0002... OK&lt;br /&gt;  Applying auth.0007_alter_validators_add_error_messages... OK&lt;br /&gt;  Applying auth.0008_alter_user_username_max_length... OK&lt;br /&gt;  Applying auth.0009_alter_user_last_name_max_length... OK&lt;br /&gt;  Applying auth.0010_alter_group_name_max_length... OK&lt;br /&gt;  Applying auth.0011_update_proxy_permissions... OK&lt;br /&gt;  Applying auth.0012_alter_user_first_name_max_length... OK&lt;br /&gt;  Applying polls.0001_initial... OK&lt;br /&gt;  Applying sessions.0001_initial... OK&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Ahora cargamos los datos:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;(django) alemd@nabil:~/django_tutorial$ python3 manage.py loaddata db.json &lt;br /&gt;Installed 53 object(s) from 1 fixture(s)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Ahora instalaremos con pip un servidor de aplicaciones como uwsgi:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;alemd@nabil:~$ source django/bin/activate&lt;br /&gt;(django) alemd@nabil:~$ pip install uwsgi&lt;br /&gt;Collecting uwsgi&lt;br /&gt;  Downloading uwsgi-2.0.21.tar.gz (808 kB)&lt;br /&gt;     |████████████████████████████████| 808 kB 5.1 MB/s &lt;br /&gt;Using legacy &#39;setup.py install&#39; for uwsgi, since package &#39;wheel&#39; is not installed.&lt;br /&gt;Installing collected packages: uwsgi&lt;br /&gt;    Running setup.py install for uwsgi ... done&lt;br /&gt;Successfully installed uwsgi-2.0.21&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Y crearemos una unidad de systemd:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;(django) alemd@nabil:/var/www$ nano django/uwsgi.ini &lt;br /&gt;&lt;br /&gt;[uwsgi]&lt;br /&gt;http = :8080&lt;br /&gt;chdir = /var/www/django_tutorial&lt;br /&gt;wsgi-file = /var/www/django_tutorial/django_tutorial/wsgi.py&lt;br /&gt;processes = 4&lt;br /&gt;threads = 2&lt;br /&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;(django) alemd@nabil:/var/www$ sudo nano /etc/systemd/system/uwsgi-django.service &lt;br /&gt;&lt;br /&gt;[Unit]&lt;br /&gt;Description=uWSGI instance to serve django_tutorial&lt;br /&gt;After=network.target&lt;br /&gt;&lt;br /&gt;[Install]&lt;br /&gt;WantedBy=multi-user.target&lt;br /&gt;&lt;br /&gt;[Service]&lt;br /&gt;User=www-data&lt;br /&gt;Group=www-data&lt;br /&gt;Restart=always&lt;br /&gt;&lt;br /&gt;ExecStart=/var/www/django/bin/uwsgi --ini /var/www/django/uwsgi.ini&lt;br /&gt;ExecReload=/bin/kill -s HUP $MAINPID&lt;br /&gt;ExecStop=/bin/kill -s TERM $MAINPID&lt;br /&gt;&lt;br /&gt;WorkingDirectory=/var/www/django_tutorial&lt;br /&gt;Environment=PYTHONPATH=&#39;/var/www/django_tutorial/django_tutorial:/var/www&gt;&lt;br /&gt;&lt;br /&gt;PrivateTmp=true&lt;br /&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Una vez hecho esto recargaremos el demonio de systemctl para que se apliquen los cambios y habilitaremos la unidad:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;(django) alemd@nabil:/var/www/django$ sudo systemctl daemon-reload&lt;br /&gt;(django) alemd@nabil:/var/www/django$ sudo systemctl enable --now uwsgi-django.service&lt;br /&gt;Created symlink /etc/systemd/system/multi-user.target.wants/uwsgi-django.service → /etc/systemd/system/uwsgi-django.service.&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Ahora configuraremos el virtual host en el servidor nginx del vps:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;(django) alemd@nabil:/var/www/django$ sudo nano /etc/nginx/sites-available/django.conf&lt;br /&gt;&lt;br /&gt;server {&lt;br /&gt;        listen 80;&lt;br /&gt;        listen [::]:80;&lt;br /&gt;&lt;br /&gt;        root /var/www/django_tutorial;&lt;br /&gt;&lt;br /&gt;        index index.html index.php index.htm index.nginx-debian.html;&lt;br /&gt;&lt;br /&gt;        server_name python.alejandro-montes.es;&lt;br /&gt;&lt;br /&gt;        location / {&lt;br /&gt;                proxy_pass http://localhost:8080;&lt;br /&gt;                include proxy_params;&lt;br /&gt;        }&lt;br /&gt;&lt;br /&gt;        location /static {&lt;br /&gt;                alias /var/www/django_tutorial/static;&lt;br /&gt;        }&lt;br /&gt;}&lt;br /&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Crearemos el enlace simbólico para activar el virtual host:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;(django) alemd@nabil:/var/www/django$ sudo ln -s  /etc/nginx/sites-available/django.conf /etc/nginx/sites-enabled/&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Ahora crearemos una entrada en la configuración de nuestro dns para poder acceder a través de internet.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://reeseschultz.github.io/img/IAW-T4.P1.7.png&quot; alt=&quot;IAW-T4.P1.7.png&quot; /&gt;&lt;/p&gt;
&lt;p&gt;Como podemos ver en la casilla marcada, hemos indicado a nuestro proveedor de dns un cname a nabil que es la máquina del vps. Ahora muestro una captura de pantalla de django funcionando en el vps:&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://reeseschultz.github.io/img/IAW-T4.P1.8.png&quot; alt=&quot;IAW-T4.P1.8.png&quot; /&gt;&lt;/p&gt;
&lt;h3 id=&quot;tarea-3%3A-modificaci%C3%B3n-de-nuestra-aplicaci%C3%B3n.&quot; tabindex=&quot;-1&quot;&gt;Tarea 3: Modificación de nuestra aplicación.&lt;/h3&gt;
&lt;p&gt;Lo primero que realizaremos será entrar en el entorno de desarrollo (bravo) y modificaremos el apartado polls para que aparezca nuestro nombre:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;[usuario@bravo django_tutorial]$ nano polls/templates/polls/index.html
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Añadimos lo siguiente:&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://reeseschultz.github.io/img/IAW-T4.P1.13.png&quot; alt=&quot;IAW-T4.P1.13.png&quot; /&gt;&lt;/p&gt;
&lt;p&gt;Ahora cambiaremos el fondo de la aplicación para ello bajaremos una imagen y la pasaremos al servidor por scp. Una vez la imagen esté en el servidor, la moveremos a la siguiente ruta:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;[usuario@bravo ~]$ sudo mv background2.jpg /var/www/django_tutorial/static/polls/images/ 
&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Y ahora editamos el css para aplicar los cambios:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;[usuario@bravo ~]$ sudo nano /var/www/django_tutorial/static/polls/style.css &lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;El contenido del fichero ya editado es el siguiente:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;li a {&lt;br /&gt;    color: green;&lt;br /&gt;    background-color: blanchedalmond;&lt;br /&gt;}&lt;br /&gt;&lt;br /&gt;body {&lt;br /&gt;    background: white url(&quot;images/background2.jpg&quot;);&lt;br /&gt;}&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Muestro una captura de bravo con la pantalla editada:&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://reeseschultz.github.io/img/IAW-T4.P1.9.png&quot; alt=&quot;IAW-T4.P1.9.png&quot; /&gt;&lt;/p&gt;
&lt;p&gt;Una vez hecho esto, añadiremos una nueva tabla en la base de datos, para ello editaremos el archivo &lt;a href=&quot;http://models.py/&quot;&gt;models.py&lt;/a&gt; situado en el directorio polls dentro de nuestra aplicación django:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;[usuario@bravo django_tutorial]$ nano polls/models.py &lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Añadimos lo siguiente al final del fichero:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;class Categoria(models.Model):&lt;br /&gt;    Abr = models.CharField(max_length=4)&lt;br /&gt;    Nombre = models.CharField(max_length=50)&lt;br /&gt;&lt;br /&gt;    def __str__(self):&lt;br /&gt;        return self.Abr+&quot; - &quot;+self.Nombre&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Crearemos una nueva migración:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;(django) [usuario@bravo django_tutorial]$ python3 manage.py makemigrations&lt;br /&gt;Migrations for &#39;polls&#39;:&lt;br /&gt;  polls/migrations/0002_categoria.py&lt;br /&gt;    - Create model Categoria&lt;br /&gt;(django) [usuario@bravo django_tutorial]$ python3 manage.py migrate   &lt;br /&gt;Operations to perform:&lt;br /&gt;  Apply all migrations: admin, auth, contenttypes, polls, sessions&lt;br /&gt;Running migrations:&lt;br /&gt;  Applying polls.0002_categoria... OK&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Ahora añadimos el nuevo modelo al panel de administración:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;(django) [usuario@bravo django_tutorial]$ nano polls/admin.py &lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;La segunda línea del fichero la cambiamos por la siguiente:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;from .models import Choice, Question, Categoria&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Y al final agregamos:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;admin.site.register(Categoria)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Reiniciamos el servicio y muestro el panel de administración:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;(django) [usuario@bravo django_tutorial]$ sudo systemctl restart httpd&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&quot;https://reeseschultz.github.io/img/IAW-T4.P1.10.png&quot; alt=&quot;IAW-T4.P1.10.png&quot; /&gt;&lt;/p&gt;
&lt;p&gt;Como vemos, en los polls ahora aparece &lt;code&gt;Categorias&lt;/code&gt;. Ahora pasaremos los cambios a bravo, para ello actualizaremos nuestro repositorio de github con todos los cambios:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;(django) [usuario@bravo django_tutorial]$ git add .&lt;br /&gt;(django) [usuario@bravo django_tutorial]$ git commit -m &quot;modificacion&quot;&lt;br /&gt;[master 5122a1d] modificacion&lt;br /&gt; 7 files changed, 35 insertions(+), 4 deletions(-)&lt;br /&gt; rewrite db.json (100%)&lt;br /&gt; create mode 100644 polls/migrations/0002_categoria.py&lt;br /&gt; create mode 100644 static/polls/images/background2.jpg&lt;br /&gt;(django) [usuario@bravo django_tutorial]$ git push&lt;br /&gt;Enumerating objects: 27, done.&lt;br /&gt;Counting objects: 100% (27/27), done.&lt;br /&gt;Compressing objects: 100% (15/15), done.&lt;br /&gt;Writing objects: 100% (15/15), 43.47 KiB | 8.69 MiB/s, done.&lt;br /&gt;Total 15 (delta 6), reused 0 (delta 0), pack-reused 0&lt;br /&gt;remote: Resolving deltas: 100% (6/6), completed with 6 local objects.&lt;br /&gt;To github.com:alemd01/django_tutorial.git&lt;br /&gt;   48e377c..5122a1d  master -&gt; master&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Ahora en producción actualizamos los cambios:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;alemd@nabil:/var/www/django_tutorial$ git pull&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Ahora haremos un collectstatic para que cambie la parte estática de la aplicación:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;(django) alemd@nabil:/var/www/django_tutorial$ python3 manage.py collectstatic&lt;br /&gt;&lt;br /&gt;You have requested to collect static files at the destination&lt;br /&gt;location as specified in your settings:&lt;br /&gt;&lt;br /&gt;    /var/www/django_tutorial/static&lt;br /&gt;&lt;br /&gt;This will overwrite existing files!&lt;br /&gt;Are you sure you want to do this?&lt;br /&gt;&lt;br /&gt;Type &#39;yes&#39; to continue, or &#39;no&#39; to cancel: yes&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Por último muestro los cambios en producción:&lt;/p&gt;
&lt;p&gt;Primero muestro que polls tiene el background cambiado y muestra mi nombre:&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://reeseschultz.github.io/img/IAW-T4.P1.11.png&quot; alt=&quot;IAW-T4.P1.11.png&quot; /&gt;&lt;/p&gt;
&lt;p&gt;Ahora muestro que en la zona de administración se ha creado el nuevo polls:&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://reeseschultz.github.io/img/IAW-T4.P1.12.png&quot; alt=&quot;IAW-T4.P1.12.png&quot; /&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;h2 id=&quot;documento-realizado-por%3A&quot; tabindex=&quot;-1&quot;&gt;&lt;strong&gt;Documento realizado por:&lt;/strong&gt;&lt;/h2&gt;
&lt;p&gt;✒️ &lt;strong&gt;Alejandro Montes Delgado&lt;/strong&gt; - &lt;em&gt;2º ASIR&lt;/em&gt;&lt;/p&gt;
</content>
	</entry>
	
	<entry>
		<title></title>
		<link href="https://reeseschultz.github.io/posts/comprobaciones/"/>
		<updated>2022-12-30T18:59:38Z</updated>
		<id>https://reeseschultz.github.io/posts/comprobaciones/</id>
		<content type="html">&lt;h2 id=&quot;funcionamiento-de-los-ejercicios&quot; tabindex=&quot;-1&quot;&gt;Funcionamiento de los ejercicios&lt;/h2&gt;
&lt;h3 id=&quot;3.-a%C3%B1ade-dos-columnas-llamadas-distancia-y-duraci%C3%B3n-(en-formato-hh%3Ami)-a-la-tabla-vuelos-y-rell%C3%A9nalas-adecuadamente.-realiza-un-trigger-que-garantice-que-un-avi%C3%B3n-asignado-a-un-viaje-tenga-una-autonom%C3%ADa-superior-al-menos-en-un-25%25-a-la-distancia-a-recorrer.&quot; tabindex=&quot;-1&quot;&gt;3. Añade dos columnas llamadas Distancia y Duración (en formato hh:mi) a la tabla Vuelos y rellénalas adecuadamente. Realiza un trigger que garantice que un avión asignado a un viaje tenga una autonomía superior al menos en un 25% a la distancia a recorrer.&lt;/h3&gt;
&lt;p&gt;&lt;strong&gt;Pruebas con el update:&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Update que la autonomía del avión es superior en un 25% superior a la distancia:&lt;/li&gt;
&lt;/ul&gt;
&lt;pre class=&quot;language-sql&quot;&gt;&lt;code class=&quot;language-sql&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;UPDATE&lt;/span&gt; VUELOS &lt;span class=&quot;token keyword&quot;&gt;SET&lt;/span&gt; DISTANCIA&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;800&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;WHERE&lt;/span&gt; CODVUELO&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;IB-5940&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&quot;https://reeseschultz.github.io/img/BD-AMD.1.png&quot; alt=&quot;BD-AMD.1.png&quot; /&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Update que la autonomía del avión es menor del 25% de la distancia a recorrer.&lt;/li&gt;
&lt;/ul&gt;
&lt;pre class=&quot;language-sql&quot;&gt;&lt;code class=&quot;language-sql&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;UPDATE&lt;/span&gt; VUELOS &lt;span class=&quot;token keyword&quot;&gt;SET&lt;/span&gt; DISTANCIA&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;5000&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;WHERE&lt;/span&gt; CODVUELO&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;IB-5940&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&quot;https://reeseschultz.github.io/img/BD-AMD.2.png&quot; alt=&quot;BD-AMD.2.png&quot; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Pruebas con el insert:&lt;/strong&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Insert que la autonomía del avión es superior en un 25% superior a la distancia:&lt;/li&gt;
&lt;/ul&gt;
&lt;pre class=&quot;language-sql&quot;&gt;&lt;code class=&quot;language-sql&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;INSERT&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;INTO&lt;/span&gt; VUELOS &lt;span class=&quot;token keyword&quot;&gt;VALUES&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token string&quot;&gt;&#39;UX-6013&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token string&quot;&gt;&#39;PMI&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token string&quot;&gt;&#39;MAD&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token string&quot;&gt;&#39;Air Europa&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token string&quot;&gt;&#39;Jueves&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;    TO_DATE&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;10:15&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;HH24:MI&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token string&quot;&gt;&#39;EJK000333&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token string&quot;&gt;&#39;HYJ000568&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token number&quot;&gt;782&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;    TO_DATE&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;01:30&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;HH24:MI&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&quot;https://reeseschultz.github.io/img/BD-AMD.4.png&quot; alt=&quot;BD-AMD.4.png&quot; /&gt;&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Insert que la autonomía del avión es menor del 25% de la distancia a recorrer.&lt;/li&gt;
&lt;/ul&gt;
&lt;pre class=&quot;language-sql&quot;&gt;&lt;code class=&quot;language-sql&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;INSERT&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;INTO&lt;/span&gt; VUELOS &lt;span class=&quot;token keyword&quot;&gt;VALUES&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token string&quot;&gt;&#39;UX-6013&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token string&quot;&gt;&#39;PMI&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token string&quot;&gt;&#39;MAD&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token string&quot;&gt;&#39;Air Europa&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token string&quot;&gt;&#39;Jueves&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;    TO_DATE&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;10:15&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;HH24:MI&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token string&quot;&gt;&#39;EJK000333&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token string&quot;&gt;&#39;HYJ000568&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token number&quot;&gt;7820&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;    TO_DATE&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;01:30&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;HH24:MI&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&quot;https://reeseschultz.github.io/img/BD-AMD.3.png&quot; alt=&quot;BD-AMD.3.png&quot; /&gt;&lt;/p&gt;
&lt;h3 id=&quot;7.-realiza-los-m%C3%B3dulos-de-programaci%C3%B3n-necesarios-para-garantizar-que-una-misma-compa%C3%B1%C3%ADa-no-tiene-m%C3%A1s-de-dos-vuelos-con-el-mismo-origen-y-destino-en-un-mismo-d%C3%ADa-de-la-semana.&quot; tabindex=&quot;-1&quot;&gt;7. Realiza los módulos de programación necesarios para garantizar que una misma compañía no tiene más de dos vuelos con el mismo origen y destino en un mismo día de la semana.&lt;/h3&gt;
&lt;p&gt;Inserto un vuelo con el mismo origen y destino y en el mismo día de la semana.&lt;/p&gt;
&lt;pre class=&quot;language-sql&quot;&gt;&lt;code class=&quot;language-sql&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;INSERT&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;INTO&lt;/span&gt; VUELOS &lt;span class=&quot;token keyword&quot;&gt;VALUES&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token string&quot;&gt;&#39;CD-6015&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token string&quot;&gt;&#39;PMI&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token string&quot;&gt;&#39;MAD&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token string&quot;&gt;&#39;Air Europa&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token string&quot;&gt;&#39;Jueves&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;    TO_DATE&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;14:15&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;HH24:MI&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token string&quot;&gt;&#39;CVF000126&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token string&quot;&gt;&#39;FHY000456&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token number&quot;&gt;782&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;    TO_DATE&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;01:30&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;HH24:MI&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&quot;https://reeseschultz.github.io/img/BD-AMD.5.png&quot; alt=&quot;BD-AMD.5.png&quot; /&gt;&lt;/p&gt;
&lt;p&gt;Si insertamos otro vuelo con el mismo origen y destino y en el mismo día de la semana, se dispara el trigger.&lt;/p&gt;
&lt;pre class=&quot;language-sql&quot;&gt;&lt;code class=&quot;language-sql&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;INSERT&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;INTO&lt;/span&gt; VUELOS &lt;span class=&quot;token keyword&quot;&gt;VALUES&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token string&quot;&gt;&#39;CD-6017&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token string&quot;&gt;&#39;PMI&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token string&quot;&gt;&#39;MAD&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token string&quot;&gt;&#39;Air Europa&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token string&quot;&gt;&#39;Jueves&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;    TO_DATE&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;14:15&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;HH24:MI&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token string&quot;&gt;&#39;CVF000126&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token string&quot;&gt;&#39;FHY000456&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token number&quot;&gt;782&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;    TO_DATE&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;01:30&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;HH24:MI&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&quot;https://reeseschultz.github.io/img/BD-AMD.6.png&quot; alt=&quot;BD-AMD.6.png&quot; /&gt;&lt;/p&gt;
&lt;p&gt;El trigger no funciona bien, ya que al eliminar un vuelo no lo detecta y si se vuelve a insertar salta el trigger cuando no debería de hacerlo.&lt;/p&gt;
&lt;h3 id=&quot;8.-realiza-los-m%C3%B3dulos-de-programaci%C3%B3n-necesarios-para-garantizar-que-el-n%C3%BAmero-de-auxiliares-de-vuelo-en-un-viaje-es-de-al-menos-uno-por-cada-5-pasajeros-que-realizan-ese-viaje.&quot; tabindex=&quot;-1&quot;&gt;8. Realiza los módulos de programación necesarios para garantizar que el número de auxiliares de vuelo en un viaje es de al menos uno por cada 5 pasajeros que realizan ese viaje.&lt;/h3&gt;
&lt;p&gt;Vamos a ingresar pasajeros hasta que salte la excepción. No dejo los inserts aquí ya que el código sería muy largo, todos los inserts se encuentran en el archivo del ejercicio 8. Dejo aquí el resultado de hacer todos los inserts.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://reeseschultz.github.io/posts/comprobaciones/img/BD-AMD.7.png&quot; alt=&quot;BD-AMD.7.png&quot; /&gt;&lt;/p&gt;
&lt;p&gt;He tenido problemas con la tabla temporal, para que se rellene tenemos que actualizar la tabla auxiliares de viaje para que se rellene&lt;/p&gt;
&lt;h3 id=&quot;3.-(pl%2Fpgsql)-a%C3%B1ade-dos-columnas-llamadas-distancia-y-duraci%C3%B3n-(en-formato-hh%3Ami)-a-la-tabla-vuelos-y-rell%C3%A9nalas-adecuadamente.-realiza-un-trigger-que-garantice-que-un-avi%C3%B3n-asignado-a-un-viaje-tenga-una-autonom%C3%ADa-superior-al-menos-en-un-25%25-a-la-distancia-a-recorrer.&quot; tabindex=&quot;-1&quot;&gt;3. (pl/pgsql) Añade dos columnas llamadas Distancia y Duración (en formato hh:mi) a la tabla Vuelos y rellénalas adecuadamente. Realiza un trigger que garantice que un avión asignado a un viaje tenga una autonomía superior al menos en un 25% a la distancia a recorrer.&lt;/h3&gt;
&lt;p&gt;El primer insert funciona correctamente, en el segundo salta el error.&lt;/p&gt;
&lt;pre class=&quot;language-sql&quot;&gt;&lt;code class=&quot;language-sql&quot;&gt; &lt;span class=&quot;token keyword&quot;&gt;INSERT&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;INTO&lt;/span&gt; VUELOS &lt;span class=&quot;token keyword&quot;&gt;VALUES&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;br /&gt;     &lt;span class=&quot;token string&quot;&gt;&#39;UX-6013&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;     &lt;span class=&quot;token string&quot;&gt;&#39;PMI&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;     &lt;span class=&quot;token string&quot;&gt;&#39;MAD&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;     &lt;span class=&quot;token string&quot;&gt;&#39;Air Europa&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;     &lt;span class=&quot;token string&quot;&gt;&#39;Jueves&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;     TO_TIMESTAMP&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;10:15&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;HH24:MI&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;     &lt;span class=&quot;token string&quot;&gt;&#39;EJK000333&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;     &lt;span class=&quot;token string&quot;&gt;&#39;HYJ000568&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;     TO_TIMESTAMP&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;01:30&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;HH24:MI&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;      &lt;span class=&quot;token number&quot;&gt;782&lt;/span&gt;&lt;br /&gt; &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Este es el insert el cual hace que se dispare el trigger.&lt;/p&gt;
&lt;pre class=&quot;language-sql&quot;&gt;&lt;code class=&quot;language-sql&quot;&gt; &lt;span class=&quot;token keyword&quot;&gt;INSERT&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;INTO&lt;/span&gt; VUELOS &lt;span class=&quot;token keyword&quot;&gt;VALUES&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;br /&gt;     &lt;span class=&quot;token string&quot;&gt;&#39;UX-6013&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;     &lt;span class=&quot;token string&quot;&gt;&#39;PMI&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;     &lt;span class=&quot;token string&quot;&gt;&#39;MAD&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;     &lt;span class=&quot;token string&quot;&gt;&#39;Air Europa&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;     &lt;span class=&quot;token string&quot;&gt;&#39;Jueves&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;     TO_TIMESTAMP&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;10:15&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;HH24:MI&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;     &lt;span class=&quot;token string&quot;&gt;&#39;EJK000333&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;     &lt;span class=&quot;token string&quot;&gt;&#39;HYJ000568&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;     TO_TIMESTAMP&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;01:30&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;HH24:MI&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;br /&gt;      &lt;span class=&quot;token number&quot;&gt;7820&lt;/span&gt;&lt;br /&gt; &lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&quot;https://reeseschultz.github.io/posts/comprobaciones/img/BD-AMD.8.png&quot; alt=&quot;BD-AMD.8.png&quot; /&gt;&lt;/p&gt;
</content>
	</entry>
	
	<entry>
		<title>Montaje Servidor y cliente NFS mediante Systemd.</title>
		<link href="https://reeseschultz.github.io/post/montaje-servidor-y-cliente-nfs-mediante-systemd./"/>
		<updated>2022-12-15T00:00:00Z</updated>
		<id>https://reeseschultz.github.io/post/montaje-servidor-y-cliente-nfs-mediante-systemd./</id>
		<content type="html">&lt;h3 id=&quot;creaci%C3%B3n-del-volumen-y-particionado.&quot; tabindex=&quot;-1&quot;&gt;Creación del volumen y particionado.&lt;/h3&gt;
&lt;p&gt;Lo primero que he hecho ha sido añadir un volumen de 2Gb a la máquina &lt;code&gt;Alfa&lt;/code&gt; de mi escenario en OpenStack. Una vex añadido el volumen, crearemos una partición y le daremos formato ext4.&lt;/p&gt;
&lt;p&gt;Para crear la partición he usado el siguiente comando:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;root@alfa:/media/Archivos# fdisk /dev/vdb&lt;br /&gt;&lt;br /&gt;Welcome to fdisk (util-linux 2.36.1).&lt;br /&gt;Changes will remain in memory only, until you decide to write them.&lt;br /&gt;Be careful before using the write command.&lt;br /&gt;&lt;br /&gt;Device does not contain a recognized partition table.&lt;br /&gt;Created a new DOS disklabel with disk identifier 0x04ba1fd8.&lt;br /&gt;&lt;br /&gt;Command (m for help): n&lt;br /&gt;Partition type&lt;br /&gt;   p   primary (0 primary, 0 extended, 4 free)&lt;br /&gt;   e   extended (container for logical partitions)&lt;br /&gt;Select (default p): p&lt;br /&gt;Partition number (1-4, default 1): &lt;br /&gt;First sector (2048-4194303, default 2048): &lt;br /&gt;Last sector, +/-sectors or +/-size{K,M,G,T,P} (2048-4194303, default 4194303): &lt;br /&gt;&lt;br /&gt;Created a new partition 1 of type &#39;Linux&#39; and of size 2 GiB.&lt;br /&gt;&lt;br /&gt;Command (m for help): w&lt;br /&gt;The partition table has been altered.&lt;br /&gt;Calling ioctl() to re-read partition table.&lt;br /&gt;Syncing disks.&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Una vez creada la partición con el siguiente comando, le asignaremos el formato ext4.&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;root@alfa:/media/Archivos# mkfs.ext4 /dev/vdb1&lt;br /&gt;mke2fs 1.46.2 (28-Feb-2021)&lt;br /&gt;Discarding device blocks: done                            &lt;br /&gt;Creating filesystem with 524032 4k blocks and 131072 inodes&lt;br /&gt;Filesystem UUID: faa25fa0-cffb-4494-b586-bdbe74f845aa&lt;br /&gt;Superblock backups stored on blocks: &lt;br /&gt;	32768, 98304, 163840, 229376, 294912&lt;br /&gt;&lt;br /&gt;Allocating group tables: done                            &lt;br /&gt;Writing inode tables: done                            &lt;br /&gt;Creating journal (8192 blocks): done&lt;br /&gt;Writing superblocks and filesystem accounting information: done &lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&quot;creaci%C3%B3n-de-la-unidad-en-systemd.&quot; tabindex=&quot;-1&quot;&gt;Creación de la unidad en systemd.&lt;/h3&gt;
&lt;p&gt;Primero de todo crearemos el directorio donde se montará el volumen en mi caso es el siguiente:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;root@alfa:/media/Archivos# mkdir /media/Archivos&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Ahora crearemos la unidad de systemd para montar el volumen en el servidor Alfa.&lt;/p&gt;
&lt;p&gt;Creamos el siguiente fichero:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;root@alfa:/media/Archivos# nano /etc/systemd/system/media-Archivos.mount&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;El fichero tiene dicho ya que debe de llamarse igual que la ruta donde se monta el volumen cambiando las barras &lt;code&gt;/&lt;/code&gt; por guiones &lt;code&gt;-&lt;/code&gt; y es &lt;code&gt;.mount&lt;/code&gt; porque es una unidad de montaje. Añadiremos lo siguiente:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;[Unit]&lt;br /&gt;Description=Disco montado para practica ASO&lt;br /&gt;[Mount]&lt;br /&gt;What=/dev/vdb1&lt;br /&gt;Where=/media/Archivos&lt;br /&gt;Type=ext4&lt;br /&gt;Options=defaults&lt;br /&gt;[Install]&lt;br /&gt;WantedBy=multi-user.target&lt;/code&gt;&lt;/pre&gt;
&lt;ul&gt;
&lt;li&gt;Description como su nombre indica es una descripción del volumen montado.&lt;/li&gt;
&lt;li&gt;En What debemos indicar la ruta del volumen que queremos montar.&lt;/li&gt;
&lt;li&gt;En Where es donde lo hemos montado, es decir, la ruta donde se monta el volumen.&lt;/li&gt;
&lt;li&gt;La opción Type es el formato que tendra el volumen.&lt;/li&gt;
&lt;li&gt;En Options indicamos las opciones por defecto.&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Una vez hecho esto, la unidad estaría creada. Ahora procederemos a activarlo.&lt;/p&gt;
&lt;h3 id=&quot;activaci%C3%B3n-de-la-unidad-de-montaje.&quot; tabindex=&quot;-1&quot;&gt;Activación de la unidad de montaje.&lt;/h3&gt;
&lt;p&gt;Para activar la unidad de montaje, tenemos que recargar el daemon de systemd antes para que detecto los nuevos cambios y la nueva unidad. Para ello usamos el siguiente comando:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;root@alfa:/media/Archivos# systemctl daemon-reload&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Ahora ejecutamos el siguiente comando para iniciar la unidad creada:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;root@alfa:/media/Archivos# systemctl start media-Archivos.mount&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Para habilitar que la unidad se inicie automáticamente al inicio del sistema usamos el siguiente comando:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;root@alfa:/media/Archivos# systemctl enable media-Archivos.mount&lt;br /&gt;Created symlink /etc/systemd/system/multi-user.target.wants/media-Archivos.mount → /etc/systemd/system/media-Archivos.mount.&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&quot;configuraci%C3%B3n-servidor-nfs.&quot; tabindex=&quot;-1&quot;&gt;Configuración servidor NFS.&lt;/h3&gt;
&lt;p&gt;Lo primero que tenemos que hacer es instalar los paquetes necesarios. Son los siguientes paquetes:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;nfs-kernel-server&lt;/li&gt;
&lt;li&gt;nfs-common&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Una vez instalados los paquetes, editaremos el fichero exports.&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;root@alfa:/media/Archivos# nano /etc/exports&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Añadiremos lo siguiente:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;/media/Archivos *(rw,no_root_squash)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Activamos el servicio:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;root@alfa:/media/Archivos# service nfs-kernel-server start&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Ahora comprobamos los directorios exportados:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;root@alfa:/media/Archivos# showmount --exports localhost&lt;br /&gt;Export list for localhost:&lt;br /&gt;/media/Archivos *&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&quot;configuraci%C3%B3n-cliente-nfs.&quot; tabindex=&quot;-1&quot;&gt;Configuración cliente NFS.&lt;/h3&gt;
&lt;p&gt;El cliente que configuraré será bravo. Lo primero que haremos será instalar el cliente nfs-utils:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;[usuario@bravo system]$ sudo dnf install nfs-utils&lt;br /&gt;Failed to set locale, defaulting to C.UTF-8&lt;br /&gt;Last metadata expiration check: 1:58:56 ago on Tue Dec 27 15:52:39 2022.&lt;br /&gt;Package nfs-utils-1:2.5.4-15.el9.x86_64 is already installed.&lt;br /&gt;Dependencies resolved.&lt;br /&gt;Nothing to do.&lt;br /&gt;Complete!&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Ahora crearemos una unidad de montaje del volumen nfs:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;[usuario@bravo system]$ sudo nano /etc/systemd/system/home-usuario-archivos.mount&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Añadimos lo siguiente:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;[Unit]&lt;br /&gt;Description= cliente NFS&lt;br /&gt;[Mount]&lt;br /&gt;What=172.16.0.1:/media/Archivos&lt;br /&gt;Where=/home/usuario/archivos&lt;br /&gt;Type=nfs&lt;br /&gt;Options=defaults&lt;br /&gt;[Install]&lt;br /&gt;WantedBy=multi-user.target&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Reiniciamos el demonio de systemctl:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;[usuario@bravo system]$ sudo systemctl daemon-reload&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Arrancamos la unidad que hemos creado:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;[usuario@bravo system]$ sudo systemctl start home-usuario-archivos.mount &lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Como podemos ver se ha montado correctamente:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;[usuario@bravo system]$ df -h&lt;br /&gt;Filesystem                  Size  Used Avail Use% Mounted on&lt;br /&gt;devtmpfs                    4.0M     0  4.0M   0% /dev&lt;br /&gt;tmpfs                       383M     0  383M   0% /dev/shm&lt;br /&gt;tmpfs                       153M   14M  140M   9% /run&lt;br /&gt;/dev/vda5                    29G  1.3G   28G   5% /&lt;br /&gt;/dev/vda2                   994M  267M  728M  27% /boot&lt;br /&gt;/dev/vda1                   100M  7.0M   93M   7% /boot/efi&lt;br /&gt;tmpfs                        77M     0   77M   0% /run/user/1000&lt;br /&gt;172.16.0.1:/media/Archivos  2.0G     0  1.9G   0% /home/usuario/archivos&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Ahora hacemos una prueba para ver que está montado correctamente. Desde el servidor crearemos una carpeta en el volumen:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;usuario@alfa:/media/Archivos$ sudo mkdir prueba&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Ahora en el cliente listaremos los archivos para ver que se ha creado el directorio.&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;[usuario@bravo ~]$ cd archivos/&lt;br /&gt;[usuario@bravo archivos]$ ls&lt;br /&gt;lost+found  prueba&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Hacemos la prueba del revés para ver que se pueden crear carpetas y ficheros desde el cliente:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;[usuario@bravo archivos]$ sudo mkdir prueba2&lt;br /&gt;[usuario@bravo archivos]$ ls&lt;br /&gt;lost+found  prueba  prueba2&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Ahora listamos desde el servidor para ver que se ha creado correctamente:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;usuario@alfa:/media/Archivos$ ls&lt;br /&gt;lost+found  prueba  prueba2&lt;/code&gt;&lt;/pre&gt;
&lt;hr /&gt;
&lt;h2 id=&quot;documento-realizado-por%3A&quot; tabindex=&quot;-1&quot;&gt;&lt;strong&gt;Documento realizado por:&lt;/strong&gt;&lt;/h2&gt;
&lt;p&gt;✒️ &lt;strong&gt;Alejandro Montes Delgado&lt;/strong&gt; - &lt;em&gt;2º ASIR&lt;/em&gt;&lt;/p&gt;
</content>
	</entry>
	
	<entry>
		<title>Criptografía II: Integridad, firmas y autenticación</title>
		<link href="https://reeseschultz.github.io/post/criptografia-ii:-integridad-firmas-y-autenticacion/"/>
		<updated>2022-12-08T00:00:00Z</updated>
		<id>https://reeseschultz.github.io/post/criptografia-ii:-integridad-firmas-y-autenticacion/</id>
		<content type="html">&lt;h3 id=&quot;tarea-1%3A-firmas-electr%C3%B3nicas&quot; tabindex=&quot;-1&quot;&gt;Tarea 1: Firmas electrónicas&lt;/h3&gt;
&lt;h4 id=&quot;1.-manda-un-documento-y-la-firma-electr%C3%B3nica-del-mismo-a-un-compa%C3%B1ero.-verifica-la-firma-que-tu-has-recibido.&quot; tabindex=&quot;-1&quot;&gt;1. Manda un documento y la firma electrónica del mismo a un compañero. Verifica la firma que tu has recibido.&lt;/h4&gt;
&lt;p&gt;Para generar la firma de un documento, usamos el siguiente comando:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;gpg --detach-sign prueba.txt&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Le enviamos al compañero el documento con la firma y saldrá el error del siguiente apratado.&lt;/p&gt;
&lt;h4 id=&quot;2.-%C2%BFqu%C3%A9-significa-el-mensaje-que-aparece-en-el-momento-de-verificar-la-firma%3F&quot; tabindex=&quot;-1&quot;&gt;2. ¿Qué significa el mensaje que aparece en el momento de verificar la firma?&lt;/h4&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt; gpg: Firma correcta de &quot;Pepe D &amp;lt;josedom24@gmail.com&gt;&quot; [desconocido]&lt;br /&gt; gpg: ATENCIÓN: ¡Esta clave no está certificada por una firma de confianza!&lt;br /&gt; gpg:          No hay indicios de que la firma pertenezca al propietario.&lt;br /&gt; Huellas dactilares de la clave primaria: E8DD 5DA9 3B88 F08A DA1D  26BF 5141 3DDB 0C99 55FC&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Este mensaje sale porque no tenemos un anillo de confianza. El error, nos hace referencia a que nuestra clave no está en ningun anillo de confianza.&lt;/p&gt;
&lt;h4 id=&quot;3.-vamos-a-crear-un-anillo-de-confianza-entre-los-miembros-de-nuestra-clase%2C-para-ello.&quot; tabindex=&quot;-1&quot;&gt;3. Vamos a crear un anillo de confianza entre los miembros de nuestra clase, para ello.&lt;/h4&gt;
&lt;p&gt;&lt;strong&gt;Tu clave pública debe estar en un servidor de claves.&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Tengo la clave subida al servidor de ubuntu.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Escribe tu fingerprint en un papel y dárselo a tu compañero, para que puede descargarse tu clave pública.&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Mi fingerprint es:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;A24B1921B28D5F7BA7320497E29C0E02DE5CF68C&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;strong&gt;Te debes bajar al menos tres claves públicas de compañeros. Firma estas claves.&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Clave de Alfonso.&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;gpg --keyserver keyserver.ubuntu.com --recv-keys DA5E8263079216E8&lt;br /&gt;gpg --sign-key DA5E8263079216E8&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Clave de Paco.&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;gpg --keyserver gpg.mit.edu --recv-keys D5DF96E1BBD7DB81&lt;br /&gt;gpg --sign-key 7C499EE49A10C836480FCC9CD5DF96E1BBD7DB81&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Clave de Óscar.&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;gpg --keyserver keyserver.ubuntu.com --recv-keys A8544395EB1796857BC8C1309E4B2C4247B5AA59&lt;br /&gt;gpg --sign-key A8544395EB1796857BC8C1309E4B2C4247B5AA59&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;strong&gt;Tu te debes asegurar que tu clave pública es firmada por al menos tres compañeros de la clase.&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Mi clave pública ha sido firmada por Alfonso, Paco y Óscar.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Una vez que firmes una clave se la tendrás que devolver a su dueño, para que otra persona se la firme.&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Exporto la clave de Alfonso y se la envío.&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;gpg --export -a DA5E8263079216E8 &gt; clave_alfonso.asc&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Exporto la clave de Paco y se la envío&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;gpg --export -a 7C499EE49A10C836480FCC9CD5DF96E1BBD7DB81 &gt; paco.key&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Exporto la clave de Óscar y se la envío&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;gpg --export -a A8544395EB1796857BC8C1309E4B2C4247B5AA59 &gt; oscar.key&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;strong&gt;Cuando tengas las tres firmas sube la clave al servidor de claves y rellena tus datos en la tabla Claves públicas PGP 2020-2021&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Subido.&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;Asegurate que te vuelves a bajar las claves públicas de tus compañeros que tengan las tres firmas.&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;Me he tenido que bajar manualmente las claves, ya que desde la terminal no se actualizaba.&lt;/p&gt;
&lt;h4 id=&quot;4.-muestra-las-firmas-que-tiene-tu-clave-p%C3%BAblica.&quot; tabindex=&quot;-1&quot;&gt;4. Muestra las firmas que tiene tu clave pública.&lt;/h4&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;gpg --list-sig&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&quot;https://reeseschultz.github.io/img/SAD-P4.1.png&quot; alt=&quot;SAD-P4.1.png&quot; /&gt;&lt;/p&gt;
&lt;h4 id=&quot;5.-comprueba-que-ya-puedes-verificar-sin-%E2%80%9Cproblemas%E2%80%9D-una-firma-recibida-por-una-persona-en-la-que-conf%C3%ADas.&quot; tabindex=&quot;-1&quot;&gt;5. Comprueba que ya puedes verificar sin “problemas” una firma recibida por una persona en la que confías.&lt;/h4&gt;
&lt;p&gt;Alfonso me ha enviado un documento con su firma. Muestro que se ha verificado correctamente.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://reeseschultz.github.io/img/SAD-P4.2.png&quot; alt=&quot;SAD-P4.2.png&quot; /&gt;&lt;/p&gt;
&lt;h4 id=&quot;6.-comprueba-que-puedes-verificar-con-confianza-una-firma-de-una-persona-en-las-que-no-conf%C3%ADas%2C-pero-sin-embargo-si-conf%C3%ADa-otra-persona-en-la-que-tu-tienes-confianza-total.&quot; tabindex=&quot;-1&quot;&gt;6. Comprueba que puedes verificar con confianza una firma de una persona en las que no confías, pero sin embargo si confía otra persona en la que tu tienes confianza total.&lt;/h4&gt;
&lt;hr /&gt;
&lt;h3 id=&quot;tarea-2%3A-correo-seguro-con-evolution%2Fthunderbird&quot; tabindex=&quot;-1&quot;&gt;Tarea 2: Correo seguro con evolution/thunderbird&lt;/h3&gt;
&lt;h4 id=&quot;1.-configura-el-cliente-de-correo-evolution-con-tu-cuenta-de-correo-habitual&quot; tabindex=&quot;-1&quot;&gt;1. Configura el cliente de correo evolution con tu cuenta de correo habitual&lt;/h4&gt;
&lt;p&gt;He iniciado sesión con la cuenta que uso normalmente.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://reeseschultz.github.io/img/SAD-P4.3.png&quot; alt=&quot;SAD-P4.3.png&quot; /&gt;&lt;/p&gt;
&lt;h4 id=&quot;2.-a%C3%B1ade-a-la-cuenta-las-opciones-de-seguridad-para-poder-enviar-correos-firmados-con-tu-clave-privada-o-cifrar-los-mensajes-para-otros-destinatarios&quot; tabindex=&quot;-1&quot;&gt;2. Añade a la cuenta las opciones de seguridad para poder enviar correos firmados con tu clave privada o cifrar los mensajes para otros destinatarios&lt;/h4&gt;
&lt;p&gt;Tenemos que irnos a ajustes y configuración de la cuenta, y le damos a cifrado extremo a extremo. Allí importaremos nuestra clave privada y activaremos el cifrado para nuevos mensajes.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://reeseschultz.github.io/img/SAD-P4.5.png&quot; alt=&quot;SAD-P4.5.png&quot; /&gt;&lt;/p&gt;
&lt;h4 id=&quot;3.-env%C3%ADa-y-recibe-varios-mensajes-con-tus-compa%C3%B1eros-y-comprueba-el-funcionamiento-adecuado-de-gpg.&quot; tabindex=&quot;-1&quot;&gt;3. Envía y recibe varios mensajes con tus compañeros y comprueba el funcionamiento adecuado de GPG.&lt;/h4&gt;
&lt;p&gt;Aquí muestro como Alfonso me ha enviado un correo cifrado por mi clave pública y lo puedo visualizar correctamente.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://reeseschultz.github.io/img/SAD-P4.4.png&quot; alt=&quot;SAD-P4.4.png&quot; /&gt;&lt;/p&gt;
&lt;p&gt;Como podemos ver en la siguiente captura le he enviado correctamente un correo cifrado a Paco.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://reeseschultz.github.io/img/SAD-P4.7.jpg&quot; alt=&quot;SAD-P4.7.png&quot; /&gt;&lt;/p&gt;
&lt;h4 id=&quot;4.-correo-firmado-para-ra%C3%BAl.&quot; tabindex=&quot;-1&quot;&gt;4. Correo firmado para Raúl.&lt;/h4&gt;
&lt;p&gt;Enviado el correo a Raúl, mi correo es &lt;a href=&quot;mailto:alemd01@outlook.com&quot;&gt;alemd01@outlook.com&lt;/a&gt; para que lo puedas verificar.&lt;/p&gt;
&lt;hr /&gt;
&lt;h3 id=&quot;tarea-3%3A-integridad-de-ficheros&quot; tabindex=&quot;-1&quot;&gt;Tarea 3: Integridad de ficheros&lt;/h3&gt;
&lt;h4 id=&quot;1.-para-validar-el-contenido-de-la-imagen-cd%2C-solo-aseg%C3%BArese-de-usar-la-herramienta-apropiada-para-sumas-de-verificaci%C3%B3n.-para-cada-versi%C3%B3n-publicada-existen-archivos-de-suma-de-comprobaci%C3%B3n-con-algoritmos-fuertes-(sha256-y-sha512)%3B-deber%C3%ADa-usar-las-herramientas-sha256sum-o-sha512sum-para-trabajar-con-ellos.&quot; tabindex=&quot;-1&quot;&gt;1. Para validar el contenido de la imagen CD, solo asegúrese de usar la herramienta apropiada para sumas de verificación. Para cada versión publicada existen archivos de suma de comprobación con algoritmos fuertes (SHA256 y SHA512); debería usar las herramientas sha256sum o sha512sum para trabajar con ellos.&lt;/h4&gt;
&lt;p&gt;Una vez descargada la ISO de debian, abriremos el fichero &lt;a href=&quot;https://cdimage.debian.org/debian-cd/current/amd64/iso-cd/&quot;&gt;SHA256SUMS&lt;/a&gt; que se encuentra en el mismo enlace y nos centraremos en el checksum para la imagen &lt;code&gt;debian-11.5.0-amd64-netinst.iso&lt;/code&gt; ya que esa es la que hemos descargado.&lt;/p&gt;
&lt;p&gt;Ejecutaremos el siguiente comando para ver checksum de la ISO:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;alemd@debian:~/Descargas$ sha256sum debian-11.5.0-amd64-netinst.iso&lt;br /&gt;e307d0e583b4a8f7e5b436f8413d4707dd4242b70aea61eb08591dc0378522f3  debian-11.5.0-amd64-netinst.iso&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Y realizaremos un cat del archivo SHA512SUMS para ver si es el mismo checksum:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;alemd@debian:~/Descargas$ cat SHA256SUMS | grep debian-11.5.0-amd64-netinst.iso&lt;br /&gt;e307d0e583b4a8f7e5b436f8413d4707dd4242b70aea61eb08591dc0378522f3  debian-11.5.0-amd64-netinst.iso&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Como podemos comprobar, el checksum es el mismo.&lt;/p&gt;
&lt;h4 id=&quot;2.-verifica-que-el-contenido-del-hash-que-has-utilizado-no-ha-sido-manipulado%2C-usando-la-firma-digital-que-encontrar%C3%A1s-en-el-repositorio.-puedes-encontrar-una-gu%C3%ADa-para-realizarlo-en-este-art%C3%ADculo%3A-how-to-verify-an-authenticity-of-downloaded-debian-iso-images&quot; tabindex=&quot;-1&quot;&gt;2. Verifica que el contenido del hash que has utilizado no ha sido manipulado, usando la firma digital que encontrarás en el repositorio. Puedes encontrar una guía para realizarlo en este artículo: How to verify an authenticity of downloaded Debian ISO images&lt;/h4&gt;
&lt;p&gt;Primero descargaremos el fichero &lt;a href=&quot;https://cdimage.debian.org/debian-cd/current/amd64/iso-cd/SHA256SUMS.sign&quot;&gt;SHA256SUMS.sign&lt;/a&gt;.&lt;/p&gt;
&lt;p&gt;Importaremos la clave pública de debian para poder verificar la firma.&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;alemd@debian:~/Descargas$ gpg --keyserver keyring.debian.org --recv DF9B9C49EAA9298432589D76DA87E80D6294BE9B&lt;br /&gt;gpg: clave DA87E80D6294BE9B: clave pública &quot;Debian CD signing key &amp;lt;debian-cd@lists.debian.org&gt;&quot; importada&lt;br /&gt;gpg: Cantidad total procesada: 1&lt;br /&gt;gpg:               importadas: 1&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Una vez importada la clave pública de debian, procederemos a verificar la firma:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;alemd@debian:~/Descargas$ gpg --verify SHA256SUMS.sign SHA256SUMS&lt;br /&gt;gpg: Firmado el dom 11 sep 2022 01:00:07 CEST&lt;br /&gt;gpg:                usando RSA clave DF9B9C49EAA9298432589D76DA87E80D6294BE9B&lt;br /&gt;gpg: Firma correcta de &quot;Debian CD signing key &amp;lt;debian-cd@lists.debian.org&gt;&quot; [desconocido]&lt;br /&gt;gpg: ATENCIÓN: ¡Esta clave no está certificada por una firma de confianza!&lt;br /&gt;gpg:          No hay indicios de que la firma pertenezca al propietario.&lt;br /&gt;Huellas dactilares de la clave primaria: DF9B 9C49 EAA9 2984 3258  9D76 DA87 E80D 6294 BE9B&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Indica que se ha verificado correctamente y nos advierte de que la clave no está certificada por una firma de confianza.&lt;/p&gt;
&lt;hr /&gt;
&lt;h3 id=&quot;tarea-4%3A-integridad-y-autenticidad-(apt-secure)&quot; tabindex=&quot;-1&quot;&gt;Tarea 4: Integridad y autenticidad (apt secure)&lt;/h3&gt;
&lt;h4 id=&quot;1.-%C2%BFqu%C3%A9-software-utiliza-apt-secure-para-realizar-la-criptograf%C3%ADa-asim%C3%A9trica%3F&quot; tabindex=&quot;-1&quot;&gt;1. ¿Qué software utiliza apt secure para realizar la criptografía asimétrica?&lt;/h4&gt;
&lt;p&gt;El software que  usa la herramienta apt secure es GPG.&lt;/p&gt;
&lt;h4 id=&quot;2.-%C2%BFpara-que-sirve-el-comando-apt-key%3F-%C2%BFqu%C3%A9-muestra-el-comando-apt-key-list%3F&quot; tabindex=&quot;-1&quot;&gt;2. ¿Para que sirve el comando apt-key? ¿Qué muestra el comando apt-key list?&lt;/h4&gt;
&lt;p&gt;Este comando, es una herramienta que permite gestionar la lista de claves que utiliza APT para autenticar paquetes. Algunas de las opciones mas usadas son las siguientes: add, del, export, exportall, list y finger.&lt;/p&gt;
&lt;p&gt;El comando apt-key list muestra todas las claves de confianza para APT:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;alemd@debian:~/Descargas$ apt-key list&lt;br /&gt;Warning: apt-key is deprecated. Manage keyring files in trusted.gpg.d instead (see apt-key(8)).&lt;br /&gt;/etc/apt/trusted.gpg&lt;br /&gt;--------------------&lt;br /&gt;pub   rsa4096 2021-10-27 [SC] [caduca: 2023-01-20]&lt;br /&gt;      F9A2 1197 6ED6 62F0 0E59  361E 5E3C 45D7 B312 C643&lt;br /&gt;uid        [desconocida] Spotify Public Repository Signing Key &amp;lt;tux@spotify.com&gt;&lt;br /&gt;&lt;br /&gt;/etc/apt/trusted.gpg.d/debian-archive-bullseye-automatic.gpg&lt;br /&gt;------------------------------------------------------------&lt;br /&gt;pub   rsa4096 2021-01-17 [SC] [caduca: 2029-01-15]&lt;br /&gt;      1F89 983E 0081 FDE0 18F3  CC96 73A4 F27B 8DD4 7936&lt;br /&gt;uid        [desconocida] Debian Archive Automatic Signing Key (11/bullseye) &amp;lt;ftpmaster@debian.org&gt;&lt;br /&gt;sub   rsa4096 2021-01-17 [S] [caduca: 2029-01-15]&lt;br /&gt;&lt;br /&gt;/etc/apt/trusted.gpg.d/debian-archive-bullseye-security-automatic.gpg&lt;br /&gt;---------------------------------------------------------------------&lt;br /&gt;pub   rsa4096 2021-01-17 [SC] [caduca: 2029-01-15]&lt;br /&gt;      AC53 0D52 0F2F 3269 F5E9  8313 A484 4904 4AAD 5C5D&lt;br /&gt;uid        [desconocida] Debian Security Archive Automatic Signing Key (11/bullseye) &amp;lt;ftpmaster@debian.org&gt;&lt;br /&gt;sub   rsa4096 2021-01-17 [S] [caduca: 2029-01-15]&lt;br /&gt;&lt;br /&gt;/etc/apt/trusted.gpg.d/debian-archive-bullseye-stable.gpg&lt;br /&gt;---------------------------------------------------------&lt;br /&gt;pub   rsa4096 2021-02-13 [SC] [caduca: 2029-02-11]&lt;br /&gt;      A428 5295 FC7B 1A81 6000  62A9 605C 66F0 0D6C 9793&lt;br /&gt;uid        [desconocida] Debian Stable Release Key (11/bullseye) &amp;lt;debian-release@lists.debian.org&gt;&lt;br /&gt;&lt;br /&gt;/etc/apt/trusted.gpg.d/debian-archive-buster-automatic.gpg&lt;br /&gt;----------------------------------------------------------&lt;br /&gt;pub   rsa4096 2019-04-14 [SC] [caduca: 2027-04-12]&lt;br /&gt;      80D1 5823 B7FD 1561 F9F7  BCDD DC30 D7C2 3CBB ABEE&lt;br /&gt;uid        [desconocida] Debian Archive Automatic Signing Key (10/buster) &amp;lt;ftpmaster@debian.org&gt;&lt;br /&gt;sub   rsa4096 2019-04-14 [S] [caduca: 2027-04-12]&lt;br /&gt;&lt;br /&gt;/etc/apt/trusted.gpg.d/debian-archive-buster-security-automatic.gpg&lt;br /&gt;-------------------------------------------------------------------&lt;br /&gt;pub   rsa4096 2019-04-14 [SC] [caduca: 2027-04-12]&lt;br /&gt;      5E61 B217 265D A980 7A23  C5FF 4DFA B270 CAA9 6DFA&lt;br /&gt;uid        [desconocida] Debian Security Archive Automatic Signing Key (10/buster) &amp;lt;ftpmaster@debian.org&gt;&lt;br /&gt;sub   rsa4096 2019-04-14 [S] [caduca: 2027-04-12]&lt;br /&gt;&lt;br /&gt;/etc/apt/trusted.gpg.d/debian-archive-buster-stable.gpg&lt;br /&gt;-------------------------------------------------------&lt;br /&gt;pub   rsa4096 2019-02-05 [SC] [caduca: 2027-02-03]&lt;br /&gt;      6D33 866E DD8F FA41 C014  3AED DCC9 EFBF 77E1 1517&lt;br /&gt;uid        [desconocida] Debian Stable Release Key (10/buster) &amp;lt;debian-release@lists.debian.org&gt;&lt;br /&gt;&lt;br /&gt;/etc/apt/trusted.gpg.d/debian-archive-stretch-automatic.gpg&lt;br /&gt;-----------------------------------------------------------&lt;br /&gt;pub   rsa4096 2017-05-22 [SC] [caduca: 2025-05-20]&lt;br /&gt;      E1CF 20DD FFE4 B89E 8026  58F1 E0B1 1894 F66A EC98&lt;br /&gt;uid        [desconocida] Debian Archive Automatic Signing Key (9/stretch) &amp;lt;ftpmaster@debian.org&gt;&lt;br /&gt;sub   rsa4096 2017-05-22 [S] [caduca: 2025-05-20]&lt;br /&gt;&lt;br /&gt;/etc/apt/trusted.gpg.d/debian-archive-stretch-security-automatic.gpg&lt;br /&gt;--------------------------------------------------------------------&lt;br /&gt;pub   rsa4096 2017-05-22 [SC] [caduca: 2025-05-20]&lt;br /&gt;      6ED6 F5CB 5FA6 FB2F 460A  E88E EDA0 D238 8AE2 2BA9&lt;br /&gt;uid        [desconocida] Debian Security Archive Automatic Signing Key (9/stretch) &amp;lt;ftpmaster@debian.org&gt;&lt;br /&gt;sub   rsa4096 2017-05-22 [S] [caduca: 2025-05-20]&lt;br /&gt;&lt;br /&gt;/etc/apt/trusted.gpg.d/debian-archive-stretch-stable.gpg&lt;br /&gt;--------------------------------------------------------&lt;br /&gt;pub   rsa4096 2017-05-20 [SC] [caduca: 2025-05-18]&lt;br /&gt;      067E 3C45 6BAE 240A CEE8  8F6F EF0F 382A 1A7B 6500&lt;br /&gt;uid        [desconocida] Debian Stable Release Key (9/stretch) &amp;lt;debian-release@lists.debian.org&gt;&lt;br /&gt;&lt;br /&gt;/etc/apt/trusted.gpg.d/microsoft.gpg&lt;br /&gt;------------------------------------&lt;br /&gt;pub   rsa2048 2015-10-28 [SC]&lt;br /&gt;      BC52 8686 B50D 79E3 39D3  721C EB3E 94AD BE12 29CF&lt;br /&gt;uid        [desconocida] Microsoft (Release signing) &amp;lt;gpgsecurity@microsoft.com&gt;&lt;br /&gt;&lt;br /&gt;/etc/apt/trusted.gpg.d/spotify-2021-10-27-5E3C45D7B312C643.gpg&lt;br /&gt;--------------------------------------------------------------&lt;br /&gt;pub   rsa4096 2021-10-27 [SC] [caduca: 2023-01-20]&lt;br /&gt;      F9A2 1197 6ED6 62F0 0E59  361E 5E3C 45D7 B312 C643&lt;br /&gt;uid        [desconocida] Spotify Public Repository Signing Key &amp;lt;tux@spotify.com&gt;&lt;br /&gt;&lt;br /&gt;/etc/apt/trusted.gpg.d/spotify-2022-11-14-7A3A762FAFD4A51F.gpg&lt;br /&gt;--------------------------------------------------------------&lt;br /&gt;pub   rsa4096 2022-11-14 [SC] [caduca: 2024-02-07]&lt;br /&gt;      E274 09F5 1D1B 6633 7F2D  2F41 7A3A 762F AFD4 A51F&lt;br /&gt;uid        [desconocida] Spotify Public Repository Signing Key &amp;lt;tux@spotify.com&gt;&lt;br /&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&quot;3.-en-que-fichero-se-guarda-el-anillo-de-claves-que-guarda-la-herramienta-apt-key%3F&quot; tabindex=&quot;-1&quot;&gt;3. En que fichero se guarda el anillo de claves que guarda la herramienta apt-key?&lt;/h4&gt;
&lt;p&gt;Se encuentra en &lt;code&gt;/etc/apt/trusted.gpg&lt;/code&gt;.&lt;/p&gt;
&lt;h4 id=&quot;4.-%C2%BFqu%C3%A9-contiene-el-archivo-release-de-un-repositorio-de-paquetes%3F.-%C2%BFy-el-archivo-release.gpg%3F.-puedes-ver-estos-archivos-en-el-repositorio-http%3A%2F%2Fftp.debian.org%2Fdebian%2Fdists%2Fdebian10.1%2F.-estos-archivos-se-descargan-cuando-hacemos-un-apt-update.&quot; tabindex=&quot;-1&quot;&gt;4. ¿Qué contiene el archivo Release de un repositorio de paquetes?. ¿Y el archivo Release.gpg?. Puedes ver estos archivos en el repositorio &lt;a href=&quot;http://ftp.debian.org/debian/dists/Debian10.1/&quot;&gt;http://ftp.debian.org/debian/dists/Debian10.1/&lt;/a&gt;. Estos archivos se descargan cuando hacemos un apt update.&lt;/h4&gt;
&lt;p&gt;El archivo release contiene una lista de los archivos &lt;code&gt;Package&lt;/code&gt;, junto con sus hash MD5, SHA1 y SHA256. Con esto, podemos verificar que los ficheros &lt;code&gt;Packages&lt;/code&gt; no han sido manipulados, comparando el hash que se nos ha facilitado con el hash que nosotros calculamos osbre el fichero que hemos descargado.&lt;/p&gt;
&lt;p&gt;El archivo release.gpg Contiene la firma con la que se verifica que no se ha manipulado el paquete.&lt;/p&gt;
&lt;h4 id=&quot;5.-explica-el-proceso-por-el-cual-el-sistema-nos-asegura-que-los-ficheros-que-estamos-descargando-son-leg%C3%ADtimos.&quot; tabindex=&quot;-1&quot;&gt;5. Explica el proceso por el cual el sistema nos asegura que los ficheros que estamos descargando son legítimos.&lt;/h4&gt;
&lt;p&gt;Primero se descargan los ficheros Release, Release.gpg y el fichero Packages correspondientes. Se comprueba que usando la firma Release.gpg más la clave pública correspondiente el fichero es legítimo, entonces apt ya confía en todos sus checksum. Apt compara el checksum del Package con el que checksum del fichero Release, si ambos coinciden, el fichero se habría descargado.&lt;/p&gt;
&lt;h4 id=&quot;6.-a%C3%B1ade-de-forma-correcta-el-repositorio-de-virtualbox-a%C3%B1adiendo-la-clave-p%C3%BAblica-de-virtualbox-como-se-indica-en-la-documentaci%C3%B3n.&quot; tabindex=&quot;-1&quot;&gt;6. Añade de forma correcta el repositorio de virtualbox añadiendo la clave pública de virtualbox como se indica en la documentación.&lt;/h4&gt;
&lt;p&gt;Primero descargamos las claves gpg:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;sudo wget -O- https://www.virtualbox.org/download/oracle_vbox_2016.asc | gpg --dearmor | sudo tee /usr/share/keyrings/virtualbox.gpg&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Añadimos el repositorio al sources.list:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;echo deb [arch=amd64 signed-by=/usr/share/keyrings/virtualbox.gpg] http://download.virtualbox.org/virtualbox/debian bullseye contrib | sudo tee /etc/apt/sources.list.d/virtualbox.list&lt;/code&gt;&lt;/pre&gt;
&lt;hr /&gt;
&lt;h3 id=&quot;tarea-5%3A-autentificaci%C3%B3n%3A-ejemplo-ssh&quot; tabindex=&quot;-1&quot;&gt;Tarea 5: Autentificación: ejemplo SSH&lt;/h3&gt;
&lt;h4 id=&quot;1.-explica-los-pasos-que-se-producen-entre-el-cliente-y-el-servidor-para-que-el-protocolo-cifre-la-informaci%C3%B3n-que-se-transmite%3F-%C2%BFpara-qu%C3%A9-se-utiliza-la-criptograf%C3%ADa-sim%C3%A9trica%3F-%C2%BFy-la-asim%C3%A9trica%3F&quot; tabindex=&quot;-1&quot;&gt;1. Explica los pasos que se producen entre el cliente y el servidor para que el protocolo cifre la información que se transmite? ¿Para qué se utiliza la criptografía simétrica? ¿Y la asimétrica?&lt;/h4&gt;
&lt;p&gt;Son 2 pasos los que se realizan antes de que se cifre una comunicación ssh:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Conexión:&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;El cliente establece una conexión TCP con l servidor, y este responde con las versiones del protocolo que soporta. El cliente tiene que usar unas de las versiones que soporta el servidor para continuar. El servidor comparte su clave pública con el cliente para que compruebe si es la máquina ala que quería conectarse. Ahora, ambas partes están preparadas para la negociación de una clave de sesión usando Diffie-Hellman.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Negociación:&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;El cliente y el servidor, se ponen de acuerdo en un número primo alto, que servirá como seed value, también se ponen de acuerdo en un tipo de cifrado, generan un número primo por separado, que mantienen en secreto de la otra parte que lo usan como una clave privada de la negociación, intercambian sus claves públicas generadas(no son las mismas que usan para la autenticación). Cada parte usa su clave privada más la clave pública de la otra parte más el número primo compartido original para calcular una clave compartida llamada shared secret. Este shared secret se usa para encriptar toda la comunicación a partir de ahora.&lt;/p&gt;
&lt;p&gt;La criptografía simétrica se usa para encriptar conexiones mediante una clave secreta.&lt;/p&gt;
&lt;p&gt;La criptografía asimétrica se usa durante el intercambio de claves, se usa en la autenticación del cliente con el servidor.&lt;/p&gt;
&lt;h4 id=&quot;2.-explica-los-dos-m%C3%A9todos-principales-de-autentificaci%C3%B3n%3A-por-contrase%C3%B1a-y-utilizando-un-par-de-claves-p%C3%BAblicas-y-privadas.&quot; tabindex=&quot;-1&quot;&gt;2. Explica los dos métodos principales de autentificación: por contraseña y utilizando un par de claves públicas y privadas.&lt;/h4&gt;
&lt;ul&gt;
&lt;li&gt;Por Contraseñas:&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Es el método más simple, el servidor pide al cliente que introduzca la contraseña del usuario al que intenta conectar y esta contraseña se envía usando la encriptación que previamente se ha negociado para que se mantenga en secreto.&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;Por par de claves:&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Utiliza dos claves separadas para el cifrado y el descifrado. Estas dos claves se conocen como clave pública y privada, juntas forman el par de claves. La clave pública como su nombre indica se distribuye abiertamente y se comparte con el otro cliente. La clave privada debe de permanecer oculta, para que la conexión sea segura, ningún tercero puede conocerla.&lt;/p&gt;
&lt;p&gt;El cliente envía el ID del par de claves con el que se quiere autenticar ante el servidor. El servidor comprueba en el fichero &lt;code&gt;authorized_keys&lt;/code&gt; del usuario al que quiere conectar el cliente si ese ID coincide con algunas de las claves públicas que tiene en el fichero. Si se encuentra una clave pública que coincide, el servidor genera un número aleatorio y usa esa clave pública para desencriptarlo. El servidor envía este número encriptado al cliente. Si el cliente tiene la clave privada del par de claves, podrá desencriptar este mensaje y revelar el número original. El cliente combina el número desencriptado con la clave compartida de sesión que se estça usando para encriptar la comunicación y calcula el hash MD5 de este valor. El cliente envía al servidor este hash como respuesta. El servidor compara el hash que él mismo generó con el que el cliente le ha enviado. Si los valores son iguales, se prueba que el cliente tiene la clave privada correcta y el cliente se autentica correctamente.&lt;/p&gt;
&lt;h4 id=&quot;3.-en-el-cliente-para-que-sirve-el-contenido-que-se-guarda-en-el-fichero-~%2F.ssh%2Fknow_hosts%3F&quot; tabindex=&quot;-1&quot;&gt;3. En el cliente para que sirve el contenido que se guarda en el fichero ~/.ssh/know_hosts?&lt;/h4&gt;
&lt;p&gt;En este fichero, se guardan todas las claves públicas a las que el cliente se conecta. Se usa para autenticar los servidores a los que se conecta.&lt;/p&gt;
&lt;h4 id=&quot;4.-%C2%BFqu%C3%A9-significa-este-mensaje-que-aparece-la-primera-vez-que-nos-conectamos-a-un-servidor%3F&quot; tabindex=&quot;-1&quot;&gt;4. ¿Qué significa este mensaje que aparece la primera vez que nos conectamos a un servidor?&lt;/h4&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt; $ ssh debian@172.22.200.74&lt;br /&gt; The authenticity of host &#39;172.22.200.74 (172.22.200.74)&#39; can&#39;t be established.&lt;br /&gt; ECDSA key fingerprint is SHA256:7ZoNZPCbQTnDso1meVSNoKszn38ZwUI4i6saebbfL4M.&lt;br /&gt; Are you sure you want to continue connecting (yes/no)? &lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Este mensaje es mostrado al ser la primera vez que nos conectamos a ese servidor por ssh y sucede porque en el fichero &lt;code&gt;know_hosts&lt;/code&gt; no tenemos almacenada la clave pública y no se ha podido verificar la autenticidad del mismo. Si estamos seguro de su autenticidad, le diremos que sí y se guardará su clave pública en el fichero &lt;code&gt;know_hosts&lt;/code&gt;.&lt;/p&gt;
&lt;h4 id=&quot;5.-en-ocasiones-cuando-estamos-trabajando-en-el-cloud%2C-y-reutilizamos-una-ip-flotante-nos-aparece-este-mensaje%3A&quot; tabindex=&quot;-1&quot;&gt;5. En ocasiones cuando estamos trabajando en el cloud, y reutilizamos una ip flotante nos aparece este mensaje:&lt;/h4&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt; $ ssh debian@172.22.200.74&lt;br /&gt; @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@&lt;br /&gt; @    WARNING: REMOTE HOST IDENTIFICATION HAS CHANGED!     @&lt;br /&gt; @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@&lt;br /&gt; IT IS POSSIBLE THAT SOMEONE IS DOING SOMETHING NASTY!&lt;br /&gt; Someone could be eavesdropping on you right now (man-in-the-middle attack)!&lt;br /&gt; It is also possible that a host key has just been changed.&lt;br /&gt; The fingerprint for the ECDSA key sent by the remote host is&lt;br /&gt; SHA256:W05RrybmcnJxD3fbwJOgSNNWATkVftsQl7EzfeKJgNc.&lt;br /&gt; Please contact your system administrator.&lt;br /&gt; Add correct host key in /home/jose/.ssh/known_hosts to get rid of this message.&lt;br /&gt; Offending ECDSA key in /home/jose/.ssh/known_hosts:103&lt;br /&gt;   remove with:&lt;br /&gt;   ssh-keygen -f &quot;/home/jose/.ssh/known_hosts&quot; -R &quot;172.22.200.74&quot;&lt;br /&gt; ECDSA host key for 172.22.200.74 has changed and you have requested strict checking.&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;El mensaje nos indica que la clave pública del servidor al cual nos queremos conectar ha cambiado con respecto a la que teníamos guardadada para esa dirección IP en nuestro fichero &lt;code&gt;know_hosts&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;Esta alerta sale porque así se realizan los ataques Man-In-The-Middle, pero si estamos seguros de que somos nosotros o una máquina que conocemos, borramos la línea correspondiente en nuestro &lt;code&gt;know_hosts&lt;/code&gt; de la antigua conexión y volvemos a conectar o podemos ejecutar el siguiente comando:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;   ssh-keygen -f &quot;/home/jose/.ssh/known_hosts&quot; -R &quot;&amp;lt;&amp;lt;DIRECCION.IP.DEL.SERVIDOR&gt;&gt;&quot;&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&quot;6.-%C2%BFqu%C3%A9-guardamos-y-para-qu%C3%A9-sirve-el-fichero-en-el-servidor-~%2F.ssh%2Fauthorized_keys%3F&quot; tabindex=&quot;-1&quot;&gt;6. ¿Qué guardamos y para qué sirve el fichero en el servidor ~/.ssh/authorized_keys?&lt;/h4&gt;
&lt;p&gt;Es un fichero que existe para cada usuario del sistema y guarda las claves públicas de los clientes que entran a ese usuario mediante ssh.&lt;/p&gt;
&lt;hr /&gt;
&lt;h2 id=&quot;documento-realizado-por%3A&quot; tabindex=&quot;-1&quot;&gt;&lt;strong&gt;Documento realizado por:&lt;/strong&gt;&lt;/h2&gt;
&lt;p&gt;✒️ &lt;strong&gt;Alejandro Montes Delgado&lt;/strong&gt; - &lt;em&gt;2º ASIR&lt;/em&gt;&lt;/p&gt;
</content>
	</entry>
	
	<entry>
		<title>Boletín individual PL/SQL</title>
		<link href="https://reeseschultz.github.io/post/boletin-individual-plsql/"/>
		<updated>2022-12-04T00:00:00Z</updated>
		<id>https://reeseschultz.github.io/post/boletin-individual-plsql/</id>
		<content type="html">&lt;h3 id=&quot;hacer-un-procedimiento-que-muestre-el-nombre-y-el-salario-del-empleado-cuyo-c%C3%B3digo-es-7082&quot; tabindex=&quot;-1&quot;&gt;Hacer un procedimiento que muestre el nombre y el salario del empleado cuyo código es 7082&lt;/h3&gt;
&lt;pre class=&quot;language-plsql&quot;&gt;&lt;code class=&quot;language-plsql&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;CREATE&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;OR&lt;/span&gt; REPLACE &lt;span class=&quot;token keyword&quot;&gt;PROCEDURE&lt;/span&gt; MUESTRANOMBREYSALARIO&lt;br /&gt;&lt;span class=&quot;token keyword&quot;&gt;IS&lt;/span&gt;&lt;br /&gt;    V_ENAME EMP&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;ENAME&lt;span class=&quot;token operator&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;TYPE&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;    V_SAL EMP&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;SAL&lt;span class=&quot;token operator&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;TYPE&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token keyword&quot;&gt;BEGIN&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token keyword&quot;&gt;SELECT&lt;/span&gt; ENAME&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; SAL &lt;span class=&quot;token keyword&quot;&gt;INTO&lt;/span&gt; V_ENAME&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; V_SAL&lt;br /&gt;    &lt;span class=&quot;token keyword&quot;&gt;FROM&lt;/span&gt; EMP &lt;span class=&quot;token keyword&quot;&gt;WHERE&lt;/span&gt; EMPNO &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;7782&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;    &lt;br /&gt;    DBMS_OUTPUT&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;PUT_LINE&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;Nombre: &#39;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;||&lt;/span&gt; v_ename&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;    DBMS_OUTPUT&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;PUT_LINE&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;Salario: &#39;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;||&lt;/span&gt; v_sal&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token keyword&quot;&gt;END&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;&lt;br /&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&quot;https://reeseschultz.github.io/img/BD-P3.1.png&quot; alt=&quot;BD-P3.1.png&quot; /&gt;&lt;/p&gt;
&lt;h3 id=&quot;hacer-un-procedimiento-que-reciba-como-par%C3%A1metro-un-c%C3%B3digo-de-empleado-y-devuelva-su-nombre&quot; tabindex=&quot;-1&quot;&gt;Hacer un procedimiento que reciba como parámetro un código de empleado y devuelva su nombre&lt;/h3&gt;
&lt;pre class=&quot;language-plsql&quot;&gt;&lt;code class=&quot;language-plsql&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;CREATE&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;OR&lt;/span&gt; REPLACE &lt;span class=&quot;token keyword&quot;&gt;PROCEDURE&lt;/span&gt; MUESTRA_NOMBRE &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;P_EMPNO EMP&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;EMPNO&lt;span class=&quot;token operator&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;TYPE&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token keyword&quot;&gt;IS&lt;/span&gt;&lt;br /&gt;    V_NOMBRE EMP&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;ENAME&lt;span class=&quot;token operator&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;TYPE&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token keyword&quot;&gt;BEGIN&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token keyword&quot;&gt;SELECT&lt;/span&gt; ENAME &lt;span class=&quot;token keyword&quot;&gt;INTO&lt;/span&gt; V_NOMBRE &lt;br /&gt;    &lt;span class=&quot;token keyword&quot;&gt;FROM&lt;/span&gt; EMP &lt;span class=&quot;token keyword&quot;&gt;WHERE&lt;/span&gt; EMPNO&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;P_EMPNO&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;    DBMS_OUTPUT&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;PUT_LINE&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;Nombre: &#39;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;||&lt;/span&gt; V_NOMBRE&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token keyword&quot;&gt;END&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&quot;https://reeseschultz.github.io/img/BD-P3.2.png&quot; alt=&quot;BD-P3.2.png&quot; /&gt;&lt;/p&gt;
&lt;h3 id=&quot;hacer-un-procedimiento-que-devuelva-los-nombres-de-los-tres-empleados-m%C3%A1s-antiguos&quot; tabindex=&quot;-1&quot;&gt;Hacer un procedimiento que devuelva los nombres de los tres empleados más antiguos&lt;/h3&gt;
&lt;pre class=&quot;language-plsql&quot;&gt;&lt;code class=&quot;language-plsql&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;CREATE&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;OR&lt;/span&gt; REPLACE &lt;span class=&quot;token keyword&quot;&gt;PROCEDURE&lt;/span&gt; TRES_MAS_ANTIGUOS&lt;br /&gt;&lt;span class=&quot;token keyword&quot;&gt;AS&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token keyword&quot;&gt;BEGIN&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;FOR&lt;/span&gt; emp &lt;span class=&quot;token keyword&quot;&gt;IN&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;SELECT&lt;/span&gt; ENAME&lt;br /&gt;              &lt;span class=&quot;token keyword&quot;&gt;FROM&lt;/span&gt; EMP&lt;br /&gt;              &lt;span class=&quot;token keyword&quot;&gt;ORDER&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;BY&lt;/span&gt; HIREDATE &lt;span class=&quot;token keyword&quot;&gt;ASC&lt;/span&gt;&lt;br /&gt;              &lt;span class=&quot;token keyword&quot;&gt;FETCH&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;FIRST&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;3&lt;/span&gt; ROWS &lt;span class=&quot;token keyword&quot;&gt;ONLY&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;LOOP&lt;/span&gt;&lt;br /&gt;    DBMS_OUTPUT&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;PUT_LINE&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;emp&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;ENAME&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;END&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;LOOP&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token keyword&quot;&gt;END&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&quot;https://reeseschultz.github.io/img/BD-P3.3.png&quot; alt=&quot;BD-P3.3.png&quot; /&gt;&lt;/p&gt;
&lt;h3 id=&quot;hacer-un-procedimiento-que-reciba-el-nombre-de-un-tablespace-y-muestre-los-nombres-de-los-usuarios-que-lo-tienen-como-tablespace-por-defecto-(vista-dba_users)&quot; tabindex=&quot;-1&quot;&gt;Hacer un procedimiento que reciba el nombre de un tablespace y muestre los nombres de los usuarios que lo tienen como tablespace por defecto (Vista DBA_USERS)&lt;/h3&gt;
&lt;pre class=&quot;language-plsql&quot;&gt;&lt;code class=&quot;language-plsql&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;CREATE&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;OR&lt;/span&gt; REPLACE &lt;span class=&quot;token keyword&quot;&gt;PROCEDURE&lt;/span&gt; MUESTRA_TABLESPACE &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;P_TABLESPACE VARCHAR2&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token keyword&quot;&gt;IS&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token keyword&quot;&gt;CURSOR&lt;/span&gt; C_NOMBRE &lt;span class=&quot;token keyword&quot;&gt;IS&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token keyword&quot;&gt;SELECT&lt;/span&gt; USERNAME&lt;br /&gt;    &lt;span class=&quot;token keyword&quot;&gt;FROM&lt;/span&gt; DBA_USERS&lt;br /&gt;    &lt;span class=&quot;token keyword&quot;&gt;WHERE&lt;/span&gt; DEFAULT_TABLESPACE&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;P_TABLESPACE&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token keyword&quot;&gt;BEGIN&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token keyword&quot;&gt;FOR&lt;/span&gt; R_NAME &lt;span class=&quot;token keyword&quot;&gt;IN&lt;/span&gt; C_NOMBRE&lt;br /&gt;    &lt;span class=&quot;token keyword&quot;&gt;LOOP&lt;/span&gt;&lt;br /&gt;        DBMS_OUTPUT&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;PUT_LINE&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;CHR&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;9&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;||&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;Nombre: &#39;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;||&lt;/span&gt; R_NAME&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;USERNAME&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token keyword&quot;&gt;END&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;LOOP&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token keyword&quot;&gt;END&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&quot;https://reeseschultz.github.io/img/BD-P3.4.png&quot; alt=&quot;BD-P3.4.png&quot; /&gt;&lt;/p&gt;
&lt;h3 id=&quot;modificar-el-procedimiento-anterior-para-que-haga-lo-mismo-pero-devolviendo-el-n%C3%BAmero-de-usuarios-que-tienen-ese-tablespace-como-tablespace-por-defecto.-nota%3A-hay-que-convertir-el-procedimiento-en-funci%C3%B3n&quot; tabindex=&quot;-1&quot;&gt;Modificar el procedimiento anterior para que haga lo mismo pero devolviendo el número de usuarios que tienen ese tablespace como tablespace por defecto. Nota: Hay que convertir el procedimiento en función&lt;/h3&gt;
&lt;pre class=&quot;language-plsql&quot;&gt;&lt;code class=&quot;language-plsql&quot;&gt;&lt;br /&gt;&lt;span class=&quot;token keyword&quot;&gt;CREATE&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;OR&lt;/span&gt; REPLACE &lt;span class=&quot;token keyword&quot;&gt;FUNCTION&lt;/span&gt; F_CUENTA_USUARIOS &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;P_TABLESPACE VARCHAR2&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;br /&gt; &lt;span class=&quot;token keyword&quot;&gt;RETURN&lt;/span&gt; NUMBER&lt;br /&gt;&lt;span class=&quot;token keyword&quot;&gt;IS&lt;/span&gt;&lt;br /&gt;  V_RESULTADO NUMBER&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token keyword&quot;&gt;BEGIN&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;SELECT&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;COUNT&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;USERNAME&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;INTO&lt;/span&gt; V_RESULTADO&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;FROM&lt;/span&gt; DBA_USERS &lt;span class=&quot;token keyword&quot;&gt;WHERE&lt;/span&gt; DEFAULT_TABLESPACE&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;P_TABLESPACE&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;RETURN&lt;/span&gt; V_RESULTADO&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token keyword&quot;&gt;END&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&quot;https://reeseschultz.github.io/img/BD-P3.5.png&quot; alt=&quot;BD-P3.5.png&quot; /&gt;&lt;/p&gt;
&lt;h3 id=&quot;hacer-un-procedimiento-llamado-mostrar_usuarios_por_tablespace-que-muestre-por-pantalla-un-listado-de-los-tablespaces-existentes-con-la-lista-de-usuarios-de-cada-uno-y-el-n%C3%BAmero-de-los-mismos%2C-as%C3%AD%3A-(vistas-dba_tablespaces-y-dba_users)&quot; tabindex=&quot;-1&quot;&gt;Hacer un procedimiento llamado mostrar_usuarios_por_tablespace que muestre por pantalla un listado de los tablespaces existentes con la lista de usuarios de cada uno y el número de los mismos, así: (Vistas DBA_TABLESPACES y DBA_USERS)&lt;/h3&gt;
&lt;pre class=&quot;language-plsql&quot;&gt;&lt;code class=&quot;language-plsql&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;CREATE&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;OR&lt;/span&gt; REPLACE &lt;span class=&quot;token keyword&quot;&gt;PROCEDURE&lt;/span&gt; MOSTRAR_USUARIOS_POR_TABLESPACE&lt;br /&gt;&lt;span class=&quot;token keyword&quot;&gt;IS&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;CURSOR&lt;/span&gt; C_TABLESPACE &lt;span class=&quot;token keyword&quot;&gt;IS&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;SELECT&lt;/span&gt; TABLESPACE_NAME &lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;FROM&lt;/span&gt; DBA_TABLESPACES&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  V_CONT NUMBER&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  V_CONT_TOTAL NUMBER &lt;span class=&quot;token operator&quot;&gt;:=&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token keyword&quot;&gt;BEGIN&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;FOR&lt;/span&gt; R_TABLESPACE &lt;span class=&quot;token keyword&quot;&gt;IN&lt;/span&gt; C_TABLESPACE&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;LOOP&lt;/span&gt;&lt;br /&gt;    DBMS_OUTPUT&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;PUT_LINE&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39; Tablespace: &#39;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;||&lt;/span&gt;R_TABLESPACE&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;TABLESPACE_NAME&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;    MUESTRA_TABLESPACE&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;R_TABLESPACE&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;TABLESPACE_NAME&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;  &lt;br /&gt;    V_CONT &lt;span class=&quot;token operator&quot;&gt;:=&lt;/span&gt; F_CUENTA_USUARIOS&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;R_TABLESPACE&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;TABLESPACE_NAME&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;    V_CONT_TOTAL &lt;span class=&quot;token operator&quot;&gt;:=&lt;/span&gt; V_CONT_TOTAL&lt;span class=&quot;token operator&quot;&gt;+&lt;/span&gt;V_CONT&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;    DBMS_OUTPUT&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;PUT_LINE&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;El total de usuarios en el Tablespace es: &#39;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;||&lt;/span&gt;V_CONT&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;END&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;LOOP&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  DBMS_OUTPUT&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;PUT_LINE&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;chr&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;||&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;El total de usuarios en la base de datos es: &#39;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;||&lt;/span&gt;V_CONT_TOTAL&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token keyword&quot;&gt;END&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&quot;https://reeseschultz.github.io/img/BD-P3.6.png&quot; alt=&quot;BD-P3.6.png&quot; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://reeseschultz.github.io/img/BD-P3.6.2.png&quot; alt=&quot;BD-P3.6.2.png&quot; /&gt;&lt;/p&gt;
&lt;h3 id=&quot;hacer-un-procedimiento-llamado-mostrar_codigo_fuente-que-reciba-el-nombre-de-otro-procedimiento-y-muestre-su-c%C3%B3digo-fuente.-(dba_source)&quot; tabindex=&quot;-1&quot;&gt;Hacer un procedimiento llamado mostrar_codigo_fuente  que reciba el nombre de otro procedimiento y muestre su código fuente. (DBA_SOURCE)&lt;/h3&gt;
&lt;p&gt;Lo he hecho de 2 formas distintas:&lt;/p&gt;
&lt;p&gt;Si usamos una consulta con la tabla DBA_SOURCES lo he hecho así.&lt;/p&gt;
&lt;pre class=&quot;language-plsql&quot;&gt;&lt;code class=&quot;language-plsql&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;CREATE&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;OR&lt;/span&gt; REPLACE &lt;span class=&quot;token keyword&quot;&gt;PROCEDURE&lt;/span&gt; MUESTRA_CODIGO_FUENTE &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;P_NOMBREPROCEDURE VARCHAR2&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token keyword&quot;&gt;IS&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token comment&quot;&gt;--CURSOR DONDE ALMACENAMOS EL PROCEDIMIENTO&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token keyword&quot;&gt;CURSOR&lt;/span&gt; C_NOMBREPROCEDURE &lt;span class=&quot;token keyword&quot;&gt;IS&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token keyword&quot;&gt;SELECT&lt;/span&gt; TEXT&lt;br /&gt;    &lt;span class=&quot;token keyword&quot;&gt;FROM&lt;/span&gt; DBA_SOURCE&lt;br /&gt;    &lt;span class=&quot;token keyword&quot;&gt;WHERE&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;NAME&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;P_NOMBREPROCEDURE&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token keyword&quot;&gt;BEGIN&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token comment&quot;&gt;--RECORREMOS EL CURSOR PARA MOSTRAR EL PROCEDIMIENTO&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token keyword&quot;&gt;FOR&lt;/span&gt; R_NAME &lt;span class=&quot;token keyword&quot;&gt;IN&lt;/span&gt; C_NOMBREPROCEDURE&lt;br /&gt;    &lt;span class=&quot;token keyword&quot;&gt;LOOP&lt;/span&gt;&lt;br /&gt;        DBMS_OUTPUT&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;PUT_LINE&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;R_NAME&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;TEXT&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token keyword&quot;&gt;END&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;LOOP&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token keyword&quot;&gt;END&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Muestra el código sin formato y con un salto de línea entre sí. He tenido que usar un cursor porque el código lo dividía en filas y no lo almacenaba en una sola.&lt;/p&gt;
&lt;p&gt;Para mostrarlo con formato he usado este procedimiento:&lt;/p&gt;
&lt;pre class=&quot;language-plsql&quot;&gt;&lt;code class=&quot;language-plsql&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;PROCEDURE&lt;/span&gt; MOSTRAR_CODIGO_FUENTE &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;P_PROCEDIMIENTO VARCHAR2&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token keyword&quot;&gt;IS&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token comment&quot;&gt;-- VARIABLE DONDE SE GUARDA EL CODIGO FUENTE&lt;/span&gt;&lt;br /&gt;  V_CODIGOFUENTE CLOB&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token keyword&quot;&gt;BEGIN&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token comment&quot;&gt;-- OBTIENE EL CODIGO FUENTE DEL PROCEDIMIENTO:&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;SELECT&lt;/span&gt; DBMS_METADATA&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;GET_DDL&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;PROCEDURE&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; P_PROCEDIMIENTO&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;INTO&lt;/span&gt; V_CODIGOFUENTE &lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;FROM&lt;/span&gt; DUAL&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  DBMS_OUTPUT&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;PUT_LINE&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;V_CODIGOFUENTE&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token keyword&quot;&gt;END&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&quot;https://reeseschultz.github.io/img/BD-P3.7.png&quot; alt=&quot;BD-P3.7.png&quot; /&gt;&lt;/p&gt;
&lt;h3 id=&quot;hacer-un-procedimiento-llamado-mostrar_privilegios_usuario-que-reciba-el-nombre-de-un-usuario-y-muestre-sus-privilegios-de-sistema-y-sus-privilegios-sobre-objetos.-(dba_sys_privs-y-dba_tab_privs)&quot; tabindex=&quot;-1&quot;&gt;Hacer un procedimiento llamado mostrar_privilegios_usuario que reciba el nombre de un usuario y muestre sus privilegios de sistema y sus privilegios sobre objetos. (DBA_SYS_PRIVS y DBA_TAB_PRIVS)&lt;/h3&gt;
&lt;pre class=&quot;language-plsql&quot;&gt;&lt;code class=&quot;language-plsql&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;CREATE&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;OR&lt;/span&gt; REPLACE &lt;span class=&quot;token keyword&quot;&gt;FUNCTION&lt;/span&gt; SYSTEM_PRIVILEGES &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;P_USERNAME VARCHAR2&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token keyword&quot;&gt;RETURN&lt;/span&gt; VARCHAR2&lt;br /&gt;&lt;span class=&quot;token keyword&quot;&gt;IS&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token comment&quot;&gt;-- LA VARIABLE TIENE COMO TIPO DE DATO CLOB PORQUE ES UNA CADENA DE CARACTERES MUY GRANDE LO QUE PUEDE LLEGAR A ALMACENAR.&lt;/span&gt;&lt;br /&gt;  V_PRIVILEGIOS CLOB&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token comment&quot;&gt;-- CREAMOS UN CURSOR QUE ALMACENA LOS PRIVILEGIOS DE LOS USUARIOS SEGÚN EL USUARIO QUE HEMOS PASADO POR PARÁMETRO.&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;CURSOR&lt;/span&gt; C_PRIVILEGIOS &lt;span class=&quot;token keyword&quot;&gt;IS&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;SELECT&lt;/span&gt; PRIVILEGE&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;FROM&lt;/span&gt; DBA_SYS_PRIVS&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;WHERE&lt;/span&gt; GRANTEE&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;P_USERNAME&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token keyword&quot;&gt;BEGIN&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token comment&quot;&gt;--EN EL FOR LO QUE HACEMOS ES GUARDAR EN LA VARIABLE LOS PRIVILEGIOS SEPARADOS POR UNA COMA.&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;FOR&lt;/span&gt; R_SYS &lt;span class=&quot;token keyword&quot;&gt;IN&lt;/span&gt; C_PRIVILEGIOS&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;LOOP&lt;/span&gt;&lt;br /&gt;    V_PRIVILEGIOS &lt;span class=&quot;token operator&quot;&gt;:=&lt;/span&gt; V_PRIVILEGIOS&lt;span class=&quot;token operator&quot;&gt;||&lt;/span&gt; R_SYS&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;PRIVILEGE &lt;span class=&quot;token operator&quot;&gt;||&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;, &#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;END&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;LOOP&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token comment&quot;&gt;-- CON EL RTRIM QUITAMOS LA ÚLTIMA COMA Y ESPACIO.&lt;/span&gt;&lt;br /&gt;  V_PRIVILEGIOS &lt;span class=&quot;token operator&quot;&gt;:=&lt;/span&gt; RTRIM&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;V_PRIVILEGIOS&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;, &#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;RETURN&lt;/span&gt; V_PRIVILEGIOS&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token keyword&quot;&gt;END&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;&lt;span class=&quot;token comment&quot;&gt;-- ESTA FUNCION NO LA COMENTO YA QUE ES LA MISMA QUE LA ANTERIOR CAMBIANDO LA CONSULTA.&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token keyword&quot;&gt;CREATE&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;OR&lt;/span&gt; REPLACE &lt;span class=&quot;token keyword&quot;&gt;FUNCTION&lt;/span&gt; TABLES_PRIVILEGES &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;P_USERNAME VARCHAR2&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token keyword&quot;&gt;RETURN&lt;/span&gt; VARCHAR2&lt;br /&gt;&lt;span class=&quot;token keyword&quot;&gt;IS&lt;/span&gt;&lt;br /&gt;  V_PRIVILEGIOS CLOB&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;CURSOR&lt;/span&gt; C_PRIVILEGIOS &lt;span class=&quot;token keyword&quot;&gt;IS&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;SELECT&lt;/span&gt; PRIVILEGE&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;FROM&lt;/span&gt; DBA_TAB_PRIVS&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;WHERE&lt;/span&gt; GRANTOR&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;P_USERNAME&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token keyword&quot;&gt;BEGIN&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;FOR&lt;/span&gt; R_TAB &lt;span class=&quot;token keyword&quot;&gt;IN&lt;/span&gt; C_PRIVILEGIOS&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;LOOP&lt;/span&gt;&lt;br /&gt;    V_PRIVILEGIOS &lt;span class=&quot;token operator&quot;&gt;:=&lt;/span&gt; V_PRIVILEGIOS&lt;span class=&quot;token operator&quot;&gt;||&lt;/span&gt; R_TAB&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;PRIVILEGE &lt;span class=&quot;token operator&quot;&gt;||&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;, &#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;END&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;LOOP&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  V_PRIVILEGIOS &lt;span class=&quot;token operator&quot;&gt;:=&lt;/span&gt; RTRIM&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;V_PRIVILEGIOS&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;, &#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;RETURN&lt;/span&gt; V_PRIVILEGIOS&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token keyword&quot;&gt;END&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;&lt;span class=&quot;token comment&quot;&gt;-- ESTE PROCEDIMIENTO ES MUY SENCILLO, ALMACENAMOS LAS FUNCIONES EN VARIABLES Y LAS MOSTRAMOS POR PANTALLA.&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token keyword&quot;&gt;CREATE&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;OR&lt;/span&gt; REPLACE &lt;span class=&quot;token keyword&quot;&gt;PROCEDURE&lt;/span&gt; MOSTRAR_PRIVILEGIOS_USUARIO &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;P_USERNAME VARCHAR2&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token keyword&quot;&gt;IS&lt;/span&gt;&lt;br /&gt;  V_SYS_PRIV CLOB&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  V_TAB_PRIV CLOB&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token keyword&quot;&gt;BEGIN&lt;/span&gt;&lt;br /&gt;  V_SYS_PRIV &lt;span class=&quot;token operator&quot;&gt;:=&lt;/span&gt; SYSTEM_PRIVILEGES&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;P_USERNAME&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  V_TAB_PRIV &lt;span class=&quot;token operator&quot;&gt;:=&lt;/span&gt; TABLES_PRIVILEGES&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;P_USERNAME&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  DBMS_OUTPUT&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;PUT_LINE&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;Los privilegios de sistema del usuario &#39;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;||&lt;/span&gt; P_USERNAME &lt;span class=&quot;token operator&quot;&gt;||&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39; son: &#39;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;||&lt;/span&gt; V_SYS_PRIV&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  DBMS_OUTPUT&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;PUT_LINE&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;Los privilegios sobre objetos del usuario &#39;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;||&lt;/span&gt; P_USERNAME &lt;span class=&quot;token operator&quot;&gt;||&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39; son: &#39;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;||&lt;/span&gt; V_TAB_PRIV&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token keyword&quot;&gt;END&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&quot;https://reeseschultz.github.io/img/BD-P3.8.png&quot; alt=&quot;BD-P3.8.png&quot; /&gt;&lt;/p&gt;
&lt;h3 id=&quot;realiza-un-procedimiento-llamado-listar_comisiones-que-nos-muestre-por-pantalla-un-listado-de-las-comisiones-de-los-empleados-agrupados-seg%C3%BAn-la-localidad-donde-est%C3%A1-ubicado-su-departamento-con-el-siguiente-formato%3A&quot; tabindex=&quot;-1&quot;&gt;Realiza un procedimiento llamado listar_comisiones que nos muestre por pantalla un listado de las comisiones de los empleados agrupados según la localidad donde está ubicado su departamento con el siguiente formato:&lt;/h3&gt;
&lt;p&gt;SIN TERMINAR. NO FUNCIONA.&lt;/p&gt;
&lt;p&gt;TOTAL DE COMISIONES POR LOCALIDAD:&lt;/p&gt;
&lt;p&gt;TOTAL DE COMISIONES POR DEPARTAMENTO:
SELECT DNAME, NVL(SUM(COMM),0) FROM EMP, DEPT WHERE EMP.DEPTNO=DEPT.DEPTNO AND DEPT.DEPTNO=20 GROUP BY DNAME;&lt;/p&gt;
&lt;p&gt;TOTAL DE COMISIONES DE EMPLEADOS:
SELECT ENAME, NVL(COMM,0) AS COMISION FROM EMP WHERE DEPTNO=30 ORDER BY ENAME ASC;&lt;/p&gt;
&lt;pre class=&quot;language-plsql&quot;&gt;&lt;code class=&quot;language-plsql&quot;&gt;&lt;span class=&quot;token comment&quot;&gt;--TERMINAR&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token keyword&quot;&gt;CREATE&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;OR&lt;/span&gt; REPLACE &lt;span class=&quot;token keyword&quot;&gt;PROCEDURE&lt;/span&gt; LISTAR_COMISIONES&lt;br /&gt;&lt;span class=&quot;token keyword&quot;&gt;IS&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token keyword&quot;&gt;BEGIN&lt;/span&gt;&lt;br /&gt;  LISTAR_DEPARTAMENTOS&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  LISTAR_LOCALIDAD&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  LISTAR_COMISION&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token keyword&quot;&gt;END&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;&lt;span class=&quot;token keyword&quot;&gt;CREATE&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;OR&lt;/span&gt; REPLACE &lt;span class=&quot;token keyword&quot;&gt;PROCEDURE&lt;/span&gt; LISTAR_DEPARTAMENTOS &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;P_DEPTNO &lt;span class=&quot;token keyword&quot;&gt;OUT&lt;/span&gt; DEPT&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;DEPTNO&lt;span class=&quot;token operator&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;TYPE&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token keyword&quot;&gt;IS&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;CURSOR&lt;/span&gt; C_DEPT &lt;span class=&quot;token keyword&quot;&gt;IS&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;SELECT&lt;/span&gt; DNAME&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; DEPTNO &lt;span class=&quot;token keyword&quot;&gt;FROM&lt;/span&gt; DEPT&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;ORDER&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;BY&lt;/span&gt; LOC &lt;span class=&quot;token keyword&quot;&gt;ASC&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token keyword&quot;&gt;BEGIN&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;FOR&lt;/span&gt; R_DEPT &lt;span class=&quot;token keyword&quot;&gt;IN&lt;/span&gt; C_DEPT &lt;span class=&quot;token keyword&quot;&gt;LOOP&lt;/span&gt;&lt;br /&gt;    DBMS_OUTPUT&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;PUT_LINE&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;DEPARTAMENTO: &#39;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;||&lt;/span&gt;R_DEPT&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;DNAME&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;    P_DEPTNO&lt;span class=&quot;token operator&quot;&gt;:=&lt;/span&gt;R_DEPT&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;DEPTNO&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;    LISTAR_LOCALIDAD&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;P_DEPTNO&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;END&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;LOOP&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token keyword&quot;&gt;END&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;&lt;span class=&quot;token keyword&quot;&gt;CREATE&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;OR&lt;/span&gt; REPLACE &lt;span class=&quot;token keyword&quot;&gt;PROCEDURE&lt;/span&gt; LISTAR_LOCALIDAD &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;P_DEPTNO DEPT&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;DEPTNO&lt;span class=&quot;token operator&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;TYPE&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token keyword&quot;&gt;IS&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;CURSOR&lt;/span&gt; C_LOC &lt;span class=&quot;token keyword&quot;&gt;IS&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;SELECT&lt;/span&gt; LOC &lt;span class=&quot;token keyword&quot;&gt;FROM&lt;/span&gt; DEPT&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;ORDER&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;BY&lt;/span&gt; LOC &lt;span class=&quot;token keyword&quot;&gt;ASC&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token keyword&quot;&gt;BEGIN&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;FOR&lt;/span&gt; R_LOC &lt;span class=&quot;token keyword&quot;&gt;IN&lt;/span&gt; C_LOC &lt;span class=&quot;token keyword&quot;&gt;LOOP&lt;/span&gt;&lt;br /&gt;    DBMS_OUTPUT&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;PUT_LINE&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;LOCALIDAD: &#39;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;||&lt;/span&gt;R_LOC&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;LOC&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;    LISTAR_COMISION&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;P_DEPTNO&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;END&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;LOOP&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token keyword&quot;&gt;END&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;&lt;span class=&quot;token keyword&quot;&gt;CREATE&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;OR&lt;/span&gt; REPLACE &lt;span class=&quot;token keyword&quot;&gt;PROCEDURE&lt;/span&gt; LISTAR_COMISION &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;P_DEPTNO DEPT&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;DEPTNO&lt;span class=&quot;token operator&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;TYPE&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token keyword&quot;&gt;IS&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;CURSOR&lt;/span&gt; C_COMM &lt;span class=&quot;token keyword&quot;&gt;IS&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;SELECT&lt;/span&gt; ENAME&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; NVL&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;COMM&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;AS&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&quot;COMISION&quot;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;FROM&lt;/span&gt; EMP &lt;span class=&quot;token keyword&quot;&gt;WHERE&lt;/span&gt; DEPTNO&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;P_DEPTNO&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;ORDER&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;BY&lt;/span&gt; ENAME &lt;span class=&quot;token keyword&quot;&gt;ASC&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token keyword&quot;&gt;BEGIN&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;FOR&lt;/span&gt; R_COMM &lt;span class=&quot;token keyword&quot;&gt;IN&lt;/span&gt; C_COMM &lt;span class=&quot;token keyword&quot;&gt;LOOP&lt;/span&gt;&lt;br /&gt;    DBMS_OUTPUT&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;PUT_LINE&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;CHR&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;9&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;||&lt;/span&gt;R_COMM&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;ENAME&lt;span class=&quot;token operator&quot;&gt;||&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39; ------------- &#39;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;||&lt;/span&gt;R_COMM&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;COMISION&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;END&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;LOOP&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token keyword&quot;&gt;END&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Nota: Los nombres de localidades, departamentos y empleados deben aparecer por orden alfabético.&lt;/p&gt;
&lt;p&gt;Si alguno de los departamentos no tiene ningún empleado con comisiones, aparecerá un mensaje informando de ello en lugar de la lista de empleados.&lt;/p&gt;
&lt;p&gt;El procedimiento debe gestionar adecuadamente las siguientes excepciones:&lt;/p&gt;
&lt;pre&gt;&lt;code&gt;a) La tabla Empleados está vacía.
b) Alguna comisión es mayor que 10000.
&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&quot;realiza-un-procedimiento-que-reciba-el-nombre-de-una-tabla-y-muestre-los-nombres-de-las-restricciones-que-tiene%2C-a-qu%C3%A9-columna-afectan-y-en-qu%C3%A9-consisten-exactamente.-(dba_tables%2C-dba_constraints%2C-dba_cons_columns)&quot; tabindex=&quot;-1&quot;&gt;Realiza un procedimiento que reciba el nombre de una tabla y muestre los nombres de las restricciones que tiene, a qué columna afectan y en qué consisten exactamente. (DBA_TABLES, DBA_CONSTRAINTS, DBA_CONS_COLUMNS)&lt;/h3&gt;
&lt;pre class=&quot;language-plsql&quot;&gt;&lt;code class=&quot;language-plsql&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;CREATE&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;OR&lt;/span&gt; REPLACE &lt;span class=&quot;token keyword&quot;&gt;PROCEDURE&lt;/span&gt; MUESTRA_NOMBRE_RESTRICCIONES &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;P_TABLA VARCHAR2&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token keyword&quot;&gt;IS&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;CURSOR&lt;/span&gt; C_NOMBRE &lt;span class=&quot;token keyword&quot;&gt;IS&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;SELECT&lt;/span&gt; CONSTRAINT_NAME &lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;FROM&lt;/span&gt; DBA_CONSTRAINTS &lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;WHERE&lt;/span&gt; TABLE_NAME&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;P_TABLA&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  V_COLUMNA VARCHAR2&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;100&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  V_TIPO_CONSTRAINT VARCHAR2&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token keyword&quot;&gt;BEGIN&lt;/span&gt;&lt;br /&gt;  DBMS_OUTPUT&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;PUT_LINE&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;El nombre de la tabla es: &#39;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;||&lt;/span&gt;P_TABLA&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;FOR&lt;/span&gt; R_CONST &lt;span class=&quot;token keyword&quot;&gt;IN&lt;/span&gt; C_NOMBRE&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;LOOP&lt;/span&gt;&lt;br /&gt;    DBMS_OUTPUT&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;PUT_LINE&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;El nombre de la restriccion es: &#39;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;||&lt;/span&gt;R_CONST&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;CONSTRAINT_NAME&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token keyword&quot;&gt;SELECT&lt;/span&gt; COLUMN_NAME &lt;span class=&quot;token keyword&quot;&gt;INTO&lt;/span&gt; V_COLUMNA &lt;span class=&quot;token keyword&quot;&gt;FROM&lt;/span&gt; DBA_CONS_COLUMNS &lt;span class=&quot;token keyword&quot;&gt;WHERE&lt;/span&gt; TABLE_NAME&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;P_TABLA &lt;span class=&quot;token keyword&quot;&gt;AND&lt;/span&gt; CONSTRAINT_NAME&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;R_CONST&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;CONSTRAINT_NAME&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;    DBMS_OUTPUT&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;PUT_LINE&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;La columna a la que afecta la restriccion es: &#39;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;||&lt;/span&gt;V_COLUMNA&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token keyword&quot;&gt;SELECT&lt;/span&gt; CONSTRAINT_TYPE &lt;span class=&quot;token keyword&quot;&gt;INTO&lt;/span&gt; V_TIPO_CONSTRAINT &lt;span class=&quot;token keyword&quot;&gt;FROM&lt;/span&gt; DBA_CONSTRAINTS &lt;span class=&quot;token keyword&quot;&gt;WHERE&lt;/span&gt; TABLE_NAME&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;P_TABLA &lt;span class=&quot;token keyword&quot;&gt;AND&lt;/span&gt; CONSTRAINT_NAME&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;R_CONST&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;CONSTRAINT_NAME&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;    EXPLICA_CONSTRAINT&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;V_TIPO_CONSTRAINT&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;END&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;LOOP&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token keyword&quot;&gt;END&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;&lt;span class=&quot;token keyword&quot;&gt;CREATE&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;OR&lt;/span&gt; REPLACE &lt;span class=&quot;token keyword&quot;&gt;PROCEDURE&lt;/span&gt; EXPLICA_CONSTRAINT &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;P_TIPO_CONSTRAINT VARCHAR2&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token keyword&quot;&gt;IS&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;&lt;span class=&quot;token keyword&quot;&gt;BEGIN&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;CASE&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token keyword&quot;&gt;WHEN&lt;/span&gt; P_TIPO_CONSTRAINT &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;P&#39;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;THEN&lt;/span&gt;&lt;br /&gt;      DBMS_OUTPUT&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;PUT_LINE&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;La restriccion es una clave primaria.&#39;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;||&lt;/span&gt;CHR&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token keyword&quot;&gt;WHEN&lt;/span&gt; P_TIPO_CONSTRAINT &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;C&#39;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;THEN&lt;/span&gt;&lt;br /&gt;      DBMS_OUTPUT&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;PUT_LINE&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;La restriccion es tipo CHECK y lo que hace es validar.&#39;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;||&lt;/span&gt;CHR&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token keyword&quot;&gt;WHEN&lt;/span&gt; P_TIPO_CONSTRAINT &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token string&quot;&gt;&#39;R&#39;&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;THEN&lt;/span&gt;&lt;br /&gt;      DBMS_OUTPUT&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;PUT_LINE&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;La restriccion es una clave foranea o ajena.&#39;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;||&lt;/span&gt;CHR&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;10&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;  &lt;span class=&quot;token keyword&quot;&gt;END&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;CASE&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token keyword&quot;&gt;END&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&quot;https://reeseschultz.github.io/img/BD-P3.9.png&quot; alt=&quot;BD-P3.9.png&quot; /&gt;&lt;/p&gt;
&lt;h3 id=&quot;realiza-al-menos-dos-de-los-ejercicios-anteriores-en-postgres-usando-pl%2Fpgsql.&quot; tabindex=&quot;-1&quot;&gt;Realiza al menos dos de los ejercicios anteriores en Postgres usando PL/pgSQL.&lt;/h3&gt;
&lt;h4 id=&quot;primer-ejercicio&quot; tabindex=&quot;-1&quot;&gt;Primer ejercicio&lt;/h4&gt;
&lt;pre class=&quot;language-plsql&quot;&gt;&lt;code class=&quot;language-plsql&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;CREATE&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;OR&lt;/span&gt; REPLACE &lt;span class=&quot;token keyword&quot;&gt;PROCEDURE&lt;/span&gt; MUESTRANOMBREYSALARIO&lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token keyword&quot;&gt;AS&lt;/span&gt; $$&lt;br /&gt;&lt;span class=&quot;token keyword&quot;&gt;DECLARE&lt;/span&gt;&lt;br /&gt;    V_ENAME EMP&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;ENAME&lt;span class=&quot;token operator&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;TYPE&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;    V_SAL EMP&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;SAL&lt;span class=&quot;token operator&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;TYPE&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token keyword&quot;&gt;BEGIN&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token keyword&quot;&gt;SELECT&lt;/span&gt; ENAME&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; SAL &lt;span class=&quot;token keyword&quot;&gt;INTO&lt;/span&gt; V_ENAME&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt; V_SAL&lt;br /&gt;    &lt;span class=&quot;token keyword&quot;&gt;FROM&lt;/span&gt; EMP &lt;span class=&quot;token keyword&quot;&gt;WHERE&lt;/span&gt; EMPNO &lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt; &lt;span class=&quot;token number&quot;&gt;7782&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;    &lt;br /&gt;    &lt;span class=&quot;token keyword&quot;&gt;RAISE&lt;/span&gt; NOTICE &lt;span class=&quot;token string&quot;&gt;&#39;%&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;Nombre: &#39;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;||&lt;/span&gt; v_ename&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token keyword&quot;&gt;RAISE&lt;/span&gt; NOTICE &lt;span class=&quot;token string&quot;&gt;&#39;%&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;Salario: &#39;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;||&lt;/span&gt; v_sal&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token keyword&quot;&gt;END&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;$$ &lt;span class=&quot;token keyword&quot;&gt;LANGUAGE&lt;/span&gt; plpgsql&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&quot;https://reeseschultz.github.io/img/BD-P3.10.png&quot; alt=&quot;BD-P3.10.png&quot; /&gt;&lt;/p&gt;
&lt;h4 id=&quot;segundo-ejercicio&quot; tabindex=&quot;-1&quot;&gt;Segundo ejercicio&lt;/h4&gt;
&lt;pre class=&quot;language-plsql&quot;&gt;&lt;code class=&quot;language-plsql&quot;&gt;&lt;span class=&quot;token keyword&quot;&gt;CREATE&lt;/span&gt; &lt;span class=&quot;token keyword&quot;&gt;OR&lt;/span&gt; REPLACE &lt;span class=&quot;token keyword&quot;&gt;PROCEDURE&lt;/span&gt; MUESTRA_NOMBRE &lt;span class=&quot;token punctuation&quot;&gt;(&lt;/span&gt;P_EMPNO EMP&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;EMPNO&lt;span class=&quot;token operator&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;TYPE&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;)&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token keyword&quot;&gt;AS&lt;/span&gt; $$&lt;br /&gt;&lt;span class=&quot;token keyword&quot;&gt;DECLARE&lt;/span&gt;&lt;br /&gt;    V_NOMBRE EMP&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;ENAME&lt;span class=&quot;token operator&quot;&gt;%&lt;/span&gt;&lt;span class=&quot;token keyword&quot;&gt;TYPE&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token keyword&quot;&gt;BEGIN&lt;/span&gt;&lt;br /&gt;    &lt;span class=&quot;token keyword&quot;&gt;SELECT&lt;/span&gt; ENAME &lt;span class=&quot;token keyword&quot;&gt;INTO&lt;/span&gt; V_NOMBRE &lt;br /&gt;    &lt;span class=&quot;token keyword&quot;&gt;FROM&lt;/span&gt; EMP &lt;span class=&quot;token keyword&quot;&gt;WHERE&lt;/span&gt; EMPNO&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;P_EMPNO&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;br /&gt;    &lt;span class=&quot;token keyword&quot;&gt;RAISE&lt;/span&gt; NOTICE &lt;span class=&quot;token string&quot;&gt;&#39;%&#39;&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;,&lt;/span&gt;&lt;span class=&quot;token string&quot;&gt;&#39;Nombre: &#39;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;||&lt;/span&gt; V_NOMBRE&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token keyword&quot;&gt;END&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;br /&gt;$$ &lt;span class=&quot;token keyword&quot;&gt;LANGUAGE&lt;/span&gt; plpgsql&lt;span class=&quot;token punctuation&quot;&gt;;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&quot;https://reeseschultz.github.io/img/BD-P3.11.png&quot; alt=&quot;BD-P3.11.png&quot; /&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;h2 id=&quot;documento-realizado-por%3A&quot; tabindex=&quot;-1&quot;&gt;&lt;strong&gt;Documento realizado por:&lt;/strong&gt;&lt;/h2&gt;
&lt;p&gt;✒️ &lt;strong&gt;Alejandro Montes Delgado&lt;/strong&gt; - &lt;em&gt;2º ASIR&lt;/em&gt;&lt;/p&gt;
</content>
	</entry>
	
	<entry>
		<title>Cifrado asimétrico con gpg y openssl.</title>
		<link href="https://reeseschultz.github.io/post/cifrado-asimetrico-con-gpg-y-openssl./"/>
		<updated>2022-12-02T00:00:00Z</updated>
		<id>https://reeseschultz.github.io/post/cifrado-asimetrico-con-gpg-y-openssl./</id>
		<content type="html">&lt;h3 id=&quot;tarea-1%3A-generaci%C3%B3n-de-claves&quot; tabindex=&quot;-1&quot;&gt;Tarea 1: Generación de claves&lt;/h3&gt;
&lt;h4 id=&quot;genera-un-par-de-claves-(p%C3%BAblica-y-privada).-%C2%BFen-que-directorio-se-guarda-las-claves-de-un-usuario%3F&quot; tabindex=&quot;-1&quot;&gt;Genera un par de claves (pública y privada). ¿En que directorio se guarda las claves de un usuario?&lt;/h4&gt;
&lt;p&gt;Para generar un par de claves, usaremos el siguiente comando.&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;$ gpg --gen-key&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&quot;https://reeseschultz.github.io/img/SAD-P3.1.png&quot; alt=&quot;SAD-P3.1.png&quot; /&gt;&lt;/p&gt;
&lt;p&gt;Las claves públicas y privadas se guardan en &lt;code&gt;~/.gnupg&lt;/code&gt;&lt;/p&gt;
&lt;h4 id=&quot;lista-las-claves-p%C3%BAblicas-que-tienes-en-tu-almac%C3%A9n-de-claves.-explica-los-distintos-datos-que-nos-muestra.-%C2%BFc%C3%B3mo-deber%C3%ADas-haber-generado-las-claves-para-indicar%2C-por-ejemplo%2C-que-tenga-un-1-mes-de-validez%3F&quot; tabindex=&quot;-1&quot;&gt;Lista las claves públicas que tienes en tu almacén de claves. Explica los distintos datos que nos muestra. ¿Cómo deberías haber generado las claves para indicar, por ejemplo, que tenga un 1 mes de validez?&lt;/h4&gt;
&lt;p&gt;El comando usado para listar las claves es:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;$ gpg --list-keys&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&quot;https://reeseschultz.github.io/img/SAD-P3.2.png&quot; alt=&quot;SAD-P3.2.png&quot; /&gt;&lt;/p&gt;
&lt;p&gt;Para indicar el tiempo de validez al crear el par de claves, usamos el comando:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;$ gpg --full-gen-key&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&quot;https://reeseschultz.github.io/img/SAD-P3.4.png&quot; alt=&quot;SAD-P3.4.png&quot; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://reeseschultz.github.io/img/SAD-P3.5.png&quot; alt=&quot;SAD-P3.5.png&quot; /&gt;&lt;/p&gt;
&lt;h4 id=&quot;lista-las-claves-privadas-de-tu-almac%C3%A9n-de-claves.&quot; tabindex=&quot;-1&quot;&gt;Lista las claves privadas de tu almacén de claves.&lt;/h4&gt;
&lt;p&gt;El comando usado para listar las claves privadas es:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;$ gpg --list-secret-keys&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&quot;https://reeseschultz.github.io/img/SAD-P3.3.png&quot; alt=&quot;SAD-P3.3.png&quot; /&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;h3 id=&quot;tarea-2%3A-importar-%2F-exportar-clave-p%C3%BAblica&quot; tabindex=&quot;-1&quot;&gt;Tarea 2: Importar / exportar clave pública&lt;/h3&gt;
&lt;h4 id=&quot;exporta-tu-clave-p%C3%BAblica-en-formato-ascii-y-guardalo-en-un-archivo-nombre_apellido.asc-y-env%C3%ADalo-al-compa%C3%B1ero-con-el-que-vas-a-hacer-esta-pr%C3%A1ctica.&quot; tabindex=&quot;-1&quot;&gt;Exporta tu clave pública en formato ASCII y guardalo en un archivo nombre_apellido.asc y envíalo al compañero con el que vas a hacer esta práctica.&lt;/h4&gt;
&lt;p&gt;El comando para generar el archivo con la clave pública en formato ASCII es el siguiente:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;$ gpg --armor --output alejandro_montes.asc --export aaleemd11@gmail.com&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Le he enviado mi clave pública a mi compañero Juan Jesús.&lt;/p&gt;
&lt;h4 id=&quot;importa-las-claves-p%C3%BAblicas-recibidas-de-vuestro-compa%C3%B1ero.&quot; tabindex=&quot;-1&quot;&gt;Importa las claves públicas recibidas de vuestro compañero.&lt;/h4&gt;
&lt;p&gt;El comando para importar la clave pública de Juan Jesús es el siguiente:&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://reeseschultz.github.io/img/SAD-P3.6.png&quot; alt=&quot;SAD-P3.6.png&quot; /&gt;&lt;/p&gt;
&lt;h4 id=&quot;comprueba-que-las-claves-se-han-incluido-correctamente-en-vuestro-keyring.&quot; tabindex=&quot;-1&quot;&gt;Comprueba que las claves se han incluido correctamente en vuestro keyring.&lt;/h4&gt;
&lt;p&gt;Muestro mi anillo de claves y se ve que la clave de Juan Jesús está importada correctamente:&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://reeseschultz.github.io/img/SAD-P3.8.png&quot; alt=&quot;SAD-P3.8.png&quot; /&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;h3 id=&quot;tarea-3%3A-cifrado-asim%C3%A9trico-con-claves-p%C3%BAblicas&quot; tabindex=&quot;-1&quot;&gt;Tarea 3: Cifrado asimétrico con claves públicas&lt;/h3&gt;
&lt;h4 id=&quot;cifraremos-un-archivo-cualquiera-y-lo-remitiremos-por-email-a-uno-de-nuestros-compa%C3%B1eros-que-nos-proporcion%C3%B3-su-clave-p%C3%BAblica.&quot; tabindex=&quot;-1&quot;&gt;Cifraremos un archivo cualquiera y lo remitiremos por email a uno de nuestros compañeros que nos proporcionó su clave pública.&lt;/h4&gt;
&lt;p&gt;Ciframos un archivo de ejemplo y se lo envío a Iván.&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;gpg --encrypt --recipient githubemail1asir@gmail.com para_juanjesus.txt&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&quot;nuestro-compa%C3%B1ero%2C-a-su-vez%2C-nos-remitir%C3%A1-un-archivo-cifrado-para-que-nosotros-lo-descifremos.&quot; tabindex=&quot;-1&quot;&gt;Nuestro compañero, a su vez, nos remitirá un archivo cifrado para que nosotros lo descifremos.&lt;/h4&gt;
&lt;p&gt;El comando usado para desifrar el archivo que nos ha enviado nuestro compañero es el siguiente:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;gpg --decrypt criptoarchivo.txt.gpg&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&quot;https://reeseschultz.github.io/img/SAD-P3.9.png&quot; alt=&quot;SAD-P3.9.png&quot; /&gt;&lt;/p&gt;
&lt;h4 id=&quot;tanto-nosotros-como-nuestro-compa%C3%B1ero-comprobaremos-que-hemos-podido-descifrar-los-mensajes-recibidos-respectivamente.&quot; tabindex=&quot;-1&quot;&gt;Tanto nosotros como nuestro compañero comprobaremos que hemos podido descifrar los mensajes recibidos respectivamente.&lt;/h4&gt;
&lt;p&gt;Nuestro compañero también ha descifrado el archivo correctamente.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://reeseschultz.github.io/img/SAD-P3.10.png&quot; alt=&quot;SAD-P3.10.png&quot; /&gt;&lt;/p&gt;
&lt;h4 id=&quot;por-%C3%BAltimo%2C-enviaremos-el-documento-cifrado-a-alguien-que-no-estaba-en-la-lista-de-destinatarios-y-comprobaremos-que-este-usuario-no-podr%C3%A1-descifrar-este-archivo.&quot; tabindex=&quot;-1&quot;&gt;Por último, enviaremos el documento cifrado a alguien que no estaba en la lista de destinatarios y comprobaremos que este usuario no podrá descifrar este archivo.&lt;/h4&gt;
&lt;p&gt;No tengo captura pero lo he probado y mi compañero no podía visualizar el contenido ni desencriptarlo.&lt;/p&gt;
&lt;h4 id=&quot;para-terminar%2C-indica-los-comandos-necesarios-para-borrar-las-claves-p%C3%BAblicas-y-privadas-que-posees.&quot; tabindex=&quot;-1&quot;&gt;Para terminar, indica los comandos necesarios para borrar las claves públicas y privadas que posees.&lt;/h4&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;gpg --delete-secret-key &quot;Alejandro Montes Delgado&quot;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&quot;https://reeseschultz.github.io/img/SAD-P3.11.png&quot; alt=&quot;SAD-P3.11.png&quot; /&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;h3 id=&quot;tarea-4%3A-exportar-clave-a-un-servidor-p%C3%BAblico-de-claves-pgp&quot; tabindex=&quot;-1&quot;&gt;Tarea 4: Exportar clave a un servidor público de claves PGP&lt;/h3&gt;
&lt;h4 id=&quot;genera-la-clave-de-revocaci%C3%B3n-de-tu-clave-p%C3%BAblica-para-utilizarla-en-caso-de-que-haya-problemas.&quot; tabindex=&quot;-1&quot;&gt;Genera la clave de revocación de tu clave pública para utilizarla en caso de que haya problemas.&lt;/h4&gt;
&lt;p&gt;Para crear una  clave de rovación usamos el siguiente comando:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;gpg --gen-revoke 0549F57086A3E680F1DD7F7DB99701ED0FAD4CEF&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&quot;https://reeseschultz.github.io/img/SAD-P3.12.png&quot; alt=&quot;SAD-P3.12.png&quot; /&gt;&lt;/p&gt;
&lt;h4 id=&quot;exporta-tu-clave-p%C3%BAblica-al-servidor-pgp.rediris.es&quot; tabindex=&quot;-1&quot;&gt;Exporta tu clave pública al servidor &lt;a href=&quot;http://pgp.rediris.es/&quot;&gt;pgp.rediris.es&lt;/a&gt;&lt;/h4&gt;
&lt;p&gt;He usado otro servidor de claves públicas debido a que rediris está caido.&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;gpg --keyserver pgp.mit.edu --send-keys 0549F57086A3E680F1DD7F7DB99701ED0FAD4CEF&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&quot;https://reeseschultz.github.io/img/SAD-P3.13.png&quot; alt=&quot;SAD-P3.13.png&quot; /&gt;&lt;/p&gt;
&lt;p&gt;Como podemos ver se ha subido correctamente.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://reeseschultz.github.io/img/SAD-P3.14.png&quot; alt=&quot;SAD-P3.14.png&quot; /&gt;&lt;/p&gt;
&lt;h4 id=&quot;borra-la-clave-p%C3%BAblica-de-alguno-de-tus-compa%C3%B1eros-de-clase-e-imp%C3%B3rtala-ahora-del-servidor-p%C3%BAblico-de-rediris.&quot; tabindex=&quot;-1&quot;&gt;Borra la clave pública de alguno de tus compañeros de clase e impórtala ahora del servidor público de rediris.&lt;/h4&gt;
&lt;p&gt;Borro la clave pública de mi compañero:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;gpg --delete-key &quot;Juan Jesus&quot;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Para importar la clave de Juan Jesús usamos el siguiente comando:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;gpg --keyserver pgp.rediris.es --recv-keys 63DE4D1C7A7D69E8BB02F2F60D9A9FF1B5EE9093&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Da error pero porque no funciona correctamente rediris.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://reeseschultz.github.io/img/SAD-P3.15.png&quot; alt=&quot;SAD-P3.15.png&quot; /&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;h3 id=&quot;tarea-5%3A-cifrado-asim%C3%A9trico-con-openssl&quot; tabindex=&quot;-1&quot;&gt;Tarea 5: Cifrado asimétrico con openssl&lt;/h3&gt;
&lt;h4 id=&quot;genera-un-par-de-claves-(p%C3%BAblica-y-privada).&quot; tabindex=&quot;-1&quot;&gt;Genera un par de claves (pública y privada).&lt;/h4&gt;
&lt;p&gt;Para generar el par de claves, uso el siguiente comando:&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://reeseschultz.github.io/img/SAD-P3.16.png&quot; alt=&quot;SAD-P3.16.png&quot; /&gt;&lt;/p&gt;
&lt;p&gt;Extraemos la clave pública y la insertamos en un fichero con el siguiente comando:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;openssl rsa -in alejandro-montes-ssl.pem -pubout &gt; alejandro-montes-ssl.pub.pem&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&quot;https://reeseschultz.github.io/img/SAD-P3.17.png&quot; alt=&quot;SAD-P3.17.png&quot; /&gt;&lt;/p&gt;
&lt;h4 id=&quot;env%C3%ADa-tu-clave-p%C3%BAblica-a-un-compa%C3%B1ero.&quot; tabindex=&quot;-1&quot;&gt;Envía tu clave pública a un compañero.&lt;/h4&gt;
&lt;p&gt;Le he enviado mi clave a Juanje y él me ha enviado la suya.&lt;/p&gt;
&lt;h4 id=&quot;utilizando-la-clave-p%C3%BAblica-cifra-un-fichero-de-texto-y-env%C3%ADalo-a-tu-compa%C3%B1ero.&quot; tabindex=&quot;-1&quot;&gt;Utilizando la clave pública cifra un fichero de texto y envíalo a tu compañero.&lt;/h4&gt;
&lt;p&gt;Este es el fichero que yo he cifrado:&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://reeseschultz.github.io/img/SAD-P3.18.png&quot; alt=&quot;SAD-P3.18.png&quot; /&gt;&lt;/p&gt;
&lt;p&gt;Este es el fichero que ha encriptado Juanje&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://reeseschultz.github.io/img/SAD-P3.19.png&quot; alt=&quot;SAD-P3.19.png&quot; /&gt;&lt;/p&gt;
&lt;h4 id=&quot;tu-compa%C3%B1ero-te-ha-mandado-un-fichero-cifrado%2C-muestra-el-proceso-para-el-descifrado.&quot; tabindex=&quot;-1&quot;&gt;Tu compañero te ha mandado un fichero cifrado, muestra el proceso para el descifrado.&lt;/h4&gt;
&lt;p&gt;Para descifrarlo usamos el siguiente comando:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;openssl rsautl -decrypt -inkey alejandro-montes-ssl.pem -in criptoarchivossl.txt.enc -out criptoarchivossl.txt&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&quot;https://reeseschultz.github.io/img/SAD-P3.20.png&quot; alt=&quot;SAD-P3.20.png&quot; /&gt;&lt;/p&gt;
&lt;p&gt;Mi compañero Juanje también ha descifrado el mío correctamente.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://reeseschultz.github.io/img/SAD-P3.21.png&quot; alt=&quot;SAD-P3.21.png&quot; /&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;h2 id=&quot;documento-realizado-por%3A&quot; tabindex=&quot;-1&quot;&gt;&lt;strong&gt;Documento realizado por:&lt;/strong&gt;&lt;/h2&gt;
&lt;p&gt;✒️ &lt;strong&gt;Alejandro Montes Delgado&lt;/strong&gt; - &lt;em&gt;2º ASIR&lt;/em&gt;&lt;/p&gt;
</content>
	</entry>
	
	<entry>
		<title>Migración de Aplicaciones Web al VPS</title>
		<link href="https://reeseschultz.github.io/post/migracion-de-aplicaciones-web-al-vps/"/>
		<updated>2022-11-24T00:00:00Z</updated>
		<id>https://reeseschultz.github.io/post/migracion-de-aplicaciones-web-al-vps/</id>
		<content type="html">&lt;h3 id=&quot;glpi&quot; tabindex=&quot;-1&quot;&gt;GLPI&lt;/h3&gt;
&lt;p&gt;La primera aplicación web que migraremos será glpi, a continuación detallo los pasos que he seguido para migrarla.&lt;/p&gt;
&lt;h4 id=&quot;creaci%C3%B3n-del-virtual-host.&quot; tabindex=&quot;-1&quot;&gt;Creación del virtual Host.&lt;/h4&gt;
&lt;p&gt;El primer paso que he dado para realizar la migración es configurar un virtualhost en mi vps. Muestro la configuración del virtual host:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;upstream php-handler {&lt;br /&gt;    #server 127.0.0.1:9000;&lt;br /&gt;    server unix:/var/run/php/php7.4-fpm.sock;&lt;br /&gt;}&lt;br /&gt;&lt;br /&gt;map $arg_v $asset_immutable {&lt;br /&gt;    &quot;&quot; &quot;&quot;;&lt;br /&gt;    default &quot;immutable&quot;;&lt;br /&gt;}&lt;br /&gt;&lt;br /&gt;server {&lt;br /&gt;    listen 80;&lt;br /&gt;    listen [::]:80;&lt;br /&gt;    server_name www.alejandro-montes.es;&lt;br /&gt;    rewrite ^/$ /portal;&lt;br /&gt;    root /var/www/alejandromontes;&lt;br /&gt;&lt;br /&gt;    location = /robots.txt {&lt;br /&gt;        allow all;&lt;br /&gt;        log_not_found off;&lt;br /&gt;        access_log off;&lt;br /&gt;    }&lt;br /&gt;&lt;br /&gt;    location ^~ /.well-known {&lt;br /&gt;&lt;br /&gt;        location = /.well-known/carddav { return 301 /cloud/remote.php/dav/; }&lt;br /&gt;        location = /.well-known/caldav  { return 301 /cloud/remote.php/dav/; }&lt;br /&gt;&lt;br /&gt;        location /.well-known/acme-challenge    { try_files $uri $uri/ =404; }&lt;br /&gt;        location /.well-known/pki-validation    { try_files $uri $uri/ =404; }&lt;br /&gt;&lt;br /&gt;        return 301 /cloud/index.php$request_uri;&lt;br /&gt;    }&lt;br /&gt;    location ^~ /portal {&lt;br /&gt;        client_max_body_size 512M;&lt;br /&gt;        client_body_timeout 300s;&lt;br /&gt;        fastcgi_buffers 64 4K;&lt;br /&gt;&lt;br /&gt;        gzip on;&lt;br /&gt;        gzip_vary on;&lt;br /&gt;        gzip_comp_level 4;&lt;br /&gt;        gzip_min_length 256;&lt;br /&gt;        gzip_proxied expired no-cache no-store private no_last_modified no_etag auth;&lt;br /&gt;        gzip_types application/atom+xml application/javascript application/json application/ld+json application/manifest+json application/rss+xml appl&lt;br /&gt;ication/vnd.geo+json application/vnd.ms-fontobject application/wasm application/x-font-ttf application/x-web-app-manifest+json application/xhtml+xml a&lt;br /&gt;pplication/xml font/opentype image/bmp image/svg+xml image/x-icon text/cache-manifest text/css text/plain text/vcard text/vnd.rim.location.xloc text/v&lt;br /&gt;tt text/x-component text/x-cross-domain-policy;&lt;br /&gt;&lt;br /&gt;        client_body_buffer_size 512k;&lt;br /&gt;        add_header Referrer-Policy                      &quot;no-referrer&quot;   always;&lt;br /&gt;        add_header X-Content-Type-Options               &quot;nosniff&quot;       always;&lt;br /&gt;        add_header X-Download-Options                   &quot;noopen&quot;        always;&lt;br /&gt;        add_header X-Frame-Options                      &quot;SAMEORIGIN&quot;    always;&lt;br /&gt;        add_header X-Permitted-Cross-Domain-Policies    &quot;none&quot;          always;&lt;br /&gt;        add_header X-Robots-Tag                         &quot;none&quot;          always;&lt;br /&gt;        add_header X-XSS-Protection                     &quot;1; mode=block&quot; always;&lt;br /&gt;&lt;br /&gt;        fastcgi_hide_header X-Powered-By;&lt;br /&gt;&lt;br /&gt;        index index.php index.html /portal/index.php$request_uri;&lt;br /&gt;&lt;br /&gt;        location ~ \.php(?:$|/) {&lt;br /&gt;&lt;br /&gt;            fastcgi_split_path_info ^(.+?\.php)(/.*)$;&lt;br /&gt;            set $path_info $fastcgi_path_info;&lt;br /&gt;&lt;br /&gt;            try_files $fastcgi_script_name =404;&lt;br /&gt;&lt;br /&gt;            include fastcgi_params;&lt;br /&gt;            fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;&lt;br /&gt;            fastcgi_param PATH_INFO $path_info;&lt;br /&gt;&lt;br /&gt;            fastcgi_param modHeadersAvailable true;         # Avoid sending the security headers twice&lt;br /&gt;            fastcgi_param front_controller_ac8tive true;     # Enable pretty urls&lt;br /&gt;            fastcgi_pass php-handler;&lt;br /&gt;&lt;br /&gt;            fastcgi_intercept_errors on;&lt;br /&gt;            fastcgi_request_buffering off;&lt;br /&gt;&lt;br /&gt;            fastcgi_max_temp_file_size 0;&lt;br /&gt;        }&lt;br /&gt;&lt;br /&gt;        location /portal {&lt;br /&gt;            try_files $uri $uri/ /portal/index.php$request_uri;&lt;br /&gt;        }&lt;br /&gt;    }&lt;br /&gt;    location ~ /\.ht {&lt;br /&gt;          deny all;&lt;br /&gt;         }&lt;br /&gt;&lt;br /&gt;    location ^~ /cloud {&lt;br /&gt;        client_max_body_size 513M;&lt;br /&gt;        client_body_timeout 300s;&lt;br /&gt;        fastcgi_buffers 64 4K;&lt;br /&gt;        gzip on;&lt;br /&gt;        gzip_vary on;&lt;br /&gt;        gzip_vary on;&lt;br /&gt;        gzip_comp_level 4;&lt;br /&gt;        gzip_min_length 256;&lt;br /&gt;        gzip_proxied expired no-cache no-store private no_last_modified no_etag auth;&lt;br /&gt;        gzip_types application/atom+xml application/javascript application/json application/ld+json application/manifest+json application/rss+xml appl&lt;br /&gt;ication/vnd.geo+json application/vnd.ms-fontobject application/wasm application/x-font-ttf application/x-web-app-manifest+json application/xhtml+xml a&lt;br /&gt;pplication/xml font/opentype image/bmp image/svg+xml image/x-icon text/cache-manifest text/css text/plain text/vcard text/vnd.rim.location.xloc text/v&lt;br /&gt;tt text/x-component text/x-cross-domain-policy;&lt;br /&gt;        add_header Referrer-Policy                      &quot;no-referrer&quot;   always;&lt;br /&gt;        add_header X-Content-Type-Options               &quot;nosniff&quot;       always;&lt;br /&gt;        add_header X-Download-Options                   &quot;noopen&quot;        always;&lt;br /&gt;        add_header X-Frame-Options                      &quot;SAMEORIGIN&quot;    always;&lt;br /&gt;        add_header X-Permitted-Cross-Domain-Policies    &quot;none&quot;          always;&lt;br /&gt;        add_header X-Robots-Tag                         &quot;none&quot;          always;&lt;br /&gt;        add_header X-XSS-Protection                     &quot;1; mode=block&quot; always;&lt;br /&gt;        fastcgi_hide_header X-Powered-By;&lt;br /&gt;        index index.php index.html /cloud/index.php$request_uri;&lt;br /&gt;&lt;br /&gt;        location = /cloud {&lt;br /&gt;            if ( $http_user_agent ~ ^DavClnt ) {&lt;br /&gt;                return 302 /cloud/remote.php/webdav/$is_args$args;&lt;br /&gt;            }&lt;br /&gt;        }&lt;br /&gt;&lt;br /&gt;        location ~ ^/cloud/(?:build|tests|config|lib|3rdparty|templates|data)(?:$|/)    { return 404; }&lt;br /&gt;        location ~ ^/cloud/(?:\.|autotest|occ|issue|indie|db_|console)                  { return 404; }&lt;br /&gt;        location ~ \.php(?:$|/) {&lt;br /&gt;            rewrite ^/cloud/(?!index|remote|public|cron|core\/ajax\/update|status|ocs\/v[12]|updater\/.+|oc[ms]-provider\/.+|.+\/richdocumentscode\/pr&lt;br /&gt;oxy) /cloud/index.php$request_uri;&lt;br /&gt;&lt;br /&gt;            fastcgi_split_path_info ^(.+?\.php)(/.*)$;&lt;br /&gt;            set $path_info $fastcgi_path_info;&lt;br /&gt;            try_files $fastcgi_script_name =404;&lt;br /&gt;            include fastcgi_params;&lt;br /&gt;            fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;&lt;br /&gt;            fastcgi_param PATH_INFO $path_info;&lt;br /&gt;           # fastcgi_param HTTPS on;&lt;br /&gt;&lt;br /&gt;            fastcgi_param modHeadersAvailable true;         # Avoid sending the security headers twice&lt;br /&gt;            fastcgi_param front_controller_active true;     # Enable pretty urls&lt;br /&gt;            fastcgi_pass php-handler;&lt;br /&gt;&lt;br /&gt;            fastcgi_intercept_errors on;&lt;br /&gt;            fastcgi_request_buffering off;&lt;br /&gt;&lt;br /&gt;            fastcgi_max_temp_file_size 0;&lt;br /&gt;        }&lt;br /&gt;        location ~ \.(?:css|js|svg|gif|png|jpg|ico|wasm|tflite|map)$ {&lt;br /&gt;            try_files $uri /cloud/index.php$request_uri;&lt;br /&gt;            add_header Cache-Control &quot;public, max-age=15778463, $asset_immutable&quot;;&lt;br /&gt;            access_log off;     # Optional: Don&#39;t log access to assets&lt;br /&gt;&lt;br /&gt;            location ~ \.wasm$ {&lt;br /&gt;                default_type application/wasm;&lt;br /&gt;            }&lt;br /&gt;        }&lt;br /&gt;        location ~ \.woff2?$ {&lt;br /&gt;            try_files $uri /cloud/index.php$request_uri;&lt;br /&gt;            expires 7d;         # Cache-Control policy borrowed from `.htaccess`&lt;br /&gt;            access_log off;     # Optional: Don&#39;t log access to assets&lt;br /&gt;        }&lt;br /&gt;        location /cloud/remote {&lt;br /&gt;            return 301 /cloud/remote.php$request_uri;&lt;br /&gt;        }&lt;br /&gt;        location /cloud {&lt;br /&gt;            try_files $uri $uri/ /cloud/index.php$request_uri;&lt;br /&gt;        }&lt;br /&gt;    }&lt;br /&gt;}&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Activamos el virtualhost.&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;root@nabil:/etc/nginx/sites-enabled# sudo ln -s /etc/nginx/sites-available/alejandromontes.conf /etc/nginx/sites-enabled/&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Reiniciamos nginx.&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;root@nabil:/etc/nginx/sites-enabled# systemctl reload nginx&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&quot;creaci%C3%B3n-y-configuraci%C3%B3n-de-la-base-de-datos.&quot; tabindex=&quot;-1&quot;&gt;Creación y configuración de la base de datos.&lt;/h4&gt;
&lt;p&gt;Una vez creado el virtualhost, configuraremos la base de datos del vps, para ello, lo primero que debemos de hacer es añadir un nombre de dominio en el /etc/hosts.&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;nano /etc/hosts&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;añadimos la siguiente línea:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;127.0.0.1       bd.alejandro-montes.es&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Ahora, accederemos al servidor mariadb. Crearemos un usuario, una base de datos y daremos privilegios al usuario sobre la base de datos.&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;MariaDB [(none)]&gt; CREATE DATABASE glpi;&lt;br /&gt;Query OK, 1 row affected (0.005 sec)&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;MariaDB [(none)]&gt; CREATE USER &#39;alemd&#39;@&#39;localhost&#39; IDENTIFIED BY &#39;passwd&#39;;&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;MariaDB [(none)]&gt; GRANT ALL PRIVILEGES ON glpi.* TO &#39;alemd&#39;@&#39;LOCALHOST&#39;;&lt;br /&gt;Query OK, 0 rows affected (0.003 sec)&lt;br /&gt;&lt;br /&gt;MariaDB [(none)]&gt; FLUSH PRIVILEGES;&lt;br /&gt;Query OK, 0 rows affected (0.004 sec)&lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&quot;realizando-la-migraci%C3%B3n.&quot; tabindex=&quot;-1&quot;&gt;Realizando la migración.&lt;/h4&gt;
&lt;p&gt;En el escenario vagrant, teníamos una máquina que actuaba de servidor web y otra del servidor de base de datos. Empezaremos la migración con la máquina que actuaba como servidor de base de datos. Crearemos una copia de seguridad del servidor de base de datos.&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;root@servidorbd-alejandro:/home/vagrant# mysqldump glpi &gt; ./backup.sql&lt;br /&gt;root@servidorbd-alejandro:/home/vagrant# ls -lah&lt;br /&gt;total 772K&lt;br /&gt;drwxr-xr-x 3 vagrant vagrant 4.0K Nov 24 09:42 .&lt;br /&gt;drwxr-xr-x 3 root    root    4.0K Sep 12 05:17 ..&lt;br /&gt;-rw------- 1 vagrant vagrant  406 Nov 22 19:18 .bash_history&lt;br /&gt;-rw-r--r-- 1 vagrant vagrant  220 Mar 27  2022 .bash_logout&lt;br /&gt;-rw-r--r-- 1 vagrant vagrant 3.5K Mar 27  2022 .bashrc&lt;br /&gt;-rw------- 1 vagrant vagrant   33 Nov 22 18:05 .mysql_history&lt;br /&gt;-rw-r--r-- 1 vagrant vagrant  807 Mar 27  2022 .profile&lt;br /&gt;drwx------ 2 vagrant vagrant 4.0K Nov 17 08:59 .ssh&lt;br /&gt;-rw-r--r-- 1 root    root    739K Nov 24 09:42 backup.sql&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Ahora mediante scp mandamos la copia de seguridad. Tenemos que tener en cuenta que en nuestro vps no está la clave pública del servidor de base de datos, lo que haré será enviarlo a mi máquina y después al vps.&lt;/p&gt;
&lt;p&gt;Primero lo enviamos a mi máquina:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;root@servidorbd-alejandro:/home/vagrant# scp ./backup.sql alemd@192.168.122.1:&lt;br /&gt;The authenticity of host &#39;192.168.122.1 (192.168.122.1)&#39; can&#39;t be established.&lt;br /&gt;ECDSA key fingerprint is SHA256:P4VynMzXNSUoRSzuUrFgWShiT4hYwT/y6DqQ7Sf/ujs.&lt;br /&gt;Are you sure you want to continue connecting (yes/no/[fingerprint])? yes&lt;br /&gt;Warning: Permanently added &#39;192.168.122.1&#39; (ECDSA) to the list of known hosts.&lt;br /&gt;alemd@192.168.122.1&#39;s password: &lt;br /&gt;backup.sql                                    100%  739KB  39.9MB/s   00:00  &lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;desde mi máquina lo enviamos al servidor vps.&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;alemd@debian:~$ scp backup.sql alemd@nabil.alejandro-montes.es:~/&lt;br /&gt;backup.sql                                    100%  739KB 622.3KB/s   00:01 &lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Ahora el directorio donde está alojada la aplicación web lo comprimiremos y lo enviaremos por scp al vps.&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;vagrant@servidorweb-alejandro:/var/www$ sudo tar -zcf glpi.tar.gz alejandromontes/*&lt;br /&gt;vagrant@servidorweb-alejandro:/var/www$ sudo scp ./glpi.tar.gz alemd@192.168.122.1:~/&lt;br /&gt;alemd@debian:~$ scp glpi.tar.gz alemd@nabil.alejandro-montes.es:~/&lt;br /&gt;glpi.tar.gz                                   100%   55MB   2.7MB/s   00:20 &lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Ahora restauraremos la copia de seguridad de la base de datos indicando cual es la base de datos que queremos que recupere.&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;root@nabil:/home/alemd# mysql glpi &amp;lt; backup.sql&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Una vez restaurada la copia de seguridad, extraeremos la aplicación web.&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;alemd@nabil:/var/www/glpi$ sudo tar -zxf ~/glpi.tar.gz &lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Le cambiamos el dueño al host virtual.&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;alemd@nabil:/var/www$ sudo chown www-data:www-data glpi/&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;La aplicación web está configurada para que acceda a una base de datos remota. Cambiaremos la configuración haciendo los siguientes pasos:&lt;/p&gt;
&lt;p&gt;Nos movemos a la carpeta config y editamos el archivo config_db.php.&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;root@nabil:/var/www/glpi# cd /var/www/glpi/config&lt;br /&gt;root@nabil:/var/www/glpi/config# nano config_db.php &lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Lo editamos y queda de la siguiente manera:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;&amp;lt;?php&lt;br /&gt;class DB extends DBmysql {&lt;br /&gt;   public $dbhost = &#39;bd.alejandro-montes.es&#39;;&lt;br /&gt;   public $dbuser = &#39;alemd&#39;;&lt;br /&gt;   public $dbpassword = &#39;passwd_user&#39;;&lt;br /&gt;   public $dbdefault = &#39;glpi&#39;;&lt;br /&gt;   public $use_utf8mb4 = true;&lt;br /&gt;   public $allow_myisam = false;&lt;br /&gt;   public $allow_datetime = false;&lt;br /&gt;   public $allow_signed_keys = false;&lt;br /&gt;}&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Antes de entrar al sitio, instalaremos las librerías que necesitamos en el escenario local.&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;root@nabil:/var/www/glpi/config# apt install  php7.4-mbstring php7.4-curl php7.4-gd php7.4-xml php7.4-intl php7.4-bz2 php7.4-ldap php7.4-xmlrpc php7.4-zip &lt;br /&gt;Reading package lists... Done&lt;br /&gt;Building dependency tree... Done&lt;br /&gt;Reading state information... Done&lt;br /&gt;The following packages were automatically installed and are no longer required:&lt;br /&gt;  apache2-bin apache2-data apache2-utils libapr1 libaprutil1&lt;br /&gt;  libaprutil1-dbd-sqlite3 libaprutil1-ldap libjansson4 liblua5.3-0&lt;br /&gt;Use &#39;sudo apt autoremove&#39; to remove them.&lt;br /&gt;The following additional packages will be installed:&lt;br /&gt;  libonig5 libxmlrpc-epi0 libzip4&lt;br /&gt;The following NEW packages will be installed:&lt;br /&gt;  libonig5 libxmlrpc-epi0 libzip4 php7.4-bz2 php7.4-curl php7.4-gd php7.4-intl&lt;br /&gt;  php7.4-ldap php7.4-mbstring php7.4-xml php7.4-xmlrpc php7.4-zip&lt;br /&gt;0 upgraded, 12 newly installed, 0 to remove and 0 not upgraded.&lt;br /&gt;Need to get 1025 kB of archives.&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;reiniciamos el servicio para que funcione correctamente:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;root@nabil:/var/www/glpi/config# systemctl reload php7.4-fpm&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&quot;nextcloud&quot; tabindex=&quot;-1&quot;&gt;Nextcloud&lt;/h3&gt;
&lt;h4 id=&quot;creaci%C3%B3n-y-configuraci%C3%B3n-de-la-base-de-datos.-1&quot; tabindex=&quot;-1&quot;&gt;Creación y configuración de la base de datos.&lt;/h4&gt;
&lt;p&gt;En el vps creamos la base de datos, el usuario y damos al usuario privilegios sobre la base de datos.&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;MariaDB [(none)]&gt; CREATE USER &#39;nextclouduser&#39;@&#39;localhost&#39; IDENTIFIED BY &#39;PASSWORD&#39;;&lt;br /&gt;Query OK, 0 rows affected (0.004 sec)&lt;br /&gt;MariaDB [(none)]&gt; CREATE DATABASE nextcloud_db;&lt;br /&gt;Query OK, 1 row affected (0.000 sec)&lt;br /&gt;MariaDB [(none)]&gt; GRANT ALL PRIVILEGES ON nextcloud_db.* TO &#39;nextclouduser&#39;@&#39;localhost&#39;;&lt;br /&gt;Query OK, 0 rows affected (0.002 sec)&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Nos vamos al servidor del anterior escenario y exportamos la base de datos:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;root@servidorbd-alejandro:/home/vagrant# mysqldump nextcloud_db &gt; backup_nextcloud.sql&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Exportamos el archivo generado al vps.&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;alemd@debian:~$ scp backup_nextcloud.sql alemd@nabil.alejandro-montes.es:~/&lt;br /&gt;backup_nextcloud.sql                                                                                                100%  197KB 189.8KB/s   00:01    &lt;/code&gt;&lt;/pre&gt;
&lt;h4 id=&quot;realizando-la-migraci%C3%B3n.-1&quot; tabindex=&quot;-1&quot;&gt;Realizando la migración.&lt;/h4&gt;
&lt;p&gt;Una vez exportada la base de datos, exportaremos el nextcloud, para ello lo comprimiremos y lo enviaremos por scp al vps.&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;vagrant@servidorweb-alejandro:/var/www$ sudo tar -zcf nextcloud.tar.gz nextcloud&lt;br /&gt;vagrant@servidorweb-alejandro:/var/www$ sudo scp ./nextcloud.tar.gz alemd@192.168.122.1:~/&lt;br /&gt;alemd@192.168.122.1&#39;s password: &lt;br /&gt;nextcloud.tar.gz                                                                                                    100%  246MB  69.7MB/s   00:03   &lt;br /&gt;alemd@debian:~$ scp nextcloud.tar.gz alemd@nabil.alejandro-montes.es:~/&lt;br /&gt;nextcloud.tar.gz                                                                                                    100%  246MB   4.6MB/s   00:53 &lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Regeneramos la base de datos de nextcloud.&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;root@nabil:/home/alemd# mysql nextcloud_bd &amp;lt; backup.sql&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;extraemos el nexcloud.&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;root@nabil:/var/www/alejandromontes/cloud# tar -zxf nextcloud.tar.gz&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;editamos el fichero de configuración en el que indica donde está alojada la base de datos.&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;root@nabil:/var/www/alejandromontes/cloud# nano config/config.php &lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;&amp;lt;?php&lt;br /&gt;7$CONFIG = array (&lt;br /&gt;  &#39;instanceid&#39; =&gt; &#39;ocku5u9frj18&#39;,&lt;br /&gt;  &#39;passwordsalt&#39; =&gt; &#39;cVo/fptYzJDN8NjvuFh1ey5IoxZ18R&#39;,&lt;br /&gt;  &#39;secret&#39; =&gt; &#39;ZKcMNlQ1H4uE+J2u95cg7LSnM+/KkLHP0NbvtE8VEYfskTBR&#39;,&lt;br /&gt;  &#39;trusted_domains&#39; =&gt; &lt;br /&gt;  array (&lt;br /&gt;    0 =&gt; &#39;www.alejandro-montes.es&#39;,&lt;br /&gt;  ),&lt;br /&gt;  &#39;datadirectory&#39; =&gt; &#39;/var/www/alejandromontes/cloud/data&#39;,&lt;br /&gt;  &#39;dbtype&#39; =&gt; &#39;mysql&#39;,&lt;br /&gt;  &#39;version&#39; =&gt; &#39;22.1.1.2&#39;,&lt;br /&gt;  &#39;overwrite.cli.url&#39; =&gt; &#39;http://www.alejandro-montes.es/cloud&#39;,&lt;br /&gt;  &#39;dbname&#39; =&gt; &#39;nextcloud_db&#39;,&lt;br /&gt;  &#39;dbhost&#39; =&gt; &#39;localhost&#39;,&lt;br /&gt;  &#39;dbport&#39; =&gt; &#39;&#39;,&lt;br /&gt;  &#39;dbtableprefix&#39; =&gt; &#39;oc_&#39;,&lt;br /&gt;  &#39;mysql.utf8mb4&#39; =&gt; true,&lt;br /&gt;  &#39;dbuser&#39; =&gt; &#39;nextclouduser&#39;,&lt;br /&gt;  &#39;dbpassword&#39; =&gt; &#39;password&#39;,&lt;br /&gt;  &#39;installed&#39; =&gt; true,&lt;br /&gt;);&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&quot;documento-realizado-por%3A&quot; tabindex=&quot;-1&quot;&gt;&lt;strong&gt;Documento realizado por:&lt;/strong&gt;&lt;/h2&gt;
&lt;p&gt;✒️ &lt;strong&gt;Alejandro Montes Delgado&lt;/strong&gt; - &lt;em&gt;2º ASIR&lt;/em&gt;&lt;/p&gt;
</content>
	</entry>
	
	<entry>
		<title>Migrar CentOS a otra distribución.</title>
		<link href="https://reeseschultz.github.io/post/migrar-centos-a-otra-distribucion./"/>
		<updated>2022-11-18T00:00:00Z</updated>
		<id>https://reeseschultz.github.io/post/migrar-centos-a-otra-distribucion./</id>
		<content type="html">&lt;p&gt;Debido al anuncio del fin de soporte por parte de Red Hat de Centos8 el pasado 31 de diciembre de 2021, y teniendo en cuentas que el fin de vida de centos 7 está programada para el 30 de junio de 2024. Han salido múltiples distribuciones que cubren el hueco dejado por esta distribución tan extendida y tan usada en el ámbito de servidores.&lt;/p&gt;
&lt;p&gt;En la presente práctica, analiza posibles versiones candidatas y opciones desplegadas para la migración de tus servidores CentOS.&lt;/p&gt;
&lt;p&gt;El espectro es amplio:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;Cambiar el rumbo a una nueva distribución, debian, opensuse, slakware, etc.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Soluciones aportadas por Red Hat: Red Hat Enterprise Linux, CentOS Stream.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;Solución aportada por Oracle Linux.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;Nuevas distribuciones surgidas para paliar el hueco dejado:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;AlmaLinux.&lt;/li&gt;
&lt;li&gt;Rocky Linux.&lt;/li&gt;
&lt;li&gt;VZLinux.&lt;/li&gt;
&lt;li&gt;euroLinux.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;analiza-el-desencadenante-de-la-retirada-de-centos-8-del-mercado.-%C2%BFqu%C3%A9-opini%C3%B3n-tienes-al-respecto%3F&quot; tabindex=&quot;-1&quot;&gt;Analiza el desencadenante de la retirada de centOS 8 del mercado. ¿Qué opinión tienes al respecto?&lt;/h3&gt;
&lt;p&gt;Al final, creo que la comunidad ha convertido algo que en un principio era malo, en algo muy positivo, ya que gracias a la descontinuación de CentOS han aparecido muchas distribuciones y buenas para usar.&lt;/p&gt;
&lt;p&gt;CentOS 8 se ha convertido en el nuevo CentOS Stream, este cambio supone un fin a una gran trayectoria o legado, aunque a grandes rasgos nada o poco ha cambiado o vaya a cambiar.&lt;/p&gt;
&lt;h3 id=&quot;crea-una-cuenta-en-red-hat-y-desc%C3%A1rgate-la-iso-de-red-hat-enterprise-linux-(rel)-y-eval%C3%BAa-el-producto.-comenta-el-procedimiento-de-alta.&quot; tabindex=&quot;-1&quot;&gt;Crea una cuenta en Red Hat y descárgate la iso de Red Hat Enterprise Linux (REL) y evalúa el producto. Comenta el procedimiento de alta.&lt;/h3&gt;
&lt;p&gt;Lo primero que debemos de hacer es acceder a la página oficial de &lt;a href=&quot;https://www.redhat.com/es/technologies/linux-platforms/enterprise-linux/server/trial?sc_cid=7013a000002pdRFAAY&amp;amp;gclid=Cj0KCQiAg_KbBhDLARIsANx7wAz-LbYyFuxRlM2fU6aFLoXtvGOLRanBnxNm6uBHRNATDa0XvyGdkggaApVJEALw_wcB&amp;amp;gclsrc=aw.ds&quot;&gt;Red Hat&lt;/a&gt;
para iniciar el registro. Para el registro debemos de poner nuestra información personal y en el apartado de la organización no dejaba ponerlo en blanco y he puesto Gonzalo Nazareno.&lt;/p&gt;
&lt;p&gt;Una vez hecho el registro, se descargará automáticamente. Cuando se haya descargado la iso, Detallaré por encima la instalación de RHEL. Una vez descargada la iso la insertaremos en una máquina virtual. Al arrancar la máquina virtual, aparecerá el típico instalador de linux.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://reeseschultz.github.io/img/aso5.3.png&quot; alt=&quot;aso5.3.png&quot; /&gt;&lt;/p&gt;
&lt;p&gt;Simplemente tenemos que elegir el destino de la instalación, añadir una contraseña de root y comenzará la instalación.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://reeseschultz.github.io/img/aso5.4.png&quot; alt=&quot;aso5.4.png&quot; /&gt;&lt;/p&gt;
&lt;h4 id=&quot;evaluaci%C3%B3n-del-producto.&quot; tabindex=&quot;-1&quot;&gt;Evaluación del producto.&lt;/h4&gt;
&lt;p&gt;Red Hat Enterprise Linux es la version comercial de Red Hat basada en Fedora que a su vez está basada en el anterior Red Hat linux. Mientras que las versiones de fedora salen cada 6 meses aproximadamente, las de RHEL suelen hacerlo cada 18 o 24 meses. Cada una de estas versiones cuenta con una serie de servicios de valor añadido sobre la base de los que basa su negocio ya sea como soporte, formación, consultoría, certificación etc.&lt;/p&gt;
&lt;p&gt;Cada versión lanzada de RHEL cuenta por el momento con soporte durante al menos 10 años desde la fecha de lanzamiento de la GA (version que acaba en 0).&lt;/p&gt;
&lt;p&gt;En cuanto a la interfaz gráfica, podemos ver una interfaz gnome, bastante familiar ya que es la interfaz gráfica más usada o de las más usada en linux, la podemos ver comumente en debian.&lt;/p&gt;
&lt;p&gt;El gestor de paquetes de RHEL es yum y el administrador de paquetes RPM, no apt o dpkg como sería en el caso de Debian respectivamente. RHEL tiene muy pocos paquetes disponibles en su repositorio, si se quiere instalar algún paquete como el libreoffice por ejemplo, se debe de instalar desde repositorios de terceros o descargando directamente el paquete. Los paquetes de RHEL son RPM.&lt;/p&gt;
&lt;p&gt;Como conclusión propia, me parece la distribución de linux idónea para instalar en una empresa grande y con un buen desarrollo tecnológico aunque no debemos de pasar por alto que es un sistema operativo caro ya que no te “venden” únicamente el sistema operativo si no que te dan soportes, asesorías, formación y demás. Otro aspecto a tener en cuenta es que al ser un sistema operativo pensado para servidores pueden ser demasiado estables y quizás necesitemos que nuestros paquetes se actualicen más a menudo.&lt;/p&gt;
&lt;h3 id=&quot;descarga-la-iso-de-centos-stream-y-eval%C3%BAa-el-producto.&quot; tabindex=&quot;-1&quot;&gt;Descarga la iso de CentOS Stream y evalúa el producto.&lt;/h3&gt;
&lt;p&gt;Descargaremos la iso de la página oficial de &lt;a href=&quot;https://www.centos.org/centos-stream/#tab-3&quot;&gt;CentOS&lt;/a&gt;. No pondré los pasos de la instalación ya que es exactamente igual que RHEL. Esperaremos a que se instale.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://reeseschultz.github.io/img/aso5.5.png&quot; alt=&quot;aso5.5.png&quot; /&gt;&lt;/p&gt;
&lt;h4 id=&quot;evaluaci%C3%B3n-del-producto.-1&quot; tabindex=&quot;-1&quot;&gt;Evaluación del producto.&lt;/h4&gt;
&lt;p&gt;CentOS ya no es una distribución estable como RHEL, se ha convertido en una distribución de lanzamiento contínuo entonces para entornos de producción como servidores de empresas es inviable, la distribución de CentOS a pasado mas a un entorno de desarrollo o también a nivel usuario.&lt;/p&gt;
&lt;p&gt;Independientemente de que se actualice continuamente, el SO está basado en Red Hat por lo que es muy similar a RHEL.&lt;/p&gt;
&lt;h3 id=&quot;descarga-iso-de-una-de-las-otras-distribuciones-candidatas%2C-indica-criterios-para-la-elecci%C3%B3n-de-la-nueva-distribuci%C3%B3n-y-eval%C3%BAa-el-producto.&quot; tabindex=&quot;-1&quot;&gt;Descarga iso de una de las otras distribuciones candidatas, indica criterios para la elección de la nueva distribución y evalúa el producto.&lt;/h3&gt;
&lt;p&gt;La distribución que he elegido para migrar desde CentOS es Rocky Linux, ya que es una distribución muy estable y no recibe tantas actualizaciones como CentOS Stream por ejemplo, que estaría más enfocado a un entorno de desarrollo.&lt;/p&gt;
&lt;h4 id=&quot;evaluaci%C3%B3n-del-producto.-2&quot; tabindex=&quot;-1&quot;&gt;Evaluación del producto.&lt;/h4&gt;
&lt;p&gt;En cuanto a sistema operativo es muy similar al resto de sistemas operativos que hemos visto anteriormente. Rocky Linux es un punto intermedio entre CentOS Stream y RHEL es decir, no es un sistema para un entorno de desarrollo ni tampoco es tan estable como RHEL.&lt;/p&gt;
&lt;h3 id=&quot;instala-centos-7%2C-y-eval%C3%BAa-la-herramientas-que-ofrecen-la-distribuci%C3%B3n-del-punto-3.&quot; tabindex=&quot;-1&quot;&gt;Instala CentOS 7, y evalúa la herramientas que ofrecen la distribución del punto 3.&lt;/h3&gt;
&lt;p&gt;A continuación, realizaré una migración de CentOS 8 a Rocky Linux 8. Detallaré todos los pasos que he seguido para realizar de forma correcta la migración.&lt;/p&gt;
&lt;p&gt;En nuestro servidor CentOS 8, como los repositorios de Centos 8 no funcionan, he pasado al servidor el script por correo.&lt;/p&gt;
&lt;p&gt;Cambiamos los permisos del script con el siguiente comando:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;[root@localhost usuario]# chmod u+x migrate2rocky.sh&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Ejecutamos el script:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;[root@localhost usuario]# ./migrate2rocky.sh -r&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&quot;https://reeseschultz.github.io/img/aso5.6.png&quot; alt=&quot;aso5.6.png&quot; /&gt;&lt;/p&gt;
&lt;p&gt;Esperamos que el script se termine de ejecutar y se habrá actualizado correctamente.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://reeseschultz.github.io/img/aso5.7.png&quot; alt=&quot;aso5.7.png&quot; /&gt;&lt;/p&gt;
&lt;p&gt;como podemos apreciar el sistema se ha migrado correctamente a rocky linux.&lt;/p&gt;
&lt;h2 id=&quot;documento-realizado-por%3A&quot; tabindex=&quot;-1&quot;&gt;&lt;strong&gt;Documento realizado por:&lt;/strong&gt;&lt;/h2&gt;
&lt;p&gt;✒️ &lt;strong&gt;Alejandro Montes Delgado&lt;/strong&gt; - &lt;em&gt;2º ASIR&lt;/em&gt;&lt;/p&gt;
</content>
	</entry>
	
	<entry>
		<title>Interconexión de Servidores de Bases de datos</title>
		<link href="https://reeseschultz.github.io/post/interconexion-de-servidores-de-bases-de-datos/"/>
		<updated>2022-11-16T00:00:00Z</updated>
		<id>https://reeseschultz.github.io/post/interconexion-de-servidores-de-bases-de-datos/</id>
		<content type="html">&lt;h3 id=&quot;realizar-un-enlace-entre-dos-servidores-de-bases-de-datos-oracle%2C-explicando-la-configuraci%C3%B3n-necesaria-en-ambos-extremos-y-demostrando-su-funcionamiento.&quot; tabindex=&quot;-1&quot;&gt;Realizar un enlace entre dos servidores de bases de datos ORACLE, explicando la configuración necesaria en ambos extremos y demostrando su funcionamiento.&lt;/h3&gt;
&lt;p&gt;En el escenario, tenemos 2 servidores Oracle, uno creado en mi propio sistema debian y otro en una máquina virtual debian. Ambos se conectan a través de una red virtual. Lo primero que haremos, es crear un usuario en cada servidor con los privilegios suficientes para poder realizar la interconexión. (Solo muestro la creación de un usuario para no repetir información.)&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://reeseschultz.github.io/img/BD-P2.2.png&quot; alt=&quot;BD-P2.2.png&quot; /&gt;&lt;/p&gt;
&lt;p&gt;He añadido como ejemplo el esquema SCOTT para poder visualizar algunas tablas. Vamos a configurar el archivo &lt;code&gt;tnsnames.ora&lt;/code&gt;:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;sudo nano /opt/oracle/product/19c/dbhome_1/network/admin/tnsnames.ora&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;ORCLCDB =&lt;br /&gt;  (DESCRIPTION =&lt;br /&gt;    (ADDRESS = (PROTOCOL = TCP)(HOST = 192.168.122.97)(PORT = 1521))&lt;br /&gt;    (CONNECT_DATA =&lt;br /&gt;      (SERVER = DEDICATED)&lt;br /&gt;      (SERVICE_NAME = ORCLCDB)&lt;br /&gt;    )&lt;br /&gt;  )&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Una vez modificado el fichero tnsnames.ora en ambos servidores, probaremos que ambos servidores se ven correctamente con el &lt;code&gt;tnsping&lt;/code&gt;.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://reeseschultz.github.io/img/BD-P2.4.png&quot; alt=&quot;BD-P2.4.png&quot; /&gt;&lt;/p&gt;
&lt;p&gt;A continuación, crearemos el enlace de ambas bases de datos, la sintaxis del comando para realizar el enlace es la siguiente:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;CREATE DATABASE LINK nombreenlace &lt;br /&gt;CONNECT to usuario IDENTIFIED BY contraseña &lt;br /&gt;using &#39;alias-conexion-tnsora&#39;;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&quot;https://reeseschultz.github.io/img/BD-P2.3.png&quot; alt=&quot;BD-P2.3.png&quot; /&gt;&lt;/p&gt;
&lt;p&gt;Ahora, verificaremos el correcto funcionamiento del enlace que hemos creado anteriormente. Hacemos una consulta donde muestra el DEPTNO de un servidor y el DNAME de otro.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://reeseschultz.github.io/img/BD-P2.5.png&quot; alt=&quot;BD-P2.5.png&quot; /&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;h3 id=&quot;realizar-un-enlace-entre-dos-servidores-de-bases-de-datos-postgres%2C-explicando-la-configuraci%C3%B3n-necesaria-en-ambos-extremos-y-demostrando-su-funcionamiento.&quot; tabindex=&quot;-1&quot;&gt;Realizar un enlace entre dos servidores de bases de datos Postgres, explicando la configuración necesaria en ambos extremos y demostrando su funcionamiento.&lt;/h3&gt;
&lt;p&gt;Lo primero que haré será crear la base de datos en ambos servidores.&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;usuario@PostgreSQL:~$ su - postgres&lt;br /&gt;Contraseña: &lt;br /&gt;postgres@PostgreSQL:~$ psql&lt;br /&gt;psql (11.17 (Debian 11.17-0+deb10u1))&lt;br /&gt;Digite «help» para obtener ayuda.&lt;br /&gt;&lt;br /&gt;postgres=# CREATE DATABASE SERVIDOR1;&lt;br /&gt;CREATE DATABASE&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Una vez creado las bases de datos en los 2 servidores, crearemos un usuario para cada base de datos y le otorgaremos los privilegios correspondientes.&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;postgres=# CREATE USER alejandro1 WITH PASSWORD &#39;usuario&#39;;&lt;br /&gt;CREATE ROLE&lt;br /&gt;postgres=# GRANT ALL PRIVILEGES ON DATABASE SERVIDOR1 to alejandro1;&lt;br /&gt;GRANT&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Nos conectaremos a la base de datos con el usuario que hemos creado para comprobar que funciona correctamente.&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;postgres@PostgreSQL:~$ psql -h localhost -U alejandro1 -d servidor1;&lt;br /&gt;Contraseña para usuario alejandro1: &lt;br /&gt;psql (11.17 (Debian 11.17-0+deb10u1))&lt;br /&gt;conexión SSL (protocolo: TLSv1.3, cifrado: TLS_AES_256_GCM_SHA384, bits: 256, compresión: desactivado)&lt;br /&gt;Digite «help» para obtener ayuda.&lt;br /&gt;&lt;br /&gt;servidor1=&gt; &lt;br /&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;En las bases de datos, introduciré algunas tablas y registros para mostrar el funcionamiento del enlace posteriormente. He añadido el esquema scott en ambas bases de datos como hice en el anterior ejercicio.&lt;/p&gt;
&lt;p&gt;Una vez que hemos creado las tablas y hemos insertados los registros, modificaremos el fichero de configuración de postgres para que acepte conexiones de forma remota. El fichero que tenemos que editar es el siguiente:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;usuario@PostgreSQL:~$ sudo nano /etc/postgresql/11/main/postgresql.conf&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Editamos la línea que empieza por:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;listen_addresses = &#39;localhost&#39;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Y lo cambiamos por lo siguiente:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;listen_addresses = &#39;*&#39;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Ahora, editaremos un segundo fichero que se ubica en:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;usuario@PostgreSQL:~$ sudo nano /etc/postgresql/11/main/pg_hba.conf &lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Buscamos la siguiente línea:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;host    all             all             127.0.0.1/32            md5&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Y ponemos lo siguiente:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;host    all             all              192.168.122.0/24       md5&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Podemos cambiar la dirección de red por &lt;code&gt;all&lt;/code&gt; y así permitirá el trafico desde cualquier red.&lt;/p&gt;
&lt;p&gt;Una vez modificados ambos ficheros reiniciaremos el servicio para que se apliquen los cambios.&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;usuario@PostgreSQL:~$ sudo systemctl restart postgresql&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Esta sería la configuración para un servidor, tenemos que hacer exactamente los mismos pasos en el otro servidor, cambiando los nombres necesarios.&lt;/p&gt;
&lt;p&gt;Instalaremos el paquete &lt;code&gt;postgresql-contrib&lt;/code&gt;, ejecuntando el siguiente comando:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;usuario@PostgreSQL:~$ sudo apt install postgresql-contrib&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Nos cambiaremos al usuario postgres y nos conectaremos a la base de datos que hemos creado anteriormente.&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;usuario@PostgreSQL:~$ su - postgres&lt;br /&gt;Contraseña: &lt;br /&gt;postgres@PostgreSQL:~$ psql -d servidor1&lt;br /&gt;psql (11.17 (Debian 11.17-0+deb10u1))&lt;br /&gt;Digite «help» para obtener ayuda.&lt;br /&gt;&lt;br /&gt;servidor1=# &lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Creamos la extension con la que nos conectaremos a la base de datos remota con el siguiente comando:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;servidor1=# CREATE EXTENSION dblink;&lt;br /&gt;CREATE EXTENSION&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Ahora probaré a hacer una consulta del DNAME y DEPTNO del servidor2 desde el servidor1:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;SELECT * FROM dblink(&#39;dbname=servidor2 host=192.168.122.218 user=alejandro2 password=usuario&#39;, &#39;select DNAME, DEPTNO FROM DEPT&#39;) as DEPT (DNAME VARCHAR, DEPTNO NUMERIC);&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&quot;https://reeseschultz.github.io/img/BD-P2.8.png&quot; alt=&quot;BD-P2.8.png&quot; /&gt;&lt;/p&gt;
&lt;p&gt;Repetiremos el proceso en el servidor 2 ya que el dblink es unidireccional y si queremos conectar el servidor2 con el servidor1 debemos repetir los pasos que hemos hecho anteriormente en el servidor1.&lt;/p&gt;
&lt;p&gt;Ahora probaré a hacer una consulta del DNAME y DEPTNO del servidor1 desde el servidor2:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;SELECT * FROM dblink(&#39;dbname=servidor1 host=192.168.122.98 user=alejandro1 password=usuario&#39;, &#39;select DNAME, DEPTNO FROM DEPT&#39;) as DEPT (DNAME VARCHAR, DEPTNO NUMERIC);&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&quot;https://reeseschultz.github.io/img/BD-P2.9.png&quot; alt=&quot;BD-P2.9.png&quot; /&gt;&lt;/p&gt;
&lt;hr /&gt;
&lt;h3 id=&quot;realizar-un-enlace-entre-un-servidor-oracle-y-otro-postgres-o-mysql-empleando-heterogeneus-services%2C-explicando-la-configuraci%C3%B3n-necesaria-en-ambos-extremos-y-demostrando-su-funcionamiento.&quot; tabindex=&quot;-1&quot;&gt;Realizar un enlace entre un servidor ORACLE y otro Postgres o MySQL empleando Heterogeneus Services, explicando la configuración necesaria en ambos extremos y demostrando su funcionamiento.&lt;/h3&gt;
&lt;h4 id=&quot;oracle-a-postgresql.&quot; tabindex=&quot;-1&quot;&gt;Oracle a PostgreSQL.&lt;/h4&gt;
&lt;p&gt;El primer paso que haremos en la máquina oracle consistirá en instalar la paquetéria para crear dicho enlace:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;usuario@oracle:~$ sudo apt install odbc-postgresql unixodbc               &lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&quot;https://reeseschultz.github.io/img/BD-P2.10.png&quot; alt=&quot;BD-P2.10.png&quot; /&gt;&lt;/p&gt;
&lt;p&gt;Cuando ya esté instalado, procederemos a realizar la configuración en el servidor oracle. Modificaremos el archivo odbcinst.ini:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;usuario@oracle:~$ sudo nano /etc/odbc.ini&lt;br /&gt;---&lt;br /&gt;&lt;br /&gt;Tenemos que dejar el siguiente contenido:&lt;br /&gt;&lt;br /&gt;```txt&lt;br /&gt;[PostgreSQL ANSI]&lt;br /&gt;Description=PostgreSQL ODBC driver (ANSI version)&lt;br /&gt;Driver=psqlodbca.so&lt;br /&gt;Setup=libodbcpsqlS.so&lt;br /&gt;Debug=0&lt;br /&gt;CommLog=1&lt;br /&gt;UsageCount=1&lt;br /&gt;&lt;br /&gt;[PostgreSQL Unicode]&lt;br /&gt;Description=PostgreSQL ODBC driver (Unicode version)&lt;br /&gt;Driver=psqlodbcw.so&lt;br /&gt;Setup=libodbcpsqlS.so&lt;br /&gt;Debug=0&lt;br /&gt;CommLog=1&lt;br /&gt;UsageCount=1&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Ahora editaremos otro fichero para terminar de configurar el servidor oracle:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;usuario@oracle:~$ sudo nano /etc/odbc.ini &lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;[PSQLA]&lt;br /&gt;Debug = 0&lt;br /&gt;CommLog = 0&lt;br /&gt;ReadOnly = 1&lt;br /&gt;Driver = PostgreSQL ANSI   &lt;br /&gt;Servername = 192.168.122.218&lt;br /&gt;Username = alejandro2&lt;br /&gt;Password = usuario&lt;br /&gt;Port = 5432&lt;br /&gt;Database = servidor2&lt;br /&gt;Trace = 0&lt;br /&gt;TraceFile = /tmp/sql.log&lt;br /&gt;&lt;br /&gt;[PSQLU]&lt;br /&gt;Debug = 0&lt;br /&gt;CommLog = 0&lt;br /&gt;ReadOnly = 0&lt;br /&gt;Driver = PostgreSQL Unicode&lt;br /&gt;Servername = 192.168.122.218&lt;br /&gt;Username = alejandro2&lt;br /&gt;Password = usuario&lt;br /&gt;Port = 5432&lt;br /&gt;Database = servidor2&lt;br /&gt;Trace = 0&lt;br /&gt;TraceFile = /tmp/sql.log&lt;br /&gt;&lt;br /&gt;[Default]&lt;br /&gt; Driver = /usr/lib/x86_64-linux-gnu/odbc/liboplodbcS.so&lt;br /&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Para comprobar que hemos configurado correctamente el fichero &lt;code&gt;odbcinst.ini&lt;/code&gt; ejecutamos el siguiente comando:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;usuario@oracle:~$ odbcinst -q -d&lt;br /&gt;[PostgreSQL ANSI]&lt;br /&gt;[PostgreSQL Unicode]&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Para comprobar que hemos configurado correctamente el fichero &lt;code&gt;odbc.ini&lt;/code&gt; ejecutamos el siguiente comando:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;usuario@oracle:~$ odbcinst -q -s&lt;br /&gt;[PSQLA]&lt;br /&gt;[PSQLU]&lt;br /&gt;[Default]&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Con este comando probamos la conexión a postgres;&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;usuario@oracle:~$ sudo isql -v PSQLU                                      &lt;br /&gt;[sudo] password for usuario:                                              &lt;br /&gt;+---------------------------------------+&lt;br /&gt;| Connected!                            |&lt;br /&gt;|                                       |&lt;br /&gt;| sql-statement                         |&lt;br /&gt;| help [tablename]                      |&lt;br /&gt;| quit                                  |&lt;br /&gt;|                                       |&lt;br /&gt;+---------------------------------------+&lt;br /&gt;SQL&gt; quit&lt;br /&gt;usuario@oracle:~$ sudo isql -v PSQLA&lt;br /&gt;+---------------------------------------+&lt;br /&gt;| Connected!                            |&lt;br /&gt;|                                       |&lt;br /&gt;| sql-statement                         |&lt;br /&gt;| help [tablename]                      |&lt;br /&gt;| quit                                  |&lt;br /&gt;|                                       |&lt;br /&gt;+---------------------------------------+&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Una vez comprobado que las conexiones funcionan correctamente, vamos a configurar el &lt;code&gt;heterogeneus services&lt;/code&gt;. Tendremos que crear un fichero dentro de uno de los directorios de oracle y añadiremos lo siguiente:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;usuario@oracle:~$ sudo nano /opt/oracle/product/19c/dbhome_1/hs/admin/initPSQLU.ora&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Añadimos lo siguiente:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;HS_FDS_CONNECT_INFO = PSQLU&lt;br /&gt;HS_FDS_TRACE_LEVEL = Debug&lt;br /&gt;HS_FDS_SHAREABLE_NAME = /usr/lib/x86_64-linux-gnu/odbc/psqlodbcw.so&lt;br /&gt;HS_LANGUAGE = AMERICAN_AMERICA.WE8ISO8859P1&lt;br /&gt;set ODBCINI=/etc/odbc.ini&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Ahora modificaremos el &lt;code&gt;listener.ora&lt;/code&gt; añadiendo lo siguiente:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;usuario@oracle:~$ sudo nano /opt/oracle/product/19c/dbhome_1/network/admin/listener.ora&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;SID_LIST_LISTENER=&lt;br /&gt; (SID_LIST=&lt;br /&gt; (SID_DESC=&lt;br /&gt; (SID_NAME=PSQLU)&lt;br /&gt; (ORACLE_HOME=/opt/oracle/product/19c/dbhome_1)&lt;br /&gt; (PROGRAM=dg4odbc)&lt;br /&gt; )&lt;br /&gt; )&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;También modificaremos el &lt;code&gt;tnsnames.ora&lt;/code&gt; añadiendo lo siguiente:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;usuario@oracle:~$ sudo nano /opt/oracle/product/19c/dbhome_1/network/admin/tnsnames.ora&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;PSQLU =&lt;br /&gt; (DESCRIPTION=&lt;br /&gt;   (ADDRESS=(PROTOCOL=tcp)(HOST=localhost)(PORT=1521))&lt;br /&gt;   (CONNECT_DATA=(SID=PSQLU))&lt;br /&gt; (HS=OK)&lt;br /&gt; )&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Una vez tengamo todo configurado guardaremos los cambios y reiniciaremos el servidor:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;usuario@oracle:~$ sudo systemctl restart oracledb_ORCLCDB-19c.service&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;En el servidor postgres, tenemos que permitir conexiones remotas no documentaré nuevamente como se hace ya que está explicado mas arriba.&lt;/p&gt;
&lt;p&gt;Cuando hayamos terminado de configurar ambos servidores correctamente, procederenis a realizar la creación del enlace de la base de datos en oracle para que se pueda consultar la de postgres.&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;CREATE PUBLIC DATABASE LINK psql1 &lt;br /&gt;CONNECT TO &quot;alejandro2&quot; IDENTIFIED BY &quot;usuario&quot;&lt;br /&gt;USING &#39;PSQLU&#39;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&quot;https://reeseschultz.github.io/img/BD-P2.11.png&quot; alt=&quot;BD-P2.11.png&quot; /&gt;&lt;/p&gt;
&lt;p&gt;Ahora hacemos una prueba para comprobar que funciona:&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://reeseschultz.github.io/img/BD-P2.12.png&quot; alt=&quot;BD-P2.12.png&quot; /&gt;&lt;/p&gt;
&lt;h4 id=&quot;postgres-a-oracle.&quot; tabindex=&quot;-1&quot;&gt;Postgres a Oracle.&lt;/h4&gt;
&lt;p&gt;Para realizar la conexión desde un servidor Postgres a un servidor oracle, primero, debemos de instalar los siguientes paquetes:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;usuario@PostgreSQL:~$ sudo apt install libaio1 postgresql-server-dev-all build-e&lt;br /&gt;ssential git                                                                    &lt;br /&gt;[sudo] password for usuario:                                                    &lt;br /&gt;Leyendo lista de paquetes... Hecho                                              &lt;br /&gt;Creando árbol de dependencias                                                   &lt;br /&gt;Leyendo la información de estado... Hecho                                       &lt;br /&gt;build-essential ya está en su versión más reciente (12.6).                      &lt;br /&gt;fijado build-essential como instalado manualmente.                              &lt;br /&gt;libaio1 ya está en su versión más reciente (0.3.112-3).                         &lt;br /&gt;Se instalarán los siguientes paquetes adicionales:                              &lt;br /&gt;  binfmt-support clang-7 dctrl-tools git-man lib32gcc1 lib32stdc++6 libc6-i386  &lt;br /&gt;  libclang-common-7-dev libclang1-7 liberror-perl libffi-dev libgc1c2&lt;br /&gt;  libncurses-dev libncurses6 libncursesw6 libobjc-8-dev libobjc4 libomp-7-dev&lt;br /&gt;  libomp5-7 libpq-dev libtinfo-dev libtinfo6 llvm-7 llvm-7-dev llvm-7-runtime&lt;br /&gt;  postgresql-server-dev-11&lt;br /&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Ahora descargaremos los paquetes oficiales de &lt;code&gt;Oracle Instant Client&lt;/code&gt;:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;postgres@PostgreSQL:~$ wget https://download.oracle.com/otn_software/linux/instantclient/211000/instantclient-basic-linux.x64-21.1.0.0.0.zip&lt;br /&gt;postgres@PostgreSQL:~$ wget https://download.oracle.com/otn_software/linux/instantclient/211000/instantclient-sdk-linux.x64-21.1.0.0.0.zip&lt;br /&gt;postgres@PostgreSQL:~$ wget https://download.oracle.com/otn_software/linux/instantclient/211000/instantclient-sqlplus-linux.x64-21.1.0.0.0.zip&lt;br /&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Extraemos los archivos .zip con el siguiente comando:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;postgres@PostgreSQL:~$ unzip instantclient-basic-linux.x64-21.1.0.0.0.zip&lt;br /&gt;postgres@PostgreSQL:~$ unzip instantclient-sdk-linux.x64-21.1.0.0.0.zip&lt;br /&gt;postgres@PostgreSQL:~$ unzip instantclient-sqlplus-linux.x64-21.1.0.0.0.zip&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Tenemos que usar las siguientes variables para que funcione correctamente el cliente de oracle:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;postgres@PostgreSQL:/$ export ORACLE_HOME=/var/lib/postgresql/instantclient_21_1/&lt;br /&gt;postgres@PostgreSQL:/$ export LD_LIBRARY_PATH=$LD_LIBRARY_PATH:$ORACLE_HOME&lt;br /&gt;postgres@PostgreSQL:/$ export PATH=$PATH:$ORACLE_HOME&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;como podemos ver, ya nos devuelve la ruta cuando hacemos un which:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;postgres@PostgreSQL:/$ which sqlplus&lt;br /&gt;/var/lib/postgresql/instantclient_21_1/sqlplus&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Y si probamos a hacer una conexión remota desde posgres funciona correctamente.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://reeseschultz.github.io/img/BD-P2.13.png&quot; alt=&quot;BD-P2.13.png&quot; /&gt;&lt;/p&gt;
&lt;p&gt;Ahora instalaremos el paquete &lt;code&gt;oracle_fdw&lt;/code&gt;, para ellos tendremos que clonar el siguiente repositorio de github:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;git clone https://github.com/laurenz/oracle_fdw.git&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;entramos en la carpeta del repositorio clonado y a continuación, compilaremos el paquete. Ejecutamos el siguiente comando:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;postgres@PostgreSQL:~/oracle_fdw$ make                                          &lt;br /&gt;gcc -Wall -Wmissing-prototypes -Wpointer-arith -Wdeclaration-after-statement -Wendif-labels -Wmissing-format-attribute -Wformat-security -fno-strict-aliasing -fwrapv -fexcess-precision=standard -Wno-format-truncation -Wno-stringop-truncation -g -g -O2 -fstack-protector-strong -Wformat -Werror=format-security -fno-omit-frame-pointer -fPIC -I&quot;/var/lib/postgresql/instantclient_21_1/sdk/include&quot; -I&quot;/var/lib/postgresql/instantclient_21_1/oci/include&quot; -I&quot;/var/lib/postgresql/instantclient_21_1/rdbms/public&quot; -I&quot;/var/lib/postgresql/instantclient_21_1/&quot;  -I. -I./ -I/usr/include/postgresql/11/server -I/usr/include/postgresql/internal  -Wdate-time -D_FORTIFY_SOURCE=2 -D_GNU_SOURCE -I/usr/include/libxml2  -I/usr/include/mit-krb5  -c -o oracle_fdw.o oracle_fdw.c                                          &lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Una vez haya terminado, ejecutamos el make install.&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;postgres@PostgreSQL:~/oracle_fdw$ sudo make install&lt;br /&gt;[sudo] password for postgres: &lt;br /&gt;/bin/mkdir -p &#39;/usr/lib/postgresql/11/lib&#39;&lt;br /&gt;/bin/mkdir -p &#39;/usr/share/postgresql/11/extension&#39;&lt;br /&gt;/bin/mkdir -p &#39;/usr/share/postgresql/11/extension&#39;&lt;br /&gt;/bin/mkdir -p &#39;/usr/share/doc/postgresql-doc-11/extension&#39;&lt;br /&gt;/usr/bin/install -c -m 755  oracle_fdw.so &#39;/usr/lib/postgresql/11/lib/oracle_fdw.so&#39;&lt;br /&gt;/usr/bin/install -c -m 644 .//oracle_fdw.control &#39;/usr/share/postgresql/11/extension/&#39;&lt;br /&gt;/usr/bin/install -c -m 644 .//oracle_fdw--1.2.sql .//oracle_fdw--1.0--1.1.sql .//oracle_fdw--1.1--1.2.sql  &#39;/usr/share/postgresql/11/extension/&#39;&lt;br /&gt;/usr/bin/install -c -m 644 .//README.oracle_fdw &#39;/usr/share/doc/postgresql-doc-11/extension/&#39;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Con el siguiente comando, generaremos los enlaces necesarios y cargaremos en memorai las nuevas librerías compartidas que hemos introducido:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;postgres@PostgreSQL:~/oracle_fdw$ sudo ldconfig&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Ya hemos terminado toda la configuración necesaria, ahora crearemos el enlace y empezaremos a usarlo. Para ello, debemos de acceder a nuestra base de datos de postgres.&lt;/p&gt;
&lt;p&gt;Al crear la extensión me daba el siguiente fallo:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;servidor1=# CREATE EXTENSION oracle_fdw;&lt;br /&gt;ERROR:  no se pudo cargar la biblioteca «/usr/lib/postgresql/11/lib/oracle_fdw.so»: libclntsh.so.21.1: no se puede abrir el fichero del objeto compartido: No existe el fichero o el directorio&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Lo he solucionado añadiendo al siguiente fichero lo siguiente:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;postgres@PostgreSQL:~$ sudo nano /etc/ld.so.conf&lt;br /&gt;```txt&lt;br /&gt;&lt;br /&gt;añadimos la siguiente ruta:&lt;br /&gt;&lt;br /&gt;```txt&lt;br /&gt;/var/lib/postgresql/instantclient_21_1/&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Y ahora ya podemos crear el enlace correctamente:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;postgres@PostgreSQL:~$ psql -d servidor1&lt;br /&gt;psql (11.17 (Debian 11.17-0+deb10u1))&lt;br /&gt;Digite «help» para obtener ayuda.&lt;br /&gt;&lt;br /&gt;servidor1=# CREATE EXTENSION oracle_fdw;&lt;br /&gt;CREATE EXTENSION&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Una vez creado el enlace crearemos el schema donde importaremos la base de datos de oracle:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;servidor1=# CREATE SCHEMA oracle;&lt;br /&gt;CREATE SCHEMA&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Ahora que está creado el schema, tendremos que importar las tablas de la base de datos de oracle ya que actualmente el schema está vacío:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;servidor1=# CREATE SERVER oracle FOREIGN DATA WRAPPER oracle_fdw OPTIONS (dbserver &#39;//192.168.122.1/ORCLCDB&#39;);&lt;br /&gt;CREATE SERVER&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;También tenemos que mapear nuestro usuario local a un usuario en el otro servidor para que pueda acceder y tenga privilegios sobre las tablas.&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;servidor1=# CREATE USER MAPPING FOR alejandro1 SERVER oracle OPTIONS (user &#39;c##servidor1&#39;, password &#39;usuario&#39;);&lt;br /&gt;CREATE USER MAPPING&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Por último, le daremos privilegios a nuestro usuario del servidor sobre el nuevo esquema y el servidor remoto.&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;servidor1=# GRANT ALL PRIVILEGES ON SCHEMA oracle to alejandro1;&lt;br /&gt;GRANT&lt;br /&gt;servidor1=# GRANT ALL PRIVILEGES ON FOREIGN SERVER oracle TO alejandro1;&lt;br /&gt;GRANT&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Ahora accederemos a la base de datos con el usuario al que le hemos dado privilegios.&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;postgres@PostgreSQL:~$ psql -h localhost -U alejandro1 -d servidor1&lt;br /&gt;Contraseña para usuario alejandro1: &lt;br /&gt;psql (11.17 (Debian 11.17-0+deb10u1))&lt;br /&gt;conexión SSL (protocolo: TLSv1.3, cifrado: TLS_AES_256_GCM_SHA384, bits: 256, compresión: desactivado)&lt;br /&gt;Digite «help» para obtener ayuda.&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Ahora importaremos el schema que hemos creado anteriormente.&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;servidor1=&gt; IMPORT FOREIGN SCHEMA &quot;C##SERVIDOR1&quot; FROM SERVER &quot;oracle&quot; INTO oracle;&lt;br /&gt;IMPORT FOREIGN SCHEMA&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Vamos a realizar una consulta para demostrar que funciona correctamente.&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt; SELECT DEPT.DNAME AS Departamento, EMP.ENAME AS Nombre&lt;br /&gt; FROM oracle.EMP EMP, DEPT&lt;br /&gt; WHERE EMP.DEPTNO = DEPT.DEPTNO;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&quot;https://reeseschultz.github.io/img/BD-P2.14.png&quot; alt=&quot;BD-P2.14.png&quot; /&gt;&lt;/p&gt;
&lt;h2 id=&quot;documento-realizado-por%3A&quot; tabindex=&quot;-1&quot;&gt;&lt;strong&gt;Documento realizado por:&lt;/strong&gt;&lt;/h2&gt;
&lt;p&gt;✒️ &lt;strong&gt;Alejandro Montes Delgado&lt;/strong&gt; - &lt;em&gt;2º ASIR&lt;/em&gt;&lt;/p&gt;
</content>
	</entry>
	
	<entry>
		<title>Compilar un Kernel linux a medida.</title>
		<link href="https://reeseschultz.github.io/post/compilar-un-kernel-linux-a-medida./"/>
		<updated>2022-11-10T00:00:00Z</updated>
		<id>https://reeseschultz.github.io/post/compilar-un-kernel-linux-a-medida./</id>
		<content type="html">&lt;p&gt;Antes que nada, crearemos un directorio de trabajo, donde descargaremos el kérnel y trabajaremos con él.&lt;/p&gt;
&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token function&quot;&gt;mkdir&lt;/span&gt; ~/kernel&lt;br /&gt;&lt;span class=&quot;token builtin class-name&quot;&gt;cd&lt;/span&gt; ~/kernel&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Instalamos las herramientas de compilación:&lt;/p&gt;
&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;apt&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;install&lt;/span&gt; build-essential qtbase5-dev&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Añadimos al &lt;code&gt;sources.list&lt;/code&gt; el repositorio de bullseye-backports y con el siguiente comando podremos ver las versiones disponibles del kernel:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;      ~/kernel$ sudo apt policy linux-source&lt;br /&gt;linux-source:&lt;br /&gt;  Instalados: (ninguno)&lt;br /&gt;  Candidato:  5.10.149-2&lt;br /&gt;  Tabla de versión:&lt;br /&gt;     6.0.3-1~bpo11+1 100&lt;br /&gt;        100 http://deb.debian.org/debian bullseye-backports/main amd64 Packages&lt;br /&gt;     5.19.11-1~bpo11+1 100&lt;br /&gt;        100 http://deb.debian.org/debian bullseye-backports/main amd64 Packages&lt;br /&gt;     5.18.16-1~bpo11+1 100&lt;br /&gt;        100 http://deb.debian.org/debian bullseye-backports/main amd64 Packages&lt;br /&gt;     5.10.149-2 500&lt;br /&gt;        500 http://security.debian.org/debian-security bullseye-security/main amd64 Packages&lt;br /&gt;     5.10.140-1 500&lt;br /&gt;        500 http://deb.debian.org/debian bullseye/main amd64 Packages&lt;br /&gt;     5.10.136-1 500&lt;br /&gt;        500 http://security.debian.org/debian-security bullseye-security/main amd64 Packages&lt;br /&gt;     5.10.127-2 500&lt;br /&gt;        500 http://deb.debian.org/debian bullseye/main amd64 Packages&lt;br /&gt;        500 http://security.debian.org/debian-security bullseye-security/main amd64 Packages&lt;br /&gt;     5.10.120-1 500&lt;br /&gt;        500 http://security.debian.org/debian-security bullseye-security/main amd64 Packages&lt;br /&gt;     5.10.113-1 500&lt;br /&gt;        500 http://security.debian.org/debian-security bullseye-security/main amd64 Packages&lt;br /&gt;     5.10.103-1 500&lt;br /&gt;        500 http://security.debian.org/debian-security bullseye-security/main amd64 Packages&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;usaremos la versión del kernel 6.0.3.1. Para descargar el kernel con la versión que vamos a utilizar, usamos el siguiente comando:&lt;/p&gt;
&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;apt&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;install&lt;/span&gt; linux-source&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;6.0&lt;/span&gt;.3-1~bpo11+1&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;movemos a nuestro directorio el archivo que se ha descargado. A mí se me ha descargado en &lt;em&gt;/usr/src&lt;/em&gt;:&lt;/p&gt;
&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;mv&lt;/span&gt; /usr/src/linux-source-6.0.tar.xz ./&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Tenemos que desempaquetarlo, para ello usaremos tar:&lt;/p&gt;
&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token function&quot;&gt;tar&lt;/span&gt; -xf ./linux-source-6.0.tar.xz&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Como podemos ver, ya tenemos listo el kernel para trabajar con él.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://reeseschultz.github.io/img/ASO-P6.1.png&quot; alt=&quot;ASO-P6.1.png&quot; /&gt;&lt;/p&gt;
&lt;p&gt;A la hora de compilar el kernel, necesitamos el archivo .config el cual se van a cargar de forma estática los modulos del kernel. Cogeremos de referencia el &lt;code&gt;.config&lt;/code&gt; de nuestro kernel. Ejecutaremos el siguiente comando para ello:&lt;/p&gt;
&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token function&quot;&gt;make&lt;/span&gt; oldconfig&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Al ejecutar el make, nos pregunta si queremos incluir componentes adicionales, como la idea es hacer el kernel lo más pequeño posible, le daremos a todo que no. Como podemos ver, en el primer comando muestra los módulos que se han enlazado estáticamente(=y) y el segundo los que se han enlazado dinámicamente(=m).&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://reeseschultz.github.io/img/ASO-P6.2.png&quot; alt=&quot;ASO-P6.2.png&quot; /&gt;&lt;/p&gt;
&lt;p&gt;Como podemos apreciar son un total de unos 5700 módulos enlazados, para seguir quitando módulos, usaremos el siguiente comando para quitar aquellos que no están activos:&lt;/p&gt;
&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token function&quot;&gt;make&lt;/span&gt; localmodconfig&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Cuando se ejecuta el comando, vuelve a preguntar si queremos enlazar algun componente, para seguir descartando componentes, le he seguido dando a no. Volvemos a contar cuantos módulos tenemos:&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://reeseschultz.github.io/img/ASO-P6.3.png&quot; alt=&quot;ASO-P6.3.png&quot; /&gt;&lt;/p&gt;
&lt;p&gt;Ahora, ya tenemos menos de 2000 módulos enlazados, sigue siendo una cantidad alta pero hemos reducido a más de la mitad los módulos enlazados.&lt;/p&gt;
&lt;p&gt;Dicho esto, empezaremos nuestra primera compilación, así verificaremos que funciona todo.&lt;/p&gt;
&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;alemd@debian:~/kernel/linux-source-6.0$ &lt;span class=&quot;token function&quot;&gt;make&lt;/span&gt; -j4 bindeb-pkg&lt;br /&gt;  SYNC    include/config/auto.conf.cmd&lt;br /&gt;  UPD     include/config/kernel.release&lt;br /&gt;&lt;span class=&quot;token function&quot;&gt;sh&lt;/span&gt; ./scripts/package/mkdebian&lt;br /&gt;dpkg-buildpackage -r&lt;span class=&quot;token string&quot;&gt;&quot;fakeroot -u&quot;&lt;/span&gt; -a&lt;span class=&quot;token variable&quot;&gt;&lt;span class=&quot;token variable&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;cat&lt;/span&gt; debian/arch&lt;span class=&quot;token variable&quot;&gt;)&lt;/span&gt;&lt;/span&gt;  -b -nc -uc&lt;br /&gt;dpkg-buildpackage: información: paquete fuente linux-upstream&lt;br /&gt;dpkg-buildpackage: información: versión de las fuentes &lt;span class=&quot;token number&quot;&gt;6.0&lt;/span&gt;.3-1&lt;br /&gt;dpkg-buildpackage: información: distribución de las fuentes bullseye&lt;br /&gt;dpkg-buildpackage: información: fuentes modificadas por alemd &lt;span class=&quot;token operator&quot;&gt;&amp;lt;&lt;/span&gt;alemd@debian&lt;span class=&quot;token operator&quot;&gt;&gt;&lt;/span&gt;&lt;br /&gt;dpkg-buildpackage: información: arquitectura del sistema amd64&lt;br /&gt; dpkg-source --before-build &lt;span class=&quot;token builtin class-name&quot;&gt;.&lt;/span&gt;&lt;br /&gt; debian/rules binary&lt;br /&gt;&lt;span class=&quot;token function&quot;&gt;make&lt;/span&gt; &lt;span class=&quot;token assign-left variable&quot;&gt;KERNELRELEASE&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;6.0&lt;/span&gt;.3 &lt;span class=&quot;token assign-left variable&quot;&gt;ARCH&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;x86 	&lt;span class=&quot;token assign-left variable&quot;&gt;KBUILD_BUILD_VERSION&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt; -f ./Makefile&lt;br /&gt;  SYSHDR  arch/x86/include/generated/uapi/asm/unistd_32.h&lt;br /&gt;  SYSHDR  arch/x86/include/generated/uapi/asm/unistd_64.h&lt;br /&gt;  WRAP    arch/x86/include/generated/uapi/asm/bpf_perf_event.h&lt;br /&gt;  WRAP    arch/x86/include/generated/uapi/asm/errno.h&lt;br /&gt;  HOSTCC  arch/x86/tools/relocs_32.o&lt;br /&gt;  WRAP    arch/x86/include/generated/uapi/asm/fcntl.h&lt;br /&gt;  WRAP    arch/x86/include/generated/uapi/asm/ioctl.h&lt;br /&gt;  WRAP    arch/x86/include/generated/uapi/asm/ioctls.h&lt;br /&gt;  WRAP    arch/x86/include/generated/uapi/asm/ipcbuf.h&lt;br /&gt;  WRAP    arch/x86/include/generated/uapi/asm/param.h&lt;br /&gt;  WRAP    arch/x86/include/generated/uapi/asm/poll.h&lt;br /&gt;  WRAP    arch/x86/include/generated/uapi/asm/resource.h&lt;br /&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Una vez compilado el kernel, instalaremos el paquete .deb que se ha generado con el siguiente comando:&lt;/p&gt;
&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; dpkg -i &lt;span class=&quot;token punctuation&quot;&gt;..&lt;/span&gt;/linux-image-6.0.3_6.0.3-1_amd64.deb&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Ahora que está instalado el kernel, probaremos que funciona, para ello tendremos que reiniciar nuestra máquina y en &lt;em&gt;Advanced Options for Debian GNU/Linux&lt;/em&gt; seleccionaremos el nuevo kernel. Probaremos que todo funciona correctamente y volveremos a reiniciar y entraremos con el kernel que usamos habitualmente. Como podemos comprobar después de reiniciar, estamos usando el kernel 6.0.3.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://reeseschultz.github.io/img/ASO-P6.4.png&quot; alt=&quot;ASO-P6.4.png&quot; /&gt;&lt;/p&gt;
&lt;p&gt;Ahora, realizaremos una nueva compilación y antes que nada, eliminaremos los ficheros residuales de la compilación. Para ello utilizaremos el siguiente comando.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://reeseschultz.github.io/img/ASO-P6.5.png&quot; alt=&quot;ASO-P6.5.png&quot; /&gt;&lt;/p&gt;
&lt;p&gt;Para esta compilación, no vamos a usar los parametros &lt;em&gt;oldconfig&lt;/em&gt; ni &lt;em&gt;localmodconfig&lt;/em&gt;, usaremos &lt;em&gt;xconfig&lt;/em&gt; que es una aplicación gráfica para instalar los componentes a mano. Primero que nada instalaremos una dependencia:&lt;/p&gt;
&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;apt&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;install&lt;/span&gt; pkg-config&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Ahora procederemos a hacer el make xconfig, nos aparecerá una ventana como la de la siguiente imagen y simplemente tenemos que quitar los módulos que no vayamos a usar en el kernel desenmarcando las casillas. Es un proceso largo y lento pero es sencillo de hacer.&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://reeseschultz.github.io/img/ASO-P6.6.png&quot; alt=&quot;ASO-P6.6.png&quot; /&gt;&lt;/p&gt;
&lt;p&gt;Volvemos a contar cuantos módulos tiene el kernel:&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://reeseschultz.github.io/img/ASO-P6.7.png&quot; alt=&quot;ASO-P6.7.png&quot; /&gt;&lt;/p&gt;
&lt;h2 id=&quot;documento-realizado-por%3A&quot; tabindex=&quot;-1&quot;&gt;&lt;strong&gt;Documento realizado por:&lt;/strong&gt;&lt;/h2&gt;
&lt;p&gt;✒️ &lt;strong&gt;Alejandro Montes Delgado&lt;/strong&gt; - &lt;em&gt;2º ASIR&lt;/em&gt;&lt;/p&gt;
</content>
	</entry>
	
	<entry>
		<title>Ejercicios de modificación de parámetros del kérnel</title>
		<link href="https://reeseschultz.github.io/post/ejercicios-de-modificacion-de-parametros-del-kernel/"/>
		<updated>2022-11-08T00:00:00Z</updated>
		<id>https://reeseschultz.github.io/post/ejercicios-de-modificacion-de-parametros-del-kernel/</id>
		<content type="html">&lt;h3 id=&quot;1.-deshabilita-apparmor-en-el-arranque.&quot; tabindex=&quot;-1&quot;&gt;1. Deshabilita apparmor en el arranque.&lt;/h3&gt;
&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;$ &lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; systemctl disable apparmor&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&quot;2.-deshabilita-si-es-posible-el-kernel-mode-setting-(ksm)-de-la-tarjeta-gr%C3%A1fica.&quot; tabindex=&quot;-1&quot;&gt;2. Deshabilita si es posible el Kernel Mode Setting (KSM) de la tarjeta gráfica.&lt;/h3&gt;
&lt;p&gt;Viene desactivado por defecto ya que mi tarjeta gráfica es amd.&lt;/p&gt;
&lt;h3 id=&quot;3.-cambia-provisionalmente-la-swappiness-para-que-la-swap-de-tu-equipo-se-active-cuando-se-use-m%C3%A1s-de-un-90%25-de-la-ram.&quot; tabindex=&quot;-1&quot;&gt;3. Cambia provisionalmente la swappiness para que la swap de tu equipo se active cuando se use más de un 90% de la RAM.&lt;/h3&gt;
&lt;p&gt;Con el cat vemos el valor por defecto y con el siguiente comando lo cambiamos:&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://reeseschultz.github.io/img/ASO-P5.1.png&quot; alt=&quot;img&quot; /&gt;&lt;/p&gt;
&lt;h3 id=&quot;4.-haz-que-el-cambio-de-la-swappiness-sea-permanente.&quot; tabindex=&quot;-1&quot;&gt;4. Haz que el cambio de la swappiness sea permanente.&lt;/h3&gt;
&lt;p&gt;Para hacer el cambio permanente, tenemos que editar el fichero &lt;code&gt;sysctl.conf&lt;/code&gt;:&lt;/p&gt;
&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;$ &lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;nano&lt;/span&gt; /etc/sysctl.conf&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;añadimos la siguiente línea en el archivo:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;vm.swappiness = 90&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&quot;5.-muestra-el-valor-del-bit-de-forward-para-ipv6.&quot; tabindex=&quot;-1&quot;&gt;5. Muestra el valor del bit de forward para IPv6.&lt;/h3&gt;
&lt;p&gt;cat /proc/sys/net/ipv6/conf/all/forwarding
&lt;img src=&quot;https://reeseschultz.github.io/img/ASO-P5.2.png&quot; alt=&quot;img&quot; /&gt;&lt;/p&gt;
&lt;h3 id=&quot;6.-deshabilita-completamente-las-magic-sysrq-en-el-arranque-y-vuelve-a-habilitarlas-despu%C3%A9s-de-reiniciar.&quot; tabindex=&quot;-1&quot;&gt;6. Deshabilita completamente las Magic Sysrq en el arranque y vuelve a habilitarlas después de reiniciar.&lt;/h3&gt;
&lt;p&gt;Para deshabilitar las Magic Sysrq usamos el siguiente comando.&lt;/p&gt;
&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;$ sysctl -w kernel.sysrq&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;0&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Si lo queremos volver a activar simplemente lo ponemos a 1 de nuevo:&lt;/p&gt;
&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;$ sysctl -w kernel.sysrq&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;1&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&quot;documento-realizado-por%3A&quot; tabindex=&quot;-1&quot;&gt;&lt;strong&gt;Documento realizado por:&lt;/strong&gt;&lt;/h2&gt;
&lt;p&gt;✒️ &lt;strong&gt;Alejandro Montes Delgado&lt;/strong&gt; - &lt;em&gt;2º ASIR&lt;/em&gt;&lt;/p&gt;
</content>
	</entry>
	
	<entry>
		<title>Ejercicios de manejo de módulos</title>
		<link href="https://reeseschultz.github.io/post/ejercicios-de-manejo-de-modulos/"/>
		<updated>2022-11-03T00:00:00Z</updated>
		<id>https://reeseschultz.github.io/post/ejercicios-de-manejo-de-modulos/</id>
		<content type="html">&lt;h3 id=&quot;1.-comprueba-los-m%C3%B3dulos-cargados-en-tu-equipo.&quot; tabindex=&quot;-1&quot;&gt;1. Comprueba los módulos cargados en tu equipo.&lt;/h3&gt;
&lt;p&gt;Para ver los módulos cargados de mi equipo, usamos el siguiente comando:&lt;/p&gt;
&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;$ lsmod&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&quot;https://reeseschultz.github.io/img/ASO-P4.1.png&quot; alt=&quot;Imagen no encontrada: /img/ASO-P4.1.png&quot; title=&quot;Imagen no encontrada: /img/ASO-P4.1.png&quot; /&gt;
lsmod, lo que hace es leer el contenido del archivo /proc/modules.&lt;/p&gt;
&lt;h3 id=&quot;2.-cuenta-el-n%C3%BAmero-de-m%C3%B3dulos-disponibles-en-el-n%C3%BAcleo-que-est%C3%A1s-usando.&quot; tabindex=&quot;-1&quot;&gt;2. Cuenta el número de módulos disponibles en el núcleo que estás usando.&lt;/h3&gt;
&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;$ &lt;span class=&quot;token function&quot;&gt;ls&lt;/span&gt; -R /lib/modules/&lt;span class=&quot;token variable&quot;&gt;&lt;span class=&quot;token variable&quot;&gt;$(&lt;/span&gt;&lt;span class=&quot;token function&quot;&gt;uname&lt;/span&gt; -r&lt;span class=&quot;token variable&quot;&gt;)&lt;/span&gt;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;|&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;wc&lt;/span&gt; -l&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&quot;https://reeseschultz.github.io/img/ASO-P4.2.png&quot; alt=&quot;ASO-P4.2.png&quot; /&gt;&lt;/p&gt;
&lt;h3 id=&quot;3.-conecta-un-l%C3%A1piz-usb-y-observa-la-salida-de-la-instrucci%C3%B3n-sudo-dmesg.&quot; tabindex=&quot;-1&quot;&gt;3. Conecta un lápiz USB y observa la salida de la instrucción sudo dmesg.&lt;/h3&gt;
&lt;p&gt;he ejecutado el siguiente comando:&lt;/p&gt;
&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;$ &lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;dmesg&lt;/span&gt; -w&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;lo que hace el parametro -w es que se actualiza en el momento el comando, y al añadir el Pen-Drive se han añadido estas líneas:&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://reeseschultz.github.io/img/ASO-P4-3.png&quot; alt=&quot;ASO-P4.3.png&quot; /&gt;&lt;/p&gt;
&lt;h3 id=&quot;4.-elimina-el-m%C3%B3dulo-correspondiente-a-alg%C3%BAn-dispotivo-no-esencial-y-comprueba-qu%C3%A9-ocurre.-vuelve-a-cargarlo.&quot; tabindex=&quot;-1&quot;&gt;4. Elimina el módulo correspondiente a algún dispotivo no esencial y comprueba qué ocurre. Vuelve a cargarlo.&lt;/h3&gt;
&lt;p&gt;Vamos a eliminar el modulo usb storage, pero al hacer un lsmod vemos que usb_storage depende de uas, entonces, tenemos que eliminar el modulo uas primero y despues el de usb-storage.&lt;/p&gt;
&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;$ modprobe -r uas&lt;br /&gt;$ modprobe -r usb_storage&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&quot;https://reeseschultz.github.io/img/ASO-P4.4.png&quot; alt=&quot;ASO-P4.4.png&quot; /&gt;&lt;/p&gt;
&lt;h3 id=&quot;5.-selecciona-un-m%C3%B3dulo-que-est%C3%A9-en-uso-en-tu-equipo-y-configura-el-arranque-para-que-no-se-cargue-autom%C3%A1ticamente.&quot; tabindex=&quot;-1&quot;&gt;5. Selecciona un módulo que esté en uso en tu equipo y configura el arranque para que no se cargue automáticamente.&lt;/h3&gt;
&lt;p&gt;Editamos el siguiente fichero:&lt;/p&gt;
&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;$ &lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;nano&lt;/span&gt; /etc/modprobe.d/blacklist.conf&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Añadimos lo siguiente:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;blacklist [nombre_modulo]&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Una vez hecho esto ejecutamos el siguiente comando para actualizar:&lt;/p&gt;
&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;$ &lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; update-initramfs -u&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&quot;6.-carga-el-m%C3%B3dulo-loop%2C-obt%C3%A9n-informaci%C3%B3n-de-qu%C3%A9-es-y-para-qu%C3%A9-sirve.-lista-el-contenido-de-%2Fsys%2Fmodules%2Floop%2Fparameters-y-configura-el-equipo-para-que-se-puedan-cargar-como-m%C3%A1ximo-12-dispositvos-loop-la-pr%C3%B3xima-vez-que-se-arranque.&quot; tabindex=&quot;-1&quot;&gt;6. Carga el módulo loop, obtén información de qué es y para qué sirve. Lista el contenido de /sys/modules/loop/parameters y configura el equipo para que se puedan cargar como máximo 12 dispositvos loop la próxima vez que se arranque.&lt;/h3&gt;
&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;$ &lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; modprobe loop&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&quot;https://reeseschultz.github.io/img/ASO-P4.6.png&quot; alt=&quot;ASO-P4.6.png&quot; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://reeseschultz.github.io/img/ASO-P4.7.png&quot; alt=&quot;ASO-P4.7.png&quot; /&gt;&lt;/p&gt;
&lt;p&gt;editamos el siguiente fichero:&lt;/p&gt;
&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;$ &lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;nano&lt;/span&gt; /etc/modules&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;añadimos lo siguiente:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;options loop max_loop=12&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Una vez hecho esto ejecutamos el siguiente comando para actualizar:&lt;/p&gt;
&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;$ &lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; update-initramfs -u&lt;/code&gt;&lt;/pre&gt;
&lt;h2 id=&quot;documento-realizado-por%3A&quot; tabindex=&quot;-1&quot;&gt;&lt;strong&gt;Documento realizado por:&lt;/strong&gt;&lt;/h2&gt;
&lt;p&gt;✒️ &lt;strong&gt;Alejandro Montes Delgado&lt;/strong&gt; - &lt;em&gt;2º ASIR&lt;/em&gt;&lt;/p&gt;
</content>
	</entry>
	
	<entry>
		<title>Creación de instancias desde OSC</title>
		<link href="https://reeseschultz.github.io/post/creacion-de-instancias-desde-osc/"/>
		<updated>2022-11-03T00:00:00Z</updated>
		<id>https://reeseschultz.github.io/post/creacion-de-instancias-desde-osc/</id>
		<content type="html">&lt;ol&gt;
&lt;li&gt;Instala el cliente de línea de comando de OpenStack cómo se muestra en &lt;a href=&quot;https://github.com/josedom24/curso_openstack_ies/blob/main/modulo1/osc.md&quot;&gt;Instalación y uso básico de OpenStack client (OSC)&lt;/a&gt;.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Primero vamos a crear un entorno virtual donde vamos a trabajar con OpenStack client, para ello instalaremos python y venv si es necesario.&lt;/p&gt;
&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;apt&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;install&lt;/span&gt; python3 python3-venv&lt;br /&gt;&lt;span class=&quot;token function&quot;&gt;mkdir&lt;/span&gt; venv&lt;br /&gt;&lt;span class=&quot;token builtin class-name&quot;&gt;cd&lt;/span&gt; venv&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Activamos el entorno virtual con el siguiente comando:&lt;/p&gt;
&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token function&quot;&gt;mkdir&lt;/span&gt; osc&lt;br /&gt;python3 -m venv osc&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Usamos el siguiente comando para instalar en el entorno virtual el cliente de openstack:&lt;/p&gt;
&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;pip &lt;span class=&quot;token function&quot;&gt;install&lt;/span&gt; python-openstackclient&lt;span class=&quot;token operator&quot;&gt;==&lt;/span&gt;&lt;span class=&quot;token number&quot;&gt;5.8&lt;/span&gt;.0&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&quot;3&quot;&gt;
&lt;li&gt;Descarga de Horizon tu fichero de credenciales, cargálo y ejecuta la instrucción &lt;code&gt;openstack server list&lt;/code&gt; para visualizar tus instancias.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Una vez descargado el fichero, realizamos lo siguiente:&lt;/p&gt;
&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;&lt;span class=&quot;token builtin class-name&quot;&gt;source&lt;/span&gt; crendenciales.sh&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;tendríamos que insertar la contraseña con la que entramos a openstack y ya podríamos interactuar con el servidor openstack.&lt;/p&gt;
&lt;ol start=&quot;5&quot;&gt;
&lt;li&gt;Vamos a crear una instancia y la vamos a configurar con &lt;a href=&quot;https://github.com/josedom24/curso_openstack_ies/blob/main/modulo3/cloudinit.md&quot;&gt;&lt;strong&gt;cloud-init&lt;/strong&gt;&lt;/a&gt;, para ello crea un fichero &lt;code&gt;cloud-config.yaml&lt;/code&gt; con el siguiente contenido:&lt;/li&gt;
&lt;/ol&gt;
&lt;pre class=&quot;language-yaml&quot;&gt;&lt;code class=&quot;language-yaml&quot;&gt;    &lt;span class=&quot;token comment&quot;&gt;#cloud-config&lt;/span&gt;&lt;br /&gt;         &lt;span class=&quot;token key atrule&quot;&gt;package_update&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean important&quot;&gt;true&lt;/span&gt;&lt;br /&gt;         &lt;span class=&quot;token key atrule&quot;&gt;package_upgrade&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean important&quot;&gt;true&lt;/span&gt;&lt;br /&gt;         &lt;span class=&quot;token key atrule&quot;&gt;preserve_hostname&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean important&quot;&gt;false&lt;/span&gt;&lt;br /&gt;         &lt;span class=&quot;token key atrule&quot;&gt;fqdn&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; test1.gonzalonazareno.org&lt;br /&gt;         &lt;span class=&quot;token key atrule&quot;&gt;hostname&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; prueba&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;alemd&lt;br /&gt;         &lt;span class=&quot;token comment&quot;&gt;# Crear un usuario y añadir clave pública ssh&lt;/span&gt;&lt;br /&gt;         &lt;span class=&quot;token key atrule&quot;&gt;users&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;br /&gt;           &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; jose&lt;br /&gt;             &lt;span class=&quot;token key atrule&quot;&gt;sudo&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; ALL=(ALL) NOPASSWD&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;ALL&lt;br /&gt;             &lt;span class=&quot;token key atrule&quot;&gt;shell&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; /bin/bash&lt;br /&gt;             &lt;span class=&quot;token key atrule&quot;&gt;passwd&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; asdasd&lt;br /&gt;             &lt;span class=&quot;token key atrule&quot;&gt;ssh_authorized_keys&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;br /&gt;             &lt;span class=&quot;token comment&quot;&gt;# Clave pública de nuestra máquina.&lt;/span&gt;&lt;br /&gt;               &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; ssh&lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt;rsa &lt;br /&gt;           &lt;span class=&quot;token punctuation&quot;&gt;-&lt;/span&gt; &lt;span class=&quot;token key atrule&quot;&gt;name&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; alemd&lt;br /&gt;             &lt;span class=&quot;token key atrule&quot;&gt;sudo&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; ALL=(ALL) NOPASSWD&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;ALL&lt;br /&gt;             &lt;span class=&quot;token key atrule&quot;&gt;shell&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; /bin/bash&lt;br /&gt;             &lt;span class=&quot;token key atrule&quot;&gt;passwd&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; usuario&lt;br /&gt;           &lt;span class=&quot;token comment&quot;&gt;#  ssh_authorized_keys:&lt;/span&gt;&lt;br /&gt;             &lt;span class=&quot;token comment&quot;&gt;# Clave pública de nuestra máquina.&lt;/span&gt;&lt;br /&gt;             &lt;span class=&quot;token comment&quot;&gt;#  - ssh-rsa &lt;/span&gt;&lt;br /&gt;&lt;br /&gt;         &lt;span class=&quot;token key atrule&quot;&gt;chpasswd&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt;&lt;br /&gt;           &lt;span class=&quot;token key atrule&quot;&gt;list&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token punctuation&quot;&gt;|&lt;/span&gt;&lt;span class=&quot;token scalar string&quot;&gt;&lt;br /&gt;             root:asdasd&lt;/span&gt;&lt;br /&gt;           &lt;span class=&quot;token key atrule&quot;&gt;expire&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;:&lt;/span&gt; &lt;span class=&quot;token boolean important&quot;&gt;False&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Modifica el fichero e indica un nombre a la máquina, crea otro usuario y cambia las contraseñas.&lt;/p&gt;
&lt;p&gt;Este fichero actualizará la paquetería de la instancia, configurará el FQDN de la instancia, creará un nuevo usuario y cambiará la contraseña del usuario &lt;code&gt;root&lt;/code&gt;.&lt;/p&gt;
&lt;ol start=&quot;4&quot;&gt;
&lt;li&gt;Siguiendo el apartado &lt;a href=&quot;https://github.com/josedom24/curso_openstack_ies/blob/main/modulo3/osc_nova.md&quot;&gt;Gestión de instancia con OpenStack client (OSC)&lt;/a&gt;, visualiza con el OSC los flavors disponibles, imágenes disponibles, claves disponibles, reglas de cortafuegos,…&lt;/li&gt;
&lt;li&gt;Crea una nueva instancia usando el comando que encontrarás en la sección &lt;a href=&quot;https://github.com/josedom24/curso_openstack_ies/blob/main/modulo1/osc.md&quot;&gt;Configuración de instancias con cloud-init&lt;/a&gt;.&lt;/li&gt;
&lt;li&gt;Añade una IP flotante a la instancia para ello puedes usar los comandos que encuentras en &lt;a href=&quot;https://github.com/josedom24/curso_openstack_ies/blob/main/modulo3/osc_nova.md&quot;&gt;Gestión de instancia con OpenStack client (OSC)&lt;/a&gt;.&lt;/li&gt;
&lt;li&gt;Accede por ssh (recuerda usar el usuario que has creado con cloud-init) a la instancia.&lt;/li&gt;
&lt;/ol&gt;
&lt;h2 id=&quot;documento-realizado-por%3A&quot; tabindex=&quot;-1&quot;&gt;&lt;strong&gt;Documento realizado por:&lt;/strong&gt;&lt;/h2&gt;
&lt;p&gt;✒️ &lt;strong&gt;Alejandro Montes Delgado&lt;/strong&gt; - &lt;em&gt;2º ASIR&lt;/em&gt;&lt;/p&gt;
</content>
	</entry>
	
	<entry>
		<title>Ejercicios gestión de paquetería</title>
		<link href="https://reeseschultz.github.io/post/ejercicios-gestion-de-paqueteria/"/>
		<updated>2022-10-18T00:00:00Z</updated>
		<id>https://reeseschultz.github.io/post/ejercicios-gestion-de-paqueteria/</id>
		<content type="html">&lt;h1 id=&quot;trabajo-con-apt%2C-aptitude%2C-dpkg&quot; tabindex=&quot;-1&quot;&gt;Trabajo con apt, aptitude, dpkg&lt;/h1&gt;
&lt;h4 id=&quot;prepara-una-m%C3%A1quina-virtual-con-debian-bullseye%2C-realizar-las-siguientes-acciones%3A&quot; tabindex=&quot;-1&quot;&gt;Prepara una máquina virtual con Debian bullseye, realizar las siguientes acciones:&lt;/h4&gt;
&lt;h3 id=&quot;1.-que-acciones-consigo-al-realizar-apt-update-y-apt-upgrade.-explica-detalladamente.&quot; tabindex=&quot;-1&quot;&gt;1. Que acciones consigo al realizar apt update y apt upgrade. Explica detalladamente.&lt;/h3&gt;
&lt;p&gt;Al hacer un apt update, actualizas la lista de paquetes que hay disponible y sus versiones en los repositorios aunque no realiza ninguna instalación.
Después de hacer un apt update, hay que hacer un apt upgrade, permite instalar si no tiene instalado y actualiza versiones de los paquetes ya instalados.&lt;/p&gt;
&lt;h3 id=&quot;2.-lista-la-relaci%C3%B3n-de-paquetes-que-pueden-ser-actualizados.-%C2%BFqu%C3%A9-informaci%C3%B3n-puedes-sacar-a-tenor-de-lo-mostrado-en-el-listado%3F.&quot; tabindex=&quot;-1&quot;&gt;2. Lista la relación de paquetes que pueden ser actualizados. ¿Qué información puedes sacar a tenor de lo mostrado en el listado?.&lt;/h3&gt;
&lt;p&gt;Para mostrar los paquetes que pueden ser instalados, se usa el siguiente comando:&lt;/p&gt;
&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;$ &lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;apt&lt;/span&gt; list --upgradable&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Muestro captura del comando ejecutado en mi máquina.
&lt;img src=&quot;https://reeseschultz.github.io/img/ASO-P3.1.png&quot; alt=&quot;img&quot; /&gt;&lt;/p&gt;
&lt;p&gt;En la línea el resaltado verde apunta al nombre del paquete. oldstable indica que no es de la versión stable de debian(esa máquina es debian buster). Los números siguientes indican la versión del paquete y lo siguiente a la arquitectura del paquete(amd64).&lt;/p&gt;
&lt;h3 id=&quot;3.-indica-la-versi%C3%B3n-instalada%2C-candidata-as%C3%AD-como-la-prioridad-del-paquete-openssh-client.&quot; tabindex=&quot;-1&quot;&gt;3. Indica la versión instalada, candidata así como la prioridad del paquete openssh-client.&lt;/h3&gt;
&lt;p&gt;Para ver la versión instalada y la candidata de un paquete usamos el siguiente comando:&lt;/p&gt;
&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;$ &lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;apt&lt;/span&gt; policy openssh-client&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;En la siguiente captura veremos la ejecución del comando:
&lt;img src=&quot;https://reeseschultz.github.io/img/ASO-P3.2.png&quot; alt=&quot;img&quot; /&gt;&lt;/p&gt;
&lt;p&gt;Como indica la imagen, la versión instalada es la 1.7.9, la candidata es la misma y la prioridad es 500.&lt;/p&gt;
&lt;h3 id=&quot;4.-%C2%BFc%C3%B3mo-puedes-sacar-informaci%C3%B3n-de-un-paquete-oficial-instalado-o-que-no-este-instalado%3F&quot; tabindex=&quot;-1&quot;&gt;4. ¿Cómo puedes sacar información de un paquete oficial instalado o que no este instalado?&lt;/h3&gt;
&lt;p&gt;para ver información de un paquete oficial instalado, usariamos dpkg -s nombre_paquete.&lt;/p&gt;
&lt;p&gt;Si no está instalado, se puede ver información de un paquete usando apt show nombre_paquete&lt;/p&gt;
&lt;h3 id=&quot;5.-saca-toda-la-informaci%C3%B3n-que-puedas-del-paquete-openssh-client-que-tienes-actualmente-instalado-en-tu-m%C3%A1quina.&quot; tabindex=&quot;-1&quot;&gt;5. Saca toda la información que puedas del paquete openssh-client que tienes actualmente instalado en tu máquina.&lt;/h3&gt;
&lt;p&gt;Para ver mucha información del paquete podemos usar &lt;em&gt;dpkg -s openssh-client&lt;/em&gt;.&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;Package: openssh-client&lt;br /&gt;Status: install ok installed&lt;br /&gt;Priority: standard&lt;br /&gt;Section: net&lt;br /&gt;Installed-Size: 4298&lt;br /&gt;Maintainer: Debian OpenSSH Maintainers &amp;lt;debian-ssh@lists.debian.org&gt;&lt;br /&gt;Architecture: amd64&lt;br /&gt;Multi-Arch: foreign&lt;br /&gt;Source: openssh&lt;br /&gt;Version: 1:8.4p1-5+deb11u1&lt;br /&gt;Replaces: openssh-sk-helper, ssh, ssh-krb5&lt;br /&gt;Provides: rsh-client, ssh-client&lt;br /&gt;Depends: adduser (&gt;= 3.10), dpkg (&gt;= 1.7.0), passwd, libc6 (&gt;= 2.26), libedit2 (&gt;= 2.11-20080614-0), libfido2-1 (&gt;= 1.5.0), libgssapi-krb5-2 (&gt;= 1.17), libselinux1 (&gt;= 3.1~), libssl1.1 (&gt;= 1.1.1), zlib1g (&gt;= 1:1.1.4)&lt;br /&gt;Recommends: xauth&lt;br /&gt;Suggests: keychain, libpam-ssh, monkeysphere, ssh-askpass&lt;br /&gt;Breaks: openssh-sk-helper&lt;br /&gt;Conflicts: sftp&lt;br /&gt;Conffiles:&lt;br /&gt; /etc/ssh/ssh_config 8a5bddc82befb71d8ef34cc903d3d077&lt;br /&gt;Description: secure shell (SSH) client, for secure access to remote machines&lt;br /&gt; This is the portable version of OpenSSH, a free implementation of&lt;br /&gt; the Secure Shell protocol as specified by the IETF secsh working&lt;br /&gt; group.&lt;br /&gt; .&lt;br /&gt; Ssh (Secure Shell) is a program for logging into a remote machine&lt;br /&gt; and for executing commands on a remote machine.&lt;br /&gt; It provides secure encrypted communications between two untrusted&lt;br /&gt; hosts over an insecure network. X11 connections and arbitrary TCP/IP&lt;br /&gt; ports can also be forwarded over the secure channel.&lt;br /&gt; It can be used to provide applications with a secure communication&lt;br /&gt; channel.&lt;br /&gt; .&lt;br /&gt; This package provides the ssh, scp and sftp clients, the ssh-agent&lt;br /&gt; and ssh-add programs to make public key authentication more convenient,&lt;br /&gt; and the ssh-keygen, ssh-keyscan, ssh-copy-id and ssh-argv0 utilities.&lt;br /&gt; .&lt;br /&gt; In some countries it may be illegal to use any encryption at all&lt;br /&gt; without a special permit.&lt;br /&gt; .&lt;br /&gt; ssh replaces the insecure rsh, rcp and rlogin programs, which are&lt;br /&gt; obsolete for most purposes.&lt;br /&gt;Homepage: http://www.openssh.com/&lt;br /&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Como podemos ver, nos muestra una descripción, si está instalado, la prioridad, el directorio del fichero de configuración…&lt;/p&gt;
&lt;h3 id=&quot;6.-saca-toda-la-informaci%C3%B3n-que-puedas-del-paquete-openssh-client-candidato-a-actualizar-en-tu-m%C3%A1quina.&quot; tabindex=&quot;-1&quot;&gt;6. Saca toda la información que puedas del paquete openssh-client candidato a actualizar en tu máquina.&lt;/h3&gt;
&lt;h3 id=&quot;7.-lista-todo-el-contenido-referente-al-paquete-openssh-client-actual-de-tu-m%C3%A1quina.-utiliza-para-ello-tanto-dpkg-como-apt.&quot; tabindex=&quot;-1&quot;&gt;7. Lista todo el contenido referente al paquete openssh-client actual de tu máquina. Utiliza para ello tanto dpkg como apt.&lt;/h3&gt;
&lt;p&gt;Para listar el contenido del paquete con dpkg usamos el siguiente comando:&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://reeseschultz.github.io/img/ASO-P3.3.png&quot; alt=&quot;imagen&quot; /&gt;&lt;/p&gt;
&lt;p&gt;Para listar el contenido del paquete con apt usamos el siguiente comando:&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://reeseschultz.github.io/img/ASO-P3.4.png&quot; alt=&quot;imagen&quot; /&gt;&lt;/p&gt;
&lt;h3 id=&quot;8.-listar-el-contenido-de-un-paquete-sin-la-necesidad-de-instalarlo-o-descargarlo.&quot; tabindex=&quot;-1&quot;&gt;8. Listar el contenido de un paquete sin la necesidad de instalarlo o descargarlo.&lt;/h3&gt;
&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;$ &lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; apt-file list nombre_paquete&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&quot;9.-simula-la-instalaci%C3%B3n-del-paquete-openssh-client.&quot; tabindex=&quot;-1&quot;&gt;9. Simula la instalación del paquete openssh-client.&lt;/h3&gt;
&lt;p&gt;Para simular una instalación con apt, se usa el parámetro -s. A continuación, muestro la ejecución del comando:&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;https://reeseschultz.github.io/img/ASO-P3.5.png&quot; alt=&quot;imagen&quot; /&gt;&lt;/p&gt;
&lt;h3 id=&quot;10.-%C2%BFqu%C3%A9-comando-te-informa-de-los-posible-bugs-que-presente-un-determinado-paquete%3F&quot; tabindex=&quot;-1&quot;&gt;10. ¿Qué comando te informa de los posible bugs que presente un determinado paquete?&lt;/h3&gt;
&lt;p&gt;El comando que informa sobre los posibles bugs de un paquete es el siguiente:&lt;/p&gt;
&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;$ &lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; apt-listbugs -s all nombre_paquete&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&quot;11.-despu%C3%A9s-de-realizar-un-apt-update-%26%26-apt-upgrade.-si-quisieras-actualizar-%C3%BAnicamente-los-paquetes-que-tienen-de-cadena-openssh.-%C2%BFqu%C3%A9-procedimiento-seguir%C3%ADas%3F.-realiza-esta-acci%C3%B3n%2C-con-las-estructuras-repetitivas-que-te-ofrece-bash%2C-as%C3%AD-como-con-el-comando-xargs.&quot; tabindex=&quot;-1&quot;&gt;11. Después de realizar un apt update &amp;amp;&amp;amp; apt upgrade. Si quisieras actualizar únicamente los paquetes que tienen de cadena openssh. ¿Qué procedimiento seguirías?. Realiza esta acción, con las estructuras repetitivas que te ofrece bash, así como con el comando xargs.&lt;/h3&gt;
&lt;h3 id=&quot;12.-%C2%BFc%C3%B3mo-encontrar%C3%ADas-qu%C3%A9-paquetes-dependen-de-un-paquete-espec%C3%ADfico.&quot; tabindex=&quot;-1&quot;&gt;12. ¿Cómo encontrarías qué paquetes dependen de un paquete específico.&lt;/h3&gt;
&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;$ &lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;apt-cache&lt;/span&gt; depends nombre_paquete&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Y para dependencias inversas:&lt;/p&gt;
&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;$ &lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;apt-cache&lt;/span&gt; rdepends nombre_paquete&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&quot;13.-%C2%BFc%C3%B3mo-proceder%C3%ADas-para-encontrar-el-paquete-al-que-pertenece-un-determinado-fichero%3F&quot; tabindex=&quot;-1&quot;&gt;13. ¿Cómo procederías para encontrar el paquete al que pertenece un determinado fichero?&lt;/h3&gt;
&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;$ apt-file search ruta&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&quot;14.-%C2%BFque-procedimientos-emplear%C3%ADas-para-liberar-la-cach%C3%A9-en-cuanto-a-descargas-de-paqueter%C3%ADa%3F&quot; tabindex=&quot;-1&quot;&gt;14. ¿Que procedimientos emplearías para liberar la caché en cuanto a descargas de paquetería?&lt;/h3&gt;
&lt;p&gt;Con &lt;code&gt;apt autoclean&lt;/code&gt; elimina paquetes de la caché que tiene una versión mas moderna.&lt;/p&gt;
&lt;h3 id=&quot;15.-realiza-la-instalaci%C3%B3n-del-paquete-keyboard-configuration-pasando-previamente-los-valores-de-los-par%C3%A1metros-de-configuraci%C3%B3n-como-variables-de-entorno.&quot; tabindex=&quot;-1&quot;&gt;15. Realiza la instalación del paquete keyboard-configuration pasando previamente los valores de los parámetros de configuración como variables de entorno.&lt;/h3&gt;
&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;$ debconf keyboard-configuration&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&quot;16.-reconfigura-el-paquete-locales-de-tu-equipo%2C-a%C3%B1adiendo-una-localizaci%C3%B3n-que-no-exista-previamente.-comprueba-a-modificar-las-variables-de-entorno-correspondientes-para-que-la-sesi%C3%B3n-del-usuario-utilice-otra-localizaci%C3%B3n.&quot; tabindex=&quot;-1&quot;&gt;16. Reconfigura el paquete locales de tu equipo, añadiendo una localización que no exista previamente. Comprueba a modificar las variables de entorno correspondientes para que la sesión del usuario utilice otra localización.&lt;/h3&gt;
&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;$ &lt;span class=&quot;token builtin class-name&quot;&gt;export&lt;/span&gt; &lt;span class=&quot;token assign-left variable&quot;&gt;&lt;span class=&quot;token environment constant&quot;&gt;LANG&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;en_GB.utf8&lt;br /&gt;$ &lt;span class=&quot;token builtin class-name&quot;&gt;export&lt;/span&gt; &lt;span class=&quot;token assign-left variable&quot;&gt;&lt;span class=&quot;token environment constant&quot;&gt;LANGUAGE&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;en_GB.utf8&lt;br /&gt;$ &lt;span class=&quot;token builtin class-name&quot;&gt;export&lt;/span&gt; &lt;span class=&quot;token assign-left variable&quot;&gt;&lt;span class=&quot;token environment constant&quot;&gt;LC_ALL&lt;/span&gt;&lt;/span&gt;&lt;span class=&quot;token operator&quot;&gt;=&lt;/span&gt;en_GB.utf8&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;$ &lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; dpkg-reconfigure locales -f --frontend Noninteractive&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&quot;17.-interrumpe-la-configuraci%C3%B3n-de-un-paquete-y-explica-los-pasos-a-dar-para-continuar-la-instalaci%C3%B3n.&quot; tabindex=&quot;-1&quot;&gt;17. Interrumpe la configuración de un paquete y explica los pasos a dar para continuar la instalación.&lt;/h3&gt;
&lt;p&gt;Probariamos con dpkg --configure -a. Si no funciona, tendríamos que limpiar la caché, apt clean y apt autoclean. Haríamos un apt-get update --fix-missing y apt-get install -f para recuperar las dependencias dañadas.&lt;/p&gt;
&lt;h3 id=&quot;18.-explica-la-instrucci%C3%B3n-que-utilizar%C3%ADas-para-hacer-una-actualizaci%C3%B3n-completa-de-todos-los-paquetes-de-tu-sistema-de-manera-completamente-no-interactiva&quot; tabindex=&quot;-1&quot;&gt;18. Explica la instrucción que utilizarías para hacer una actualización completa de todos los paquetes de tu sistema de manera completamente no interactiva&lt;/h3&gt;
&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;$ &lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;apt&lt;/span&gt; update &lt;span class=&quot;token operator&quot;&gt;&amp;amp;&amp;amp;&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;apt&lt;/span&gt; upgrade -y&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&quot;19.-bloquea-la-actualizaci%C3%B3n-de-determinados-paquetes.&quot; tabindex=&quot;-1&quot;&gt;19. Bloquea la actualización de determinados paquetes.&lt;/h3&gt;
&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;$ &lt;span class=&quot;token function&quot;&gt;apt&lt;/span&gt; mark hold paquete&lt;/code&gt;&lt;/pre&gt;
&lt;h1 id=&quot;trabajo-con-ficheros-.deb&quot; tabindex=&quot;-1&quot;&gt;Trabajo con ficheros .deb&lt;/h1&gt;
&lt;h3 id=&quot;1.-descarga-un-paquete-sin-instalarlo%2C-es-decir%2C-descarga-el-fichero-.deb-correspondiente.-indica-diferentes-formas-de-hacerlo.&quot; tabindex=&quot;-1&quot;&gt;1. Descarga un paquete sin instalarlo, es decir, descarga el fichero .deb correspondiente. Indica diferentes formas de hacerlo.&lt;/h3&gt;
&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;$ &lt;span class=&quot;token function&quot;&gt;wget&lt;/span&gt; url_paquete&lt;br /&gt;&lt;br /&gt;$ &lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;apt-get&lt;/span&gt; download nombrepaquete&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&quot;2.-%C2%BFc%C3%B3mo-puedes-ver-el-contenido%2C-que-no-extraerlo%2C-de-lo-que-se-instalar%C3%A1-en-el-sistema-de-un-paquete-deb%3F&quot; tabindex=&quot;-1&quot;&gt;2. ¿Cómo puedes ver el contenido, que no extraerlo, de lo que se instalará en el sistema de un paquete deb?&lt;/h3&gt;
&lt;p&gt;si es un .deb:&lt;/p&gt;
&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;$ dpkg -c nombrepaquete&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;O con tar:&lt;/p&gt;
&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;$ &lt;span class=&quot;token function&quot;&gt;tar&lt;/span&gt; -tf nombre_paquete.tar.gz&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&quot;3.-sobre-el-fichero-.deb-descargado%2C-utiliza-el-comando-ar.-ar-permite-extraer-el-contenido-de-una-paquete-deb.-indica-el-procedimiento-para-visualizar-con-ar-el-contenido-del-paquete-deb.-con-el-paquete-que-has-descargado-y-utilizando-el-comando-ar%2C-descomprime-el-paquete.-%C2%BFqu%C3%A9-informaci%C3%B3n-dispones-despu%C3%A9s-de-la-extracci%C3%B3n%3F.-indica-la-finalidad-de-lo-extra%C3%ADdo.&quot; tabindex=&quot;-1&quot;&gt;3. Sobre el fichero .deb descargado, utiliza el comando ar. ar permite extraer el contenido de una paquete deb. Indica el procedimiento para visualizar con ar el contenido del paquete deb. Con el paquete que has descargado y utilizando el comando ar, descomprime el paquete. ¿Qué información dispones después de la extracción?. Indica la finalidad de lo extraído.&lt;/h3&gt;
&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;$ ar -tvx *.deb&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Se extrae:&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;em&gt;debian-binary&lt;/em&gt; que indica la versión del archivo.&lt;/li&gt;
&lt;li&gt;&lt;em&gt;control.tar.xz&lt;/em&gt; que tiene scritps de preinstalación, postinstalación, preborrado, postborrado, configuración…&lt;/li&gt;
&lt;li&gt;data.tar.xz en este paquete se encuentra todos los archivos que serán extraídos con dpkg.&lt;/li&gt;
&lt;/ul&gt;
&lt;h3 id=&quot;4.-indica-el-procedimiento-para-descomprimir-lo-extra%C3%ADdo-por-ar-del-punto-anterior.-%C2%BFqu%C3%A9-informaci%C3%B3n-contiene%3F&quot; tabindex=&quot;-1&quot;&gt;4. Indica el procedimiento para descomprimir lo extraído por ar del punto anterior. ¿Qué información contiene?&lt;/h3&gt;
&lt;p&gt;tar xvf nombrearchivo.&lt;/p&gt;
&lt;h1 id=&quot;trabajo-con-repositorios&quot; tabindex=&quot;-1&quot;&gt;Trabajo con repositorios&lt;/h1&gt;
&lt;h3 id=&quot;1.-a%C3%B1ade-a-tu-fichero-sources.list-los-repositorios-de-bullseye-backports-y-sid.&quot; tabindex=&quot;-1&quot;&gt;1. Añade a tu fichero sources.list los repositorios de bullseye-backports y sid.&lt;/h3&gt;
&lt;p&gt;Tenemos que editar el fichero sources.list:&lt;/p&gt;
&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;$ &lt;span class=&quot;token function&quot;&gt;nano&lt;/span&gt; /etc/apt/sources.list&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Añadimos al sources.list lo siguiente:&lt;/p&gt;
&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;deb https://deb.debian.org/debian bullseye-backports main&lt;br /&gt;deb https://deb.debian.org/debian sid main&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&quot;2.-configura-el-sistema-apt-para-que-los-paquetes-de-debian-bullseye-tengan-mayor-prioridad-y-por-tanto-sean-los-que-se-instalen-por-defecto.&quot; tabindex=&quot;-1&quot;&gt;2. Configura el sistema APT para que los paquetes de debian bullseye tengan mayor prioridad y por tanto sean los que se instalen por defecto.&lt;/h3&gt;
&lt;p&gt;Para dar prioridad a los paquetes de debian bullseye, tenemos que crear un archivo llamado &lt;code&gt;preferences.pref&lt;/code&gt; y debe contener lo siguiente:&lt;/p&gt;
&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;$ &lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;nano&lt;/span&gt; /etc/apt/preferences.d/preferences.p&lt;/code&gt;&lt;/pre&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;Package: *&lt;br /&gt;Pin: release a=stable&lt;br /&gt;Pin-Priority: 1000&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&quot;3.-configura-el-sistema-apt-para-que-los-paquetes-de-bullseye-backports-tengan-mayor-prioridad-que-los-de-unstable.&quot; tabindex=&quot;-1&quot;&gt;3. Configura el sistema APT para que los paquetes de bullseye-backports tengan mayor prioridad que los de unstable.&lt;/h3&gt;
&lt;p&gt;Tenemos que hacer lo mismo que antes pero cambiando lo siguiente:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;Pin: release a=stable&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Por esto:&lt;/p&gt;
&lt;pre class=&quot;language-txt&quot;&gt;&lt;code class=&quot;language-txt&quot;&gt;Pin: release a=bullseye-backports&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&quot;4.-%C2%BFc%C3%B3mo-a%C3%B1ades-la-posibilidad-de-descargar-paqueter%C3%ADa-de-la-arquitectura-i386-en-tu-sistema.-%C2%BFque-comando-has-empleado%3F.-lista-arquitecturas-no-nativas.-%C2%BFc%C3%B3mo-proceder%C3%ADas-para-desechar-la-posibilidad-de-descargar-paqueter%C3%ADa-de-la-arquitectura-i386%3F&quot; tabindex=&quot;-1&quot;&gt;4. ¿Cómo añades la posibilidad de descargar paquetería de la arquitectura i386 en tu sistema. ¿Que comando has empleado?. Lista arquitecturas no nativas. ¿Cómo procederías para desechar la posibilidad de descargar paquetería de la arquitectura i386?&lt;/h3&gt;
&lt;p&gt;El siguiente comando es para añadir:&lt;/p&gt;
&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;$ &lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; dpkg --add-architecture i386&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Este comando lista las arquitecturas soportadas por nuestro sistema:&lt;/p&gt;
&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;$ dpkg --prin-architectures&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;este comando elimina las arquitecturas:&lt;/p&gt;
&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;$ dpkg --remove-architecture i386&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&quot;5.-si-quisieras-descargar-un-paquete%2C-%C2%BFc%C3%B3mo-puedes-saber-todas-las-versiones-disponible-de-dicho-paquete%3F&quot; tabindex=&quot;-1&quot;&gt;5. Si quisieras descargar un paquete, ¿cómo puedes saber todas las versiones disponible de dicho paquete?&lt;/h3&gt;
&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;$ &lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;apt&lt;/span&gt; show --all-versions nombrepaquete&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&quot;6.-indica-el-procedimiento-para-descargar-un-paquete-del-repositorio-stable.&quot; tabindex=&quot;-1&quot;&gt;6. Indica el procedimiento para descargar un paquete del repositorio stable.&lt;/h3&gt;
&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;$ &lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;apt&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;install&lt;/span&gt; -t stable nombrepaquete&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&quot;7.-indica-el-procedimiento-para-descargar-un-paquete-del-repositorio-de-buster-backports.&quot; tabindex=&quot;-1&quot;&gt;7. Indica el procedimiento para descargar un paquete del repositorio de buster-backports.&lt;/h3&gt;
&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;$ &lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;apt&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;install&lt;/span&gt; -t bullseye-backports nombrepaquete&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&quot;8.-indica-el-procedimiento-para-descargar-un-paquete-del-repositorio-de-sid.&quot; tabindex=&quot;-1&quot;&gt;8. Indica el procedimiento para descargar un paquete del repositorio de sid.&lt;/h3&gt;
&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;$ &lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;apt&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;install&lt;/span&gt; -t sid nombrepaquete&lt;/code&gt;&lt;/pre&gt;
&lt;h3 id=&quot;9.-indica-el-procedimiento-para-descargar-un-paquete-de-arquitectura-i386.&quot; tabindex=&quot;-1&quot;&gt;9. Indica el procedimiento para descargar un paquete de arquitectura i386.&lt;/h3&gt;
&lt;pre class=&quot;language-bash&quot;&gt;&lt;code class=&quot;language-bash&quot;&gt;$ &lt;span class=&quot;token function&quot;&gt;sudo&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;apt&lt;/span&gt; &lt;span class=&quot;token function&quot;&gt;install&lt;/span&gt; nombrepaquete:i386&lt;/code&gt;&lt;/pre&gt;
&lt;h1 id=&quot;trabajo-con-directorios&quot; tabindex=&quot;-1&quot;&gt;Trabajo con directorios&lt;/h1&gt;
&lt;h3 id=&quot;1.-que-cometidos-tienen%3A&quot; tabindex=&quot;-1&quot;&gt;1. Que cometidos tienen:&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;/var/lib/apt/lists/&lt;/strong&gt;: En este directorio contiene características sobre los repositorios.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;/var/lib/dpkg/available&lt;/strong&gt;: Lista con los paquetes que hay disponibles.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;/var/lib/dpkg/status&lt;/strong&gt;: En este directorio, hay información sobre los paquetes instalados en el sistema.&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;&lt;strong&gt;/var/cache/apt/archives/&lt;/strong&gt;: Aquí hay los archivos &lt;code&gt;.deb&lt;/code&gt; que estan instalados.&lt;/p&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&amp;lt;br&amp;gt;&lt;/p&gt;
&lt;h2 id=&quot;documento-realizado-por%3A&quot; tabindex=&quot;-1&quot;&gt;&lt;strong&gt;Documento realizado por:&lt;/strong&gt;&lt;/h2&gt;
&lt;p&gt;✒️ &lt;strong&gt;Alejandro Montes Delgado&lt;/strong&gt; - &lt;em&gt;2º ASIR&lt;/em&gt;&lt;/p&gt;
</content>
	</entry>
	
	<entry>
		<title>Prueba: Introducción a la implantación de aplicaciones web.</title>
		<link href="https://reeseschultz.github.io/post/prueba:-introduccion-a-la-implantacion-de-aplicaciones-web./"/>
		<updated>2022-10-10T00:00:00Z</updated>
		<id>https://reeseschultz.github.io/post/prueba:-introduccion-a-la-implantacion-de-aplicaciones-web./</id>
		<content type="html">&lt;h1 id=&quot;alejandro-montes-delgado.&quot; tabindex=&quot;-1&quot;&gt;Alejandro Montes Delgado.&lt;/h1&gt;
&lt;p&gt;&lt;img src=&quot;https://reeseschultz.github.io/img/ipasen.png&quot; alt=&quot;ipasen.png&quot; /&gt;&lt;/p&gt;
</content>
	</entry>
	
	<entry>
		<title>Talleres unidad 1 Servicios.</title>
		<link href="https://reeseschultz.github.io/post/talleres-unidad-1-servicios./"/>
		<updated>2022-10-05T00:00:00Z</updated>
		<id>https://reeseschultz.github.io/post/talleres-unidad-1-servicios./</id>
		<content type="html">&lt;h1 id=&quot;taller-1%3A-ansible---playbook-sencillo&quot; tabindex=&quot;-1&quot;&gt;Taller 1: Ansible - Playbook sencillo&lt;/h1&gt;
&lt;ol&gt;
&lt;li&gt;Entrega los ficheros: site.yaml, hosts y template/index.j2.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;a href=&quot;https://reeseschultz.github.io/files/site.yaml&quot;&gt;site.yml&lt;/a&gt; &lt;a href=&quot;https://reeseschultz.github.io/files/host&quot;&gt;host&lt;/a&gt; &lt;a href=&quot;https://reeseschultz.github.io/files/index.j2&quot;&gt;index.j2&lt;/a&gt;&lt;/p&gt;
&lt;ol start=&quot;2&quot;&gt;
&lt;li&gt;Entrega una captura de pantalla donde se vea que se ha finalizado la ejecución del playbook.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;img src=&quot;https://reeseschultz.github.io/img/SRI.png&quot; alt=&quot;SRI.png&quot; /&gt;&lt;/p&gt;
&lt;ol start=&quot;3&quot;&gt;
&lt;li&gt;Responde: ¿Cómo se llama la propiedad que permite que las tareas que ya se han realizado no se vuelvan a ejecutar?&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Idempotencia&lt;/p&gt;
&lt;ol start=&quot;4&quot;&gt;
&lt;li&gt;Captura de pantalla, donde se vea el fichero foo.txt en el servidor configurado.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;img src=&quot;https://reeseschultz.github.io/img/SRI2.png&quot; alt=&quot;SRI2.png&quot; /&gt;&lt;/p&gt;
&lt;ol start=&quot;5&quot;&gt;
&lt;li&gt;Captura de pantalla donde se vea el acceso desde el navegador al servidor web, y se vea el contenido del fichero index.html.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;img src=&quot;https://reeseschultz.github.io/img/SRI3.png&quot; alt=&quot;SRI3.png&quot; /&gt;&lt;/p&gt;
&lt;ol start=&quot;6&quot;&gt;
&lt;li&gt;Entrega la URL de tu repositorio con el que estas trabajando.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;a href=&quot;https://github.com/alemd01/taller_ansible_vagrant/&quot;&gt;Github&lt;/a&gt;&lt;/p&gt;
&lt;h1 id=&quot;taller-2%3A-ansible---playbook-con-roles&quot; tabindex=&quot;-1&quot;&gt;Taller 2: Ansible - Playbook con roles&lt;/h1&gt;
&lt;ol&gt;
&lt;li&gt;Entrega una captura de pantalla donde se vea que se ha finalizado la ejecución del playbook.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;img src=&quot;https://reeseschultz.github.io/img/SRI-T2.1.png&quot; alt=&quot;SRI-T2.1.png&quot; /&gt;&lt;/p&gt;
&lt;ol start=&quot;2&quot;&gt;
&lt;li&gt;Captura de pantalla donde se vea el acceso desde el navegador al servidor web, y se vea el contenido del fichero index.html.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;img src=&quot;https://reeseschultz.github.io/img/SRI-T2.2.png&quot; alt=&quot;SRI-T2.2.png&quot; /&gt;&lt;/p&gt;
&lt;ol start=&quot;3&quot;&gt;
&lt;li&gt;Captura de pantalla donde se vea el acceso a la base de datos.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;img src=&quot;https://reeseschultz.github.io/img/SRI-T2.3.png&quot; alt=&quot;SRI-T2.3.png&quot; /&gt;&lt;/p&gt;
&lt;ol start=&quot;4&quot;&gt;
&lt;li&gt;Realiza un cambio en la receta que necesite ejecutar el reinicio del servicio. Ejecuta de nuevo el playbook y comprueba que se ha ejecutado el handler correspondiente.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;img src=&quot;https://reeseschultz.github.io/img/SRI-T2.4.png&quot; alt=&quot;SRI-T2.4.png&quot; /&gt;&lt;/p&gt;
&lt;ol start=&quot;5&quot;&gt;
&lt;li&gt;Entrega la URL de tu repositorio con el que estás trabajando.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;a href=&quot;https://github.com/alemd01/taller_ansible_vagrant/&quot;&gt;Github&lt;/a&gt;&lt;/p&gt;
&lt;h1 id=&quot;taller-3%3A-vagrant---creaci%C3%B3n-de-una-m%C3%A1quina-virtual&quot; tabindex=&quot;-1&quot;&gt;Taller 3: Vagrant - Creación de una máquina virtual&lt;/h1&gt;
&lt;ol&gt;
&lt;li&gt;El fichero Vagrantfile con el que has trabajado.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;Subido el &lt;a href=&quot;https://reeseschultz.github.io/files/Vagrantfile&quot;&gt;fichero&lt;/a&gt;&lt;/p&gt;
&lt;ol start=&quot;2&quot;&gt;
&lt;li&gt;Una captura de pantalla donde se vea la instrucción de creación de la máquina y el acceso a la máquina virtual.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;img src=&quot;https://reeseschultz.github.io/img/SRI-T3.2.png&quot; alt=&quot;SRI-T3.2.png&quot; /&gt;&lt;/p&gt;
&lt;ol start=&quot;3&quot;&gt;
&lt;li&gt;Capturas de pantallas donde se vean la memoria RAM y las CPU asignadas.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;img src=&quot;https://reeseschultz.github.io/img/SRI-T3.3.png&quot; alt=&quot;SRI-T3.3.png&quot; /&gt;&lt;/p&gt;
&lt;ol start=&quot;4&quot;&gt;
&lt;li&gt;Captura de pantalla donde se vean la máquina KVM que se ha creado, la red que se ha creado y el volumen que está usando la máquina usa aprovisionamiento ligero.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;img src=&quot;https://reeseschultz.github.io/img/SRI-T3.4.png&quot; alt=&quot;SRI-T3.4.png&quot; /&gt;&lt;/p&gt;
</content>
	</entry>
	
	<entry>
		<title>Creación de un sistema automatizado de instalación.</title>
		<link href="https://reeseschultz.github.io/post/creacion-de-un-sistema-automatizado-de-instalacion./"/>
		<updated>2022-10-05T00:00:00Z</updated>
		<id>https://reeseschultz.github.io/post/creacion-de-un-sistema-automatizado-de-instalacion./</id>
		<content type="html">&lt;p&gt;&lt;em&gt;Instalación automatizada basada en medio de almacenamiento extraíble.&lt;/em&gt;&lt;/p&gt;
&lt;p&gt;Usaremos 7z para descomprimir la iso.&lt;/p&gt;
&lt;pre class=&quot;language-diff-js&quot;&gt;&lt;code class=&quot;language-diff-js&quot;&gt;&lt;span class=&quot;token coord&quot;&gt;7z x /mnt/Archivos/ISOs/debian-10.6.0-amd64-xfce-CD-1.iso&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&quot;https://reeseschultz.github.io/img/ASO-P1.8.png&quot; alt=&quot;ASO-P1.8.png&quot; /&gt;&lt;/p&gt;
&lt;p&gt;descomprimimos el initrd. Damos permisos a la carpeta que vamos a modificar, ponemos el preseed en el initrd, volvemos a comprimir y ponemos los permisos de antes&lt;/p&gt;
&lt;pre class=&quot;language-diff-js&quot;&gt;&lt;code class=&quot;language-diff-js&quot;&gt;&lt;span class=&quot;token coord&quot;&gt;7z x initrd.gz&lt;/span&gt;&lt;br /&gt;chmod +w -R install.amd/&lt;br /&gt;echo preseed.cfg | cpio -H newc -o -A -F install.amd/initrd&lt;br /&gt;gzip install.amd/initrd&lt;br /&gt;chmod -w -R install.amd/&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Regeneramos el md5sum.txt&lt;/p&gt;
&lt;pre class=&quot;language-diff-js&quot;&gt;&lt;code class=&quot;language-diff-js&quot;&gt;chmod +w md5sum.txt&lt;br /&gt;find -follow -type f ! -name md5sum.txt -print0 | xargs -0 md5sum &gt; md5sum.txt&lt;br /&gt;chmod -w md5sum.txt&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Creamos una nueva iso booteable con el comando &lt;em&gt;genisoimage&lt;/em&gt;&lt;/p&gt;
&lt;pre class=&quot;language-diff-js&quot;&gt;&lt;code class=&quot;language-diff-js&quot;&gt;sudo genisoimage -r -J -b isolinux/isolinux.bin -c isolinux/boot.cat -no-emul-boot -boot-load-size 4 -boot-info-table -o ../debian-10.6.0-amd64-xfce-CD-1.iso &lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;Ya tenemos la iso lista, ahora haremos una instalación desatendida. Ponemos el disco con la iso e iniciamos la máquina. Le damos a &lt;em&gt;Advanced options&lt;/em&gt;.
&lt;img src=&quot;https://reeseschultz.github.io/img/ASO-P1.9.png&quot; alt=&quot;imagen&quot; /&gt;&lt;/p&gt;
&lt;p&gt;Ahora le damos a &lt;em&gt;Automated install&lt;/em&gt; y empezará la instalación
&lt;img src=&quot;https://reeseschultz.github.io/img/ASO-P1.10.png&quot; alt=&quot;imagen&quot; /&gt;&lt;/p&gt;
&lt;p&gt;ponemos contraseña de root y del usuario(me da problemas en el preseed y he decidido ponerla antes de la instalación).
&lt;img src=&quot;https://reeseschultz.github.io/img/ASO-P1.11.png&quot; alt=&quot;imagen&quot; /&gt;&lt;/p&gt;
&lt;p&gt;Ahora empieza la instalación desatendida.
&lt;img src=&quot;https://reeseschultz.github.io/img/ASO-P1.12.png&quot; alt=&quot;imagen&quot; /&gt;&lt;/p&gt;
&lt;p&gt;Aquí muestro la salida del comando &lt;em&gt;df -h&lt;/em&gt;
&lt;img src=&quot;https://reeseschultz.github.io/img/ASO-P1.14.png&quot; alt=&quot;imagen&quot; /&gt;&lt;/p&gt;
</content>
	</entry>
	
	<entry>
		<title>Instalación de Debian 11 en el equipo de trabajo</title>
		<link href="https://reeseschultz.github.io/post/instalacion-de-debian-11-en-el-equipo-de-trabajo/"/>
		<updated>2022-10-05T00:00:00Z</updated>
		<id>https://reeseschultz.github.io/post/instalacion-de-debian-11-en-el-equipo-de-trabajo/</id>
		<content type="html">&lt;p&gt;He instalado en mi equipo de trabajo debian 11 con lvm, a continuación, explico de forma detallada como lo he instalado, configurado y los problemas e inconvenientes que me han surgido a lo largo de la instalación. En mi equipo tengo 2 discos duros, un HDD de 1 Tb de capacidad y un SSD de 240 Gb, al poner lvm en mi equipo lo he estructurado de la siguiente manera:&lt;/p&gt;
&lt;p&gt;El SSD esta particionado por la mitad, y una partición está reservada para windows la otra partición la he usado como volumen físico. En el caso del disco duro es exactamente igual está particionado en 2, 500gb cada partición, una de ellas está reservada para los archivos y la otra la he usado como otro volumen físico. He hecho 2 volúmenes de grupo, uno por disco, para que no interfiera en el rendimiento del ssd. En el ssd puse 2 volúmenes lógicos, uno la raíz con 30 Gb y el otro volumen lógico está el boot al que le di 1Gb.
En el HDD, tengo 2 particiones, una de ellas la he usado como volumen físico, he creado un grupo de volúmenes con este volumen físico y en el grupo de volúmenes he hecho 2 volúmenes lógicos, uno de 100Gb en el que he puesto la raiz y otro volumen lógico de 230Gb en el que he puesto el var.&lt;/p&gt;
&lt;p&gt;Una vez instalado el S.O he tenido los siguientes problemas con los drivers:
La tarjeta Wi-FI no me funcionaba, para solucionarlo hice el siguiente comando:&lt;/p&gt;
&lt;pre class=&quot;language-diff-js&quot;&gt;&lt;code class=&quot;language-diff-js&quot;&gt;sudo apt install firmware-atheros&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;por último usé este comando para instalar firmware de linux.&lt;/p&gt;
&lt;pre class=&quot;language-diff-js&quot;&gt;&lt;code class=&quot;language-diff-js&quot;&gt;sudo apt-get install firmware-linux firmware-linux-free firmware-linux-nonfree firmware-misc-nonfree&lt;/code&gt;&lt;/pre&gt;
</content>
	</entry>
	
	<entry>
		<title>Talleres unidad 1 Implantación Aplicaciones Web.</title>
		<link href="https://reeseschultz.github.io/post/talleres-unidad-1-implantacion-aplicaciones-web./"/>
		<updated>2022-10-05T00:00:00Z</updated>
		<id>https://reeseschultz.github.io/post/talleres-unidad-1-implantacion-aplicaciones-web./</id>
		<content type="html">&lt;p&gt;##TALLER 1: Introducción a git y GitHub&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;Una captura de pantalla donde se vea que has creado el repositorio.&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;img src=&quot;https://reeseschultz.github.io/img/TALLER1-IAW.png&quot; alt=&quot;TALLER1-IAW.png&quot; /&gt;&lt;/p&gt;
&lt;ol start=&quot;2&quot;&gt;
&lt;li&gt;El contenido del fichero .git/config para que se vea que has clonado el repositorio con la URL ssh.&lt;/li&gt;
&lt;/ol&gt;
&lt;pre class=&quot;language-diff-js&quot;&gt;&lt;code class=&quot;language-diff-js&quot;&gt;[core]&lt;br /&gt;	repositoryformatversion = 0&lt;br /&gt;	filemode = true&lt;br /&gt;	bare = false&lt;br /&gt;	logallrefupdates = true&lt;br /&gt;[remote &quot;origin&quot;]&lt;br /&gt;	url = git@github.com:alemd01/2ASIR.git&lt;br /&gt;	fetch = +refs/heads/*:refs/remotes/origin/*&lt;br /&gt;[branch &quot;main&quot;]&lt;br /&gt;	remote = origin&lt;br /&gt;	merge = refs/heads/main&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&quot;3&quot;&gt;
&lt;li&gt;La salida de la instrucción git log para ver los commits que has realizado (debe aparecer como autor tu nombre completo).&lt;/li&gt;
&lt;/ol&gt;
&lt;pre class=&quot;language-diff-js&quot;&gt;&lt;code class=&quot;language-diff-js&quot;&gt;commit 421dec9a6988d91a1ac7c871ca9e4b042e803df7&lt;br /&gt;Author: alemd01 &amp;lt;aaleemd11@gmail.com&gt;&lt;br /&gt;Date:   Mon Sep 19 10:28:31 2022 +0200&lt;br /&gt;&lt;span class=&quot;token unchanged language-js&quot;&gt;&lt;span class=&quot;token prefix unchanged&quot;&gt; &lt;/span&gt; He borrado el fichero prueba&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;txt&lt;br /&gt;&lt;/span&gt;&lt;br /&gt;commit d584d99ece167dedc0b8b649471c11a453652d2b&lt;br /&gt;Author: alemd01 &amp;lt;aaleemd11@gmail.com&gt;&lt;br /&gt;Date:   Mon Sep 19 10:27:57 2022 +0200&lt;br /&gt;&lt;span class=&quot;token unchanged language-js&quot;&gt;&lt;span class=&quot;token prefix unchanged&quot;&gt; &lt;/span&gt; He cambiado el nombre al fichero&lt;br /&gt;&lt;/span&gt;&lt;br /&gt;commit 2793b586ee7a7d89184f7313ec4d92ced9f2c64a&lt;br /&gt;Author: alemd01 &amp;lt;aaleemd11@gmail.com&gt;&lt;br /&gt;Date:   Mon Sep 19 10:26:59 2022 +0200&lt;br /&gt;&lt;span class=&quot;token unchanged language-js&quot;&gt;&lt;span class=&quot;token prefix unchanged&quot;&gt; &lt;/span&gt; He modificado el fichero prueba&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;txt&lt;br /&gt;&lt;/span&gt;&lt;br /&gt;commit e6195890e08484aa86eb1fc9c7c93d8448328c33&lt;br /&gt;Author: alemd01 &amp;lt;aaleemd11@gmail.com&gt;&lt;br /&gt;Date:   Mon Sep 19 10:17:13 2022 +0200&lt;br /&gt;&lt;span class=&quot;token unchanged language-js&quot;&gt;&lt;span class=&quot;token prefix unchanged&quot;&gt; &lt;/span&gt; He creado el fichero prueba&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;txt&lt;br /&gt;&lt;/span&gt;&lt;br /&gt;commit 2093f3e2515054c1d7223d79b373c89526beebc4&lt;br /&gt;Author: alemd01 &amp;lt;78356101+alemd01@users.noreply.github.com&gt;&lt;br /&gt;Date:   Mon Sep 19 10:15:13 2022 +0200&lt;br /&gt;&lt;span class=&quot;token unchanged language-js&quot;&gt;&lt;span class=&quot;token prefix unchanged&quot;&gt; &lt;/span&gt; Initial commit&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;ol start=&quot;4&quot;&gt;
&lt;li&gt;buscar información para crear un nuevo repositorio llamado prueba2_tu_nombre. en esta ocasión, crea primero el repositorio local (usando git init) y luego busca información para sincronizarlo y crear el repositorio remoto en GitHub. Comenta los pasos que has realizado y manda alguna prueba de funcionamiento.
Primero hay que crear un repositorio en Github, después hay que crear un directorio en nuestra máquina local. Creamos por ejemplo el archivo README. Entramos en la carpeta y hacemos un git init.&lt;/li&gt;
&lt;/ol&gt;
&lt;pre class=&quot;language-diff-js&quot;&gt;&lt;code class=&quot;language-diff-js&quot;&gt;&lt;span class=&quot;token unchanged language-js&quot;&gt;&lt;span class=&quot;token prefix unchanged&quot;&gt; &lt;/span&gt;    mkdir prueba2_AlejandroMontes&lt;br /&gt;&lt;span class=&quot;token prefix unchanged&quot;&gt; &lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token prefix unchanged&quot;&gt; &lt;/span&gt;    cd prueba2_AlejandroMontes&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;&lt;br /&gt;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token unchanged language-js&quot;&gt;&lt;span class=&quot;token prefix unchanged&quot;&gt; &lt;/span&gt;    echo &lt;span class=&quot;token string&quot;&gt;&quot;# prueba2_AlejandroMontes&quot;&lt;/span&gt; &lt;span class=&quot;token operator&quot;&gt;&gt;&gt;&lt;/span&gt; &lt;span class=&quot;token constant&quot;&gt;README&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;md&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&quot;https://reeseschultz.github.io/img/taller1-2.png&quot; alt=&quot;taller1-2.png&quot; /&gt;&lt;/p&gt;
&lt;p&gt;Una vez hecho esto, hacemos un git add y un commit.&lt;/p&gt;
&lt;pre class=&quot;language-diff-js&quot;&gt;&lt;code class=&quot;language-diff-js&quot;&gt;&lt;span class=&quot;token unchanged language-js&quot;&gt;&lt;span class=&quot;token prefix unchanged&quot;&gt; &lt;/span&gt;    git add &lt;span class=&quot;token constant&quot;&gt;README&lt;/span&gt;&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;md&lt;br /&gt;&lt;/span&gt;&lt;br /&gt;&lt;span class=&quot;token unchanged language-js&quot;&gt;&lt;span class=&quot;token prefix unchanged&quot;&gt; &lt;/span&gt;    git commit &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;m &lt;span class=&quot;token string&quot;&gt;&quot;primer commit&quot;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&quot;https://reeseschultz.github.io/img/taller1-3.png&quot; alt=&quot;taller1-3.png&quot; /&gt;&lt;/p&gt;
&lt;p&gt;Ahora usamos este comando&lt;/p&gt;
&lt;pre class=&quot;language-diff-js&quot;&gt;&lt;code class=&quot;language-diff-js&quot;&gt;&lt;span class=&quot;token unchanged language-js&quot;&gt;&lt;span class=&quot;token prefix unchanged&quot;&gt; &lt;/span&gt;    git branch &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;&lt;span class=&quot;token constant&quot;&gt;M&lt;/span&gt; main&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;A continuación, tenemos que hacer un git remote add origin&lt;/p&gt;
&lt;pre class=&quot;language-diff-js&quot;&gt;&lt;code class=&quot;language-diff-js&quot;&gt;&lt;span class=&quot;token unchanged language-js&quot;&gt;&lt;span class=&quot;token prefix unchanged&quot;&gt; &lt;/span&gt;    git remote add origin git@github&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;com&lt;span class=&quot;token operator&quot;&gt;:&lt;/span&gt;alemd01&lt;span class=&quot;token operator&quot;&gt;/&lt;/span&gt;prueba2_AlejandroMontes&lt;span class=&quot;token punctuation&quot;&gt;.&lt;/span&gt;git&lt;br /&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;por último hacemos un git push&lt;/p&gt;
&lt;pre class=&quot;language-diff-js&quot;&gt;&lt;code class=&quot;language-diff-js&quot;&gt;&lt;span class=&quot;token unchanged language-js&quot;&gt;&lt;span class=&quot;token prefix unchanged&quot;&gt; &lt;/span&gt;     git push &lt;span class=&quot;token operator&quot;&gt;-&lt;/span&gt;u origin main&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;
&lt;p&gt;&lt;img src=&quot;https://reeseschultz.github.io/img/taller1-4.png&quot; alt=&quot;taller1-4.png&quot; /&gt;&lt;/p&gt;
</content>
	</entry>
</feed>