<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">

    
    <meta itemprop="name" content="Criptografía II: Integridad, firmas y autenticación | Cutreblog">
    <meta itemprop="description" content="En esta práctica realizaremos la 2ª práctica de criptografía.">

    
    <meta name="twitter:title" content="Criptografía II: Integridad, firmas y autenticación | Cutreblog">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:description" content="En esta práctica realizaremos la 2ª práctica de criptografía.">
    <meta name="twitter:site" content="@ReeseCodes">
    <meta name="twitter:creator" content="@ReeseCodes">
    <meta name="twitter:image:src" content="https://reeseschultz.github.io/twitter.jpg">

    
    <meta name="og:title" content="Criptografía II: Integridad, firmas y autenticación | Cutreblog">
    <meta name="og:description" content="En esta práctica realizaremos la 2ª práctica de criptografía.">
    <meta name="og:image" content="https://reeseschultz.github.io/og.jpg">
    <meta name="og:url" content="https://reeseschultz.github.io/">
    <meta name="og:site_name" content="Cutreblog">
    <meta name="og:locale" content="en_GB">
    <meta name="og:type" content="website">

    <link rel="icon" type="image/x-icon" href="/logo.png" />

    <title>Criptografía II: Integridad, firmas y autenticación | Cutreblog</title>

    <link rel="stylesheet" href="/assets/main.bundle.css">

    
  </head>
  <body class="flex flex-col min-h-screen">
    <header>
  <nav class="container mx-auto max-w-3xl px-8 pt-2 flex flex-wrap justify-between">
    <div>
      <h1>
        <a href="/">Cutreblog</a>
      </h1>
      <p>Blog de Alejandro Montes</p>
    </div>

    <ul class="flex flex-wrap sm:w-32 w-full mt-6 md:justify-between justify-evenly">
      <li>
        <a href="/404.html">404</a>
      </li>

      <li>
        <a href="/about">Sobre mí.</a>
      </li>
    </ul>
  </nav>
</header>

    <main class="container mx-auto max-w-3xl p-8 grow">
      
    <p></p>
    <div>
        <h2>Criptografía II: Integridad, firmas y autenticación</h2>

        
            <p class="excerpt">En esta práctica realizaremos la 2ª práctica de criptografía.</p>
        

        
            <div class="mb-2">
                <a class="tag SAD" href="/tag/SAD">SAD</a>
            </div>
        

        
            
                <p class="text-sm italic">Creado en
                    <span datetime="Thu Dec 08 2022 01:00:00 GMT+0100 (hora estándar de Europa central)">December 8, 2022</span>.</p>
            
        

        <div class="content post">
            
                <hr />

                <h3>Tabla de Contenido.</h3>

                <nav class="toc">
                <ol>
                    
                    <li><a href="#tarea-1%3A-firmas-electr%C3%B3nicas">Tarea 1: Firmas electrónicas</a>
            
                <ol>
                    
                    <li><a href="#1.-manda-un-documento-y-la-firma-electr%C3%B3nica-del-mismo-a-un-compa%C3%B1ero.-verifica-la-firma-que-tu-has-recibido.">1. Manda un documento y la firma electrónica del mismo a un compañero. Verifica la firma que tu has recibido.</a>
            		</li>

                    <li><a href="#2.-%C2%BFqu%C3%A9-significa-el-mensaje-que-aparece-en-el-momento-de-verificar-la-firma%3F">2. ¿Qué significa el mensaje que aparece en el momento de verificar la firma?</a>
            		</li>

                    <li><a href="#3.-vamos-a-crear-un-anillo-de-confianza-entre-los-miembros-de-nuestra-clase%2C-para-ello.">3. Vamos a crear un anillo de confianza entre los miembros de nuestra clase, para ello.</a>
            		</li>

                    <li><a href="#4.-muestra-las-firmas-que-tiene-tu-clave-p%C3%BAblica.">4. Muestra las firmas que tiene tu clave pública.</a>
            		</li>

                    <li><a href="#5.-comprueba-que-ya-puedes-verificar-sin-%E2%80%9Cproblemas%E2%80%9D-una-firma-recibida-por-una-persona-en-la-que-conf%C3%ADas.">5. Comprueba que ya puedes verificar sin “problemas” una firma recibida por una persona en la que confías.</a>
            		</li>

                    <li><a href="#6.-comprueba-que-puedes-verificar-con-confianza-una-firma-de-una-persona-en-las-que-no-conf%C3%ADas%2C-pero-sin-embargo-si-conf%C3%ADa-otra-persona-en-la-que-tu-tienes-confianza-total.">6. Comprueba que puedes verificar con confianza una firma de una persona en las que no confías, pero sin embargo si confía otra persona en la que tu tienes confianza total.</a>
            		</li>
                </ol>
            		</li>

                    <li><a href="#tarea-2%3A-correo-seguro-con-evolution%2Fthunderbird">Tarea 2: Correo seguro con evolution/thunderbird</a>
            
                <ol>
                    
                    <li><a href="#1.-configura-el-cliente-de-correo-evolution-con-tu-cuenta-de-correo-habitual">1. Configura el cliente de correo evolution con tu cuenta de correo habitual</a>
            		</li>

                    <li><a href="#2.-a%C3%B1ade-a-la-cuenta-las-opciones-de-seguridad-para-poder-enviar-correos-firmados-con-tu-clave-privada-o-cifrar-los-mensajes-para-otros-destinatarios">2. Añade a la cuenta las opciones de seguridad para poder enviar correos firmados con tu clave privada o cifrar los mensajes para otros destinatarios</a>
            		</li>

                    <li><a href="#3.-env%C3%ADa-y-recibe-varios-mensajes-con-tus-compa%C3%B1eros-y-comprueba-el-funcionamiento-adecuado-de-gpg.">3. Envía y recibe varios mensajes con tus compañeros y comprueba el funcionamiento adecuado de GPG.</a>
            		</li>

                    <li><a href="#4.-correo-firmado-para-ra%C3%BAl.">4. Correo firmado para Raúl.</a>
            		</li>
                </ol>
            		</li>

                    <li><a href="#tarea-3%3A-integridad-de-ficheros">Tarea 3: Integridad de ficheros</a>
            
                <ol>
                    
                    <li><a href="#1.-para-validar-el-contenido-de-la-imagen-cd%2C-solo-aseg%C3%BArese-de-usar-la-herramienta-apropiada-para-sumas-de-verificaci%C3%B3n.-para-cada-versi%C3%B3n-publicada-existen-archivos-de-suma-de-comprobaci%C3%B3n-con-algoritmos-fuertes-(sha256-y-sha512)%3B-deber%C3%ADa-usar-las-herramientas-sha256sum-o-sha512sum-para-trabajar-con-ellos.">1. Para validar el contenido de la imagen CD, solo asegúrese de usar la herramienta apropiada para sumas de verificación. Para cada versión publicada existen archivos de suma de comprobación con algoritmos fuertes (SHA256 y SHA512); debería usar las herramientas sha256sum o sha512sum para trabajar con ellos.</a>
            		</li>

                    <li><a href="#2.-verifica-que-el-contenido-del-hash-que-has-utilizado-no-ha-sido-manipulado%2C-usando-la-firma-digital-que-encontrar%C3%A1s-en-el-repositorio.-puedes-encontrar-una-gu%C3%ADa-para-realizarlo-en-este-art%C3%ADculo%3A-how-to-verify-an-authenticity-of-downloaded-debian-iso-images">2. Verifica que el contenido del hash que has utilizado no ha sido manipulado, usando la firma digital que encontrarás en el repositorio. Puedes encontrar una guía para realizarlo en este artículo: How to verify an authenticity of downloaded Debian ISO images</a>
            		</li>
                </ol>
            		</li>

                    <li><a href="#tarea-4%3A-integridad-y-autenticidad-(apt-secure)">Tarea 4: Integridad y autenticidad (apt secure)</a>
            
                <ol>
                    
                    <li><a href="#1.-%C2%BFqu%C3%A9-software-utiliza-apt-secure-para-realizar-la-criptograf%C3%ADa-asim%C3%A9trica%3F">1. ¿Qué software utiliza apt secure para realizar la criptografía asimétrica?</a>
            		</li>

                    <li><a href="#2.-%C2%BFpara-que-sirve-el-comando-apt-key%3F-%C2%BFqu%C3%A9-muestra-el-comando-apt-key-list%3F">2. ¿Para que sirve el comando apt-key? ¿Qué muestra el comando apt-key list?</a>
            		</li>

                    <li><a href="#3.-en-que-fichero-se-guarda-el-anillo-de-claves-que-guarda-la-herramienta-apt-key%3F">3. En que fichero se guarda el anillo de claves que guarda la herramienta apt-key?</a>
            		</li>

                    <li><a href="#4.-%C2%BFqu%C3%A9-contiene-el-archivo-release-de-un-repositorio-de-paquetes%3F.-%C2%BFy-el-archivo-release.gpg%3F.-puedes-ver-estos-archivos-en-el-repositorio-http%3A%2F%2Fftp.debian.org%2Fdebian%2Fdists%2Fdebian10.1%2F.-estos-archivos-se-descargan-cuando-hacemos-un-apt-update.">4. ¿Qué contiene el archivo Release de un repositorio de paquetes?. ¿Y el archivo Release.gpg?. Puedes ver estos archivos en el repositorio http://ftp.debian.org/debian/dists/Debian10.1/. Estos archivos se descargan cuando hacemos un apt update.</a>
            		</li>

                    <li><a href="#5.-explica-el-proceso-por-el-cual-el-sistema-nos-asegura-que-los-ficheros-que-estamos-descargando-son-leg%C3%ADtimos.">5. Explica el proceso por el cual el sistema nos asegura que los ficheros que estamos descargando son legítimos.</a>
            		</li>

                    <li><a href="#6.-a%C3%B1ade-de-forma-correcta-el-repositorio-de-virtualbox-a%C3%B1adiendo-la-clave-p%C3%BAblica-de-virtualbox-como-se-indica-en-la-documentaci%C3%B3n.">6. Añade de forma correcta el repositorio de virtualbox añadiendo la clave pública de virtualbox como se indica en la documentación.</a>
            		</li>
                </ol>
            		</li>

                    <li><a href="#tarea-5%3A-autentificaci%C3%B3n%3A-ejemplo-ssh">Tarea 5: Autentificación: ejemplo SSH</a>
            
                <ol>
                    
                    <li><a href="#1.-explica-los-pasos-que-se-producen-entre-el-cliente-y-el-servidor-para-que-el-protocolo-cifre-la-informaci%C3%B3n-que-se-transmite%3F-%C2%BFpara-qu%C3%A9-se-utiliza-la-criptograf%C3%ADa-sim%C3%A9trica%3F-%C2%BFy-la-asim%C3%A9trica%3F">1. Explica los pasos que se producen entre el cliente y el servidor para que el protocolo cifre la información que se transmite? ¿Para qué se utiliza la criptografía simétrica? ¿Y la asimétrica?</a>
            		</li>

                    <li><a href="#2.-explica-los-dos-m%C3%A9todos-principales-de-autentificaci%C3%B3n%3A-por-contrase%C3%B1a-y-utilizando-un-par-de-claves-p%C3%BAblicas-y-privadas.">2. Explica los dos métodos principales de autentificación: por contraseña y utilizando un par de claves públicas y privadas.</a>
            		</li>

                    <li><a href="#3.-en-el-cliente-para-que-sirve-el-contenido-que-se-guarda-en-el-fichero-~%2F.ssh%2Fknow_hosts%3F">3. En el cliente para que sirve el contenido que se guarda en el fichero ~/.ssh/know_hosts?</a>
            		</li>

                    <li><a href="#4.-%C2%BFqu%C3%A9-significa-este-mensaje-que-aparece-la-primera-vez-que-nos-conectamos-a-un-servidor%3F">4. ¿Qué significa este mensaje que aparece la primera vez que nos conectamos a un servidor?</a>
            		</li>

                    <li><a href="#5.-en-ocasiones-cuando-estamos-trabajando-en-el-cloud%2C-y-reutilizamos-una-ip-flotante-nos-aparece-este-mensaje%3A">5. En ocasiones cuando estamos trabajando en el cloud, y reutilizamos una ip flotante nos aparece este mensaje:</a>
            		</li>

                    <li><a href="#6.-%C2%BFqu%C3%A9-guardamos-y-para-qu%C3%A9-sirve-el-fichero-en-el-servidor-~%2F.ssh%2Fauthorized_keys%3F">6. ¿Qué guardamos y para qué sirve el fichero en el servidor ~/.ssh/authorized_keys?</a>
            		</li>
                </ol>
            		</li>
                </ol>
            </nav>

                <hr />
            

            <h3 id="tarea-1%3A-firmas-electr%C3%B3nicas" tabindex="-1">Tarea 1: Firmas electrónicas</h3>
<h4 id="1.-manda-un-documento-y-la-firma-electr%C3%B3nica-del-mismo-a-un-compa%C3%B1ero.-verifica-la-firma-que-tu-has-recibido." tabindex="-1">1. Manda un documento y la firma electrónica del mismo a un compañero. Verifica la firma que tu has recibido.</h4>
<p>Para generar la firma de un documento, usamos el siguiente comando:</p>
<pre class="language-txt"><code class="language-txt">gpg --detach-sign prueba.txt</code></pre>
<p>Le enviamos al compañero el documento con la firma y saldrá el error del siguiente apratado.</p>
<h4 id="2.-%C2%BFqu%C3%A9-significa-el-mensaje-que-aparece-en-el-momento-de-verificar-la-firma%3F" tabindex="-1">2. ¿Qué significa el mensaje que aparece en el momento de verificar la firma?</h4>
<pre class="language-txt"><code class="language-txt"> gpg: Firma correcta de "Pepe D &lt;josedom24@gmail.com>" [desconocido]<br> gpg: ATENCIÓN: ¡Esta clave no está certificada por una firma de confianza!<br> gpg:          No hay indicios de que la firma pertenezca al propietario.<br> Huellas dactilares de la clave primaria: E8DD 5DA9 3B88 F08A DA1D  26BF 5141 3DDB 0C99 55FC</code></pre>
<p>Este mensaje sale porque no tenemos un anillo de confianza. El error, nos hace referencia a que nuestra clave no está en ningun anillo de confianza.</p>
<h4 id="3.-vamos-a-crear-un-anillo-de-confianza-entre-los-miembros-de-nuestra-clase%2C-para-ello." tabindex="-1">3. Vamos a crear un anillo de confianza entre los miembros de nuestra clase, para ello.</h4>
<p><strong>Tu clave pública debe estar en un servidor de claves.</strong></p>
<p>Tengo la clave subida al servidor de ubuntu.</p>
<p><strong>Escribe tu fingerprint en un papel y dárselo a tu compañero, para que puede descargarse tu clave pública.</strong></p>
<p>Mi fingerprint es:</p>
<pre class="language-txt"><code class="language-txt">A24B1921B28D5F7BA7320497E29C0E02DE5CF68C</code></pre>
<p><strong>Te debes bajar al menos tres claves públicas de compañeros. Firma estas claves.</strong></p>
<p>Clave de Alfonso.</p>
<pre class="language-txt"><code class="language-txt">gpg --keyserver keyserver.ubuntu.com --recv-keys DA5E8263079216E8<br>gpg --sign-key DA5E8263079216E8</code></pre>
<p>Clave de Paco.</p>
<pre class="language-txt"><code class="language-txt">gpg --keyserver gpg.mit.edu --recv-keys D5DF96E1BBD7DB81<br>gpg --sign-key 7C499EE49A10C836480FCC9CD5DF96E1BBD7DB81</code></pre>
<p>Clave de Óscar.</p>
<pre class="language-txt"><code class="language-txt">gpg --keyserver keyserver.ubuntu.com --recv-keys A8544395EB1796857BC8C1309E4B2C4247B5AA59<br>gpg --sign-key A8544395EB1796857BC8C1309E4B2C4247B5AA59</code></pre>
<p><strong>Tu te debes asegurar que tu clave pública es firmada por al menos tres compañeros de la clase.</strong></p>
<p>Mi clave pública ha sido firmada por Alfonso, Paco y Óscar.</p>
<p><strong>Una vez que firmes una clave se la tendrás que devolver a su dueño, para que otra persona se la firme.</strong></p>
<p>Exporto la clave de Alfonso y se la envío.</p>
<pre class="language-txt"><code class="language-txt">gpg --export -a DA5E8263079216E8 > clave_alfonso.asc</code></pre>
<p>Exporto la clave de Paco y se la envío</p>
<pre class="language-txt"><code class="language-txt">gpg --export -a 7C499EE49A10C836480FCC9CD5DF96E1BBD7DB81 > paco.key</code></pre>
<p>Exporto la clave de Óscar y se la envío</p>
<pre class="language-txt"><code class="language-txt">gpg --export -a A8544395EB1796857BC8C1309E4B2C4247B5AA59 > oscar.key</code></pre>
<p><strong>Cuando tengas las tres firmas sube la clave al servidor de claves y rellena tus datos en la tabla Claves públicas PGP 2020-2021</strong></p>
<p>Subido.</p>
<p><strong>Asegurate que te vuelves a bajar las claves públicas de tus compañeros que tengan las tres firmas.</strong></p>
<p>Me he tenido que bajar manualmente las claves, ya que desde la terminal no se actualizaba.</p>
<h4 id="4.-muestra-las-firmas-que-tiene-tu-clave-p%C3%BAblica." tabindex="-1">4. Muestra las firmas que tiene tu clave pública.</h4>
<pre class="language-txt"><code class="language-txt">gpg --list-sig</code></pre>
<p><img src="/img/SAD-P4.1.png" alt="SAD-P4.1.png"></p>
<h4 id="5.-comprueba-que-ya-puedes-verificar-sin-%E2%80%9Cproblemas%E2%80%9D-una-firma-recibida-por-una-persona-en-la-que-conf%C3%ADas." tabindex="-1">5. Comprueba que ya puedes verificar sin “problemas” una firma recibida por una persona en la que confías.</h4>
<p>Alfonso me ha enviado un documento con su firma. Muestro que se ha verificado correctamente.</p>
<p><img src="/img/SAD-P4.2.png" alt="SAD-P4.2.png"></p>
<h4 id="6.-comprueba-que-puedes-verificar-con-confianza-una-firma-de-una-persona-en-las-que-no-conf%C3%ADas%2C-pero-sin-embargo-si-conf%C3%ADa-otra-persona-en-la-que-tu-tienes-confianza-total." tabindex="-1">6. Comprueba que puedes verificar con confianza una firma de una persona en las que no confías, pero sin embargo si confía otra persona en la que tu tienes confianza total.</h4>
<hr>
<h3 id="tarea-2%3A-correo-seguro-con-evolution%2Fthunderbird" tabindex="-1">Tarea 2: Correo seguro con evolution/thunderbird</h3>
<h4 id="1.-configura-el-cliente-de-correo-evolution-con-tu-cuenta-de-correo-habitual" tabindex="-1">1. Configura el cliente de correo evolution con tu cuenta de correo habitual</h4>
<p>He iniciado sesión con la cuenta que uso normalmente.</p>
<p><img src="/img/SAD-P4.3.png" alt="SAD-P4.3.png"></p>
<h4 id="2.-a%C3%B1ade-a-la-cuenta-las-opciones-de-seguridad-para-poder-enviar-correos-firmados-con-tu-clave-privada-o-cifrar-los-mensajes-para-otros-destinatarios" tabindex="-1">2. Añade a la cuenta las opciones de seguridad para poder enviar correos firmados con tu clave privada o cifrar los mensajes para otros destinatarios</h4>
<p>Tenemos que irnos a ajustes y configuración de la cuenta, y le damos a cifrado extremo a extremo. Allí importaremos nuestra clave privada y activaremos el cifrado para nuevos mensajes.</p>
<p><img src="/img/SAD-P4.5.png" alt="SAD-P4.5.png"></p>
<h4 id="3.-env%C3%ADa-y-recibe-varios-mensajes-con-tus-compa%C3%B1eros-y-comprueba-el-funcionamiento-adecuado-de-gpg." tabindex="-1">3. Envía y recibe varios mensajes con tus compañeros y comprueba el funcionamiento adecuado de GPG.</h4>
<p>Aquí muestro como Alfonso me ha enviado un correo cifrado por mi clave pública y lo puedo visualizar correctamente.</p>
<p><img src="/img/SAD-P4.4.png" alt="SAD-P4.4.png"></p>
<p>Como podemos ver en la siguiente captura le he enviado correctamente un correo cifrado a Paco.</p>
<p><img src="/img/SAD-P4.7.jpg" alt="SAD-P4.7.png"></p>
<h4 id="4.-correo-firmado-para-ra%C3%BAl." tabindex="-1">4. Correo firmado para Raúl.</h4>
<p>Enviado el correo a Raúl, mi correo es <a href="mailto:alemd01@outlook.com">alemd01@outlook.com</a> para que lo puedas verificar.</p>
<hr>
<h3 id="tarea-3%3A-integridad-de-ficheros" tabindex="-1">Tarea 3: Integridad de ficheros</h3>
<h4 id="1.-para-validar-el-contenido-de-la-imagen-cd%2C-solo-aseg%C3%BArese-de-usar-la-herramienta-apropiada-para-sumas-de-verificaci%C3%B3n.-para-cada-versi%C3%B3n-publicada-existen-archivos-de-suma-de-comprobaci%C3%B3n-con-algoritmos-fuertes-(sha256-y-sha512)%3B-deber%C3%ADa-usar-las-herramientas-sha256sum-o-sha512sum-para-trabajar-con-ellos." tabindex="-1">1. Para validar el contenido de la imagen CD, solo asegúrese de usar la herramienta apropiada para sumas de verificación. Para cada versión publicada existen archivos de suma de comprobación con algoritmos fuertes (SHA256 y SHA512); debería usar las herramientas sha256sum o sha512sum para trabajar con ellos.</h4>
<p>Una vez descargada la ISO de debian, abriremos el fichero <a href="https://cdimage.debian.org/debian-cd/current/amd64/iso-cd/">SHA256SUMS</a> que se encuentra en el mismo enlace y nos centraremos en el checksum para la imagen <code>debian-11.5.0-amd64-netinst.iso</code> ya que esa es la que hemos descargado.</p>
<p>Ejecutaremos el siguiente comando para ver checksum de la ISO:</p>
<pre class="language-txt"><code class="language-txt">alemd@debian:~/Descargas$ sha256sum debian-11.5.0-amd64-netinst.iso<br>e307d0e583b4a8f7e5b436f8413d4707dd4242b70aea61eb08591dc0378522f3  debian-11.5.0-amd64-netinst.iso</code></pre>
<p>Y realizaremos un cat del archivo SHA512SUMS para ver si es el mismo checksum:</p>
<pre class="language-txt"><code class="language-txt">alemd@debian:~/Descargas$ cat SHA256SUMS | grep debian-11.5.0-amd64-netinst.iso<br>e307d0e583b4a8f7e5b436f8413d4707dd4242b70aea61eb08591dc0378522f3  debian-11.5.0-amd64-netinst.iso</code></pre>
<p>Como podemos comprobar, el checksum es el mismo.</p>
<h4 id="2.-verifica-que-el-contenido-del-hash-que-has-utilizado-no-ha-sido-manipulado%2C-usando-la-firma-digital-que-encontrar%C3%A1s-en-el-repositorio.-puedes-encontrar-una-gu%C3%ADa-para-realizarlo-en-este-art%C3%ADculo%3A-how-to-verify-an-authenticity-of-downloaded-debian-iso-images" tabindex="-1">2. Verifica que el contenido del hash que has utilizado no ha sido manipulado, usando la firma digital que encontrarás en el repositorio. Puedes encontrar una guía para realizarlo en este artículo: How to verify an authenticity of downloaded Debian ISO images</h4>
<p>Primero descargaremos el fichero <a href="https://cdimage.debian.org/debian-cd/current/amd64/iso-cd/SHA256SUMS.sign">SHA256SUMS.sign</a>.</p>
<p>Importaremos la clave pública de debian para poder verificar la firma.</p>
<pre class="language-txt"><code class="language-txt">alemd@debian:~/Descargas$ gpg --keyserver keyring.debian.org --recv DF9B9C49EAA9298432589D76DA87E80D6294BE9B<br>gpg: clave DA87E80D6294BE9B: clave pública "Debian CD signing key &lt;debian-cd@lists.debian.org>" importada<br>gpg: Cantidad total procesada: 1<br>gpg:               importadas: 1</code></pre>
<p>Una vez importada la clave pública de debian, procederemos a verificar la firma:</p>
<pre class="language-txt"><code class="language-txt">alemd@debian:~/Descargas$ gpg --verify SHA256SUMS.sign SHA256SUMS<br>gpg: Firmado el dom 11 sep 2022 01:00:07 CEST<br>gpg:                usando RSA clave DF9B9C49EAA9298432589D76DA87E80D6294BE9B<br>gpg: Firma correcta de "Debian CD signing key &lt;debian-cd@lists.debian.org>" [desconocido]<br>gpg: ATENCIÓN: ¡Esta clave no está certificada por una firma de confianza!<br>gpg:          No hay indicios de que la firma pertenezca al propietario.<br>Huellas dactilares de la clave primaria: DF9B 9C49 EAA9 2984 3258  9D76 DA87 E80D 6294 BE9B</code></pre>
<p>Indica que se ha verificado correctamente y nos advierte de que la clave no está certificada por una firma de confianza.</p>
<hr>
<h3 id="tarea-4%3A-integridad-y-autenticidad-(apt-secure)" tabindex="-1">Tarea 4: Integridad y autenticidad (apt secure)</h3>
<h4 id="1.-%C2%BFqu%C3%A9-software-utiliza-apt-secure-para-realizar-la-criptograf%C3%ADa-asim%C3%A9trica%3F" tabindex="-1">1. ¿Qué software utiliza apt secure para realizar la criptografía asimétrica?</h4>
<p>El software que  usa la herramienta apt secure es GPG.</p>
<h4 id="2.-%C2%BFpara-que-sirve-el-comando-apt-key%3F-%C2%BFqu%C3%A9-muestra-el-comando-apt-key-list%3F" tabindex="-1">2. ¿Para que sirve el comando apt-key? ¿Qué muestra el comando apt-key list?</h4>
<p>Este comando, es una herramienta que permite gestionar la lista de claves que utiliza APT para autenticar paquetes. Algunas de las opciones mas usadas son las siguientes: add, del, export, exportall, list y finger.</p>
<p>El comando apt-key list muestra todas las claves de confianza para APT:</p>
<pre class="language-txt"><code class="language-txt">alemd@debian:~/Descargas$ apt-key list<br>Warning: apt-key is deprecated. Manage keyring files in trusted.gpg.d instead (see apt-key(8)).<br>/etc/apt/trusted.gpg<br>--------------------<br>pub   rsa4096 2021-10-27 [SC] [caduca: 2023-01-20]<br>      F9A2 1197 6ED6 62F0 0E59  361E 5E3C 45D7 B312 C643<br>uid        [desconocida] Spotify Public Repository Signing Key &lt;tux@spotify.com><br><br>/etc/apt/trusted.gpg.d/debian-archive-bullseye-automatic.gpg<br>------------------------------------------------------------<br>pub   rsa4096 2021-01-17 [SC] [caduca: 2029-01-15]<br>      1F89 983E 0081 FDE0 18F3  CC96 73A4 F27B 8DD4 7936<br>uid        [desconocida] Debian Archive Automatic Signing Key (11/bullseye) &lt;ftpmaster@debian.org><br>sub   rsa4096 2021-01-17 [S] [caduca: 2029-01-15]<br><br>/etc/apt/trusted.gpg.d/debian-archive-bullseye-security-automatic.gpg<br>---------------------------------------------------------------------<br>pub   rsa4096 2021-01-17 [SC] [caduca: 2029-01-15]<br>      AC53 0D52 0F2F 3269 F5E9  8313 A484 4904 4AAD 5C5D<br>uid        [desconocida] Debian Security Archive Automatic Signing Key (11/bullseye) &lt;ftpmaster@debian.org><br>sub   rsa4096 2021-01-17 [S] [caduca: 2029-01-15]<br><br>/etc/apt/trusted.gpg.d/debian-archive-bullseye-stable.gpg<br>---------------------------------------------------------<br>pub   rsa4096 2021-02-13 [SC] [caduca: 2029-02-11]<br>      A428 5295 FC7B 1A81 6000  62A9 605C 66F0 0D6C 9793<br>uid        [desconocida] Debian Stable Release Key (11/bullseye) &lt;debian-release@lists.debian.org><br><br>/etc/apt/trusted.gpg.d/debian-archive-buster-automatic.gpg<br>----------------------------------------------------------<br>pub   rsa4096 2019-04-14 [SC] [caduca: 2027-04-12]<br>      80D1 5823 B7FD 1561 F9F7  BCDD DC30 D7C2 3CBB ABEE<br>uid        [desconocida] Debian Archive Automatic Signing Key (10/buster) &lt;ftpmaster@debian.org><br>sub   rsa4096 2019-04-14 [S] [caduca: 2027-04-12]<br><br>/etc/apt/trusted.gpg.d/debian-archive-buster-security-automatic.gpg<br>-------------------------------------------------------------------<br>pub   rsa4096 2019-04-14 [SC] [caduca: 2027-04-12]<br>      5E61 B217 265D A980 7A23  C5FF 4DFA B270 CAA9 6DFA<br>uid        [desconocida] Debian Security Archive Automatic Signing Key (10/buster) &lt;ftpmaster@debian.org><br>sub   rsa4096 2019-04-14 [S] [caduca: 2027-04-12]<br><br>/etc/apt/trusted.gpg.d/debian-archive-buster-stable.gpg<br>-------------------------------------------------------<br>pub   rsa4096 2019-02-05 [SC] [caduca: 2027-02-03]<br>      6D33 866E DD8F FA41 C014  3AED DCC9 EFBF 77E1 1517<br>uid        [desconocida] Debian Stable Release Key (10/buster) &lt;debian-release@lists.debian.org><br><br>/etc/apt/trusted.gpg.d/debian-archive-stretch-automatic.gpg<br>-----------------------------------------------------------<br>pub   rsa4096 2017-05-22 [SC] [caduca: 2025-05-20]<br>      E1CF 20DD FFE4 B89E 8026  58F1 E0B1 1894 F66A EC98<br>uid        [desconocida] Debian Archive Automatic Signing Key (9/stretch) &lt;ftpmaster@debian.org><br>sub   rsa4096 2017-05-22 [S] [caduca: 2025-05-20]<br><br>/etc/apt/trusted.gpg.d/debian-archive-stretch-security-automatic.gpg<br>--------------------------------------------------------------------<br>pub   rsa4096 2017-05-22 [SC] [caduca: 2025-05-20]<br>      6ED6 F5CB 5FA6 FB2F 460A  E88E EDA0 D238 8AE2 2BA9<br>uid        [desconocida] Debian Security Archive Automatic Signing Key (9/stretch) &lt;ftpmaster@debian.org><br>sub   rsa4096 2017-05-22 [S] [caduca: 2025-05-20]<br><br>/etc/apt/trusted.gpg.d/debian-archive-stretch-stable.gpg<br>--------------------------------------------------------<br>pub   rsa4096 2017-05-20 [SC] [caduca: 2025-05-18]<br>      067E 3C45 6BAE 240A CEE8  8F6F EF0F 382A 1A7B 6500<br>uid        [desconocida] Debian Stable Release Key (9/stretch) &lt;debian-release@lists.debian.org><br><br>/etc/apt/trusted.gpg.d/microsoft.gpg<br>------------------------------------<br>pub   rsa2048 2015-10-28 [SC]<br>      BC52 8686 B50D 79E3 39D3  721C EB3E 94AD BE12 29CF<br>uid        [desconocida] Microsoft (Release signing) &lt;gpgsecurity@microsoft.com><br><br>/etc/apt/trusted.gpg.d/spotify-2021-10-27-5E3C45D7B312C643.gpg<br>--------------------------------------------------------------<br>pub   rsa4096 2021-10-27 [SC] [caduca: 2023-01-20]<br>      F9A2 1197 6ED6 62F0 0E59  361E 5E3C 45D7 B312 C643<br>uid        [desconocida] Spotify Public Repository Signing Key &lt;tux@spotify.com><br><br>/etc/apt/trusted.gpg.d/spotify-2022-11-14-7A3A762FAFD4A51F.gpg<br>--------------------------------------------------------------<br>pub   rsa4096 2022-11-14 [SC] [caduca: 2024-02-07]<br>      E274 09F5 1D1B 6633 7F2D  2F41 7A3A 762F AFD4 A51F<br>uid        [desconocida] Spotify Public Repository Signing Key &lt;tux@spotify.com><br></code></pre>
<h4 id="3.-en-que-fichero-se-guarda-el-anillo-de-claves-que-guarda-la-herramienta-apt-key%3F" tabindex="-1">3. En que fichero se guarda el anillo de claves que guarda la herramienta apt-key?</h4>
<p>Se encuentra en <code>/etc/apt/trusted.gpg</code>.</p>
<h4 id="4.-%C2%BFqu%C3%A9-contiene-el-archivo-release-de-un-repositorio-de-paquetes%3F.-%C2%BFy-el-archivo-release.gpg%3F.-puedes-ver-estos-archivos-en-el-repositorio-http%3A%2F%2Fftp.debian.org%2Fdebian%2Fdists%2Fdebian10.1%2F.-estos-archivos-se-descargan-cuando-hacemos-un-apt-update." tabindex="-1">4. ¿Qué contiene el archivo Release de un repositorio de paquetes?. ¿Y el archivo Release.gpg?. Puedes ver estos archivos en el repositorio <a href="http://ftp.debian.org/debian/dists/Debian10.1/">http://ftp.debian.org/debian/dists/Debian10.1/</a>. Estos archivos se descargan cuando hacemos un apt update.</h4>
<p>El archivo release contiene una lista de los archivos <code>Package</code>, junto con sus hash MD5, SHA1 y SHA256. Con esto, podemos verificar que los ficheros <code>Packages</code> no han sido manipulados, comparando el hash que se nos ha facilitado con el hash que nosotros calculamos osbre el fichero que hemos descargado.</p>
<p>El archivo release.gpg Contiene la firma con la que se verifica que no se ha manipulado el paquete.</p>
<h4 id="5.-explica-el-proceso-por-el-cual-el-sistema-nos-asegura-que-los-ficheros-que-estamos-descargando-son-leg%C3%ADtimos." tabindex="-1">5. Explica el proceso por el cual el sistema nos asegura que los ficheros que estamos descargando son legítimos.</h4>
<p>Primero se descargan los ficheros Release, Release.gpg y el fichero Packages correspondientes. Se comprueba que usando la firma Release.gpg más la clave pública correspondiente el fichero es legítimo, entonces apt ya confía en todos sus checksum. Apt compara el checksum del Package con el que checksum del fichero Release, si ambos coinciden, el fichero se habría descargado.</p>
<h4 id="6.-a%C3%B1ade-de-forma-correcta-el-repositorio-de-virtualbox-a%C3%B1adiendo-la-clave-p%C3%BAblica-de-virtualbox-como-se-indica-en-la-documentaci%C3%B3n." tabindex="-1">6. Añade de forma correcta el repositorio de virtualbox añadiendo la clave pública de virtualbox como se indica en la documentación.</h4>
<p>Primero descargamos las claves gpg:</p>
<pre class="language-txt"><code class="language-txt">sudo wget -O- https://www.virtualbox.org/download/oracle_vbox_2016.asc | gpg --dearmor | sudo tee /usr/share/keyrings/virtualbox.gpg</code></pre>
<p>Añadimos el repositorio al sources.list:</p>
<pre class="language-txt"><code class="language-txt">echo deb [arch=amd64 signed-by=/usr/share/keyrings/virtualbox.gpg] http://download.virtualbox.org/virtualbox/debian bullseye contrib | sudo tee /etc/apt/sources.list.d/virtualbox.list</code></pre>
<hr>
<h3 id="tarea-5%3A-autentificaci%C3%B3n%3A-ejemplo-ssh" tabindex="-1">Tarea 5: Autentificación: ejemplo SSH</h3>
<h4 id="1.-explica-los-pasos-que-se-producen-entre-el-cliente-y-el-servidor-para-que-el-protocolo-cifre-la-informaci%C3%B3n-que-se-transmite%3F-%C2%BFpara-qu%C3%A9-se-utiliza-la-criptograf%C3%ADa-sim%C3%A9trica%3F-%C2%BFy-la-asim%C3%A9trica%3F" tabindex="-1">1. Explica los pasos que se producen entre el cliente y el servidor para que el protocolo cifre la información que se transmite? ¿Para qué se utiliza la criptografía simétrica? ¿Y la asimétrica?</h4>
<p>Son 2 pasos los que se realizan antes de que se cifre una comunicación ssh:</p>
<ul>
<li>Conexión:</li>
</ul>
<p>El cliente establece una conexión TCP con l servidor, y este responde con las versiones del protocolo que soporta. El cliente tiene que usar unas de las versiones que soporta el servidor para continuar. El servidor comparte su clave pública con el cliente para que compruebe si es la máquina ala que quería conectarse. Ahora, ambas partes están preparadas para la negociación de una clave de sesión usando Diffie-Hellman.</p>
<ul>
<li>Negociación:</li>
</ul>
<p>El cliente y el servidor, se ponen de acuerdo en un número primo alto, que servirá como seed value, también se ponen de acuerdo en un tipo de cifrado, generan un número primo por separado, que mantienen en secreto de la otra parte que lo usan como una clave privada de la negociación, intercambian sus claves públicas generadas(no son las mismas que usan para la autenticación). Cada parte usa su clave privada más la clave pública de la otra parte más el número primo compartido original para calcular una clave compartida llamada shared secret. Este shared secret se usa para encriptar toda la comunicación a partir de ahora.</p>
<p>La criptografía simétrica se usa para encriptar conexiones mediante una clave secreta.</p>
<p>La criptografía asimétrica se usa durante el intercambio de claves, se usa en la autenticación del cliente con el servidor.</p>
<h4 id="2.-explica-los-dos-m%C3%A9todos-principales-de-autentificaci%C3%B3n%3A-por-contrase%C3%B1a-y-utilizando-un-par-de-claves-p%C3%BAblicas-y-privadas." tabindex="-1">2. Explica los dos métodos principales de autentificación: por contraseña y utilizando un par de claves públicas y privadas.</h4>
<ul>
<li>Por Contraseñas:</li>
</ul>
<p>Es el método más simple, el servidor pide al cliente que introduzca la contraseña del usuario al que intenta conectar y esta contraseña se envía usando la encriptación que previamente se ha negociado para que se mantenga en secreto.</p>
<ul>
<li>Por par de claves:</li>
</ul>
<p>Utiliza dos claves separadas para el cifrado y el descifrado. Estas dos claves se conocen como clave pública y privada, juntas forman el par de claves. La clave pública como su nombre indica se distribuye abiertamente y se comparte con el otro cliente. La clave privada debe de permanecer oculta, para que la conexión sea segura, ningún tercero puede conocerla.</p>
<p>El cliente envía el ID del par de claves con el que se quiere autenticar ante el servidor. El servidor comprueba en el fichero <code>authorized_keys</code> del usuario al que quiere conectar el cliente si ese ID coincide con algunas de las claves públicas que tiene en el fichero. Si se encuentra una clave pública que coincide, el servidor genera un número aleatorio y usa esa clave pública para desencriptarlo. El servidor envía este número encriptado al cliente. Si el cliente tiene la clave privada del par de claves, podrá desencriptar este mensaje y revelar el número original. El cliente combina el número desencriptado con la clave compartida de sesión que se estça usando para encriptar la comunicación y calcula el hash MD5 de este valor. El cliente envía al servidor este hash como respuesta. El servidor compara el hash que él mismo generó con el que el cliente le ha enviado. Si los valores son iguales, se prueba que el cliente tiene la clave privada correcta y el cliente se autentica correctamente.</p>
<h4 id="3.-en-el-cliente-para-que-sirve-el-contenido-que-se-guarda-en-el-fichero-~%2F.ssh%2Fknow_hosts%3F" tabindex="-1">3. En el cliente para que sirve el contenido que se guarda en el fichero ~/.ssh/know_hosts?</h4>
<p>En este fichero, se guardan todas las claves públicas a las que el cliente se conecta. Se usa para autenticar los servidores a los que se conecta.</p>
<h4 id="4.-%C2%BFqu%C3%A9-significa-este-mensaje-que-aparece-la-primera-vez-que-nos-conectamos-a-un-servidor%3F" tabindex="-1">4. ¿Qué significa este mensaje que aparece la primera vez que nos conectamos a un servidor?</h4>
<pre class="language-txt"><code class="language-txt"> $ ssh debian@172.22.200.74<br> The authenticity of host '172.22.200.74 (172.22.200.74)' can't be established.<br> ECDSA key fingerprint is SHA256:7ZoNZPCbQTnDso1meVSNoKszn38ZwUI4i6saebbfL4M.<br> Are you sure you want to continue connecting (yes/no)? </code></pre>
<p>Este mensaje es mostrado al ser la primera vez que nos conectamos a ese servidor por ssh y sucede porque en el fichero <code>know_hosts</code> no tenemos almacenada la clave pública y no se ha podido verificar la autenticidad del mismo. Si estamos seguro de su autenticidad, le diremos que sí y se guardará su clave pública en el fichero <code>know_hosts</code>.</p>
<h4 id="5.-en-ocasiones-cuando-estamos-trabajando-en-el-cloud%2C-y-reutilizamos-una-ip-flotante-nos-aparece-este-mensaje%3A" tabindex="-1">5. En ocasiones cuando estamos trabajando en el cloud, y reutilizamos una ip flotante nos aparece este mensaje:</h4>
<pre class="language-txt"><code class="language-txt"> $ ssh debian@172.22.200.74<br> @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@<br> @    WARNING: REMOTE HOST IDENTIFICATION HAS CHANGED!     @<br> @@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@<br> IT IS POSSIBLE THAT SOMEONE IS DOING SOMETHING NASTY!<br> Someone could be eavesdropping on you right now (man-in-the-middle attack)!<br> It is also possible that a host key has just been changed.<br> The fingerprint for the ECDSA key sent by the remote host is<br> SHA256:W05RrybmcnJxD3fbwJOgSNNWATkVftsQl7EzfeKJgNc.<br> Please contact your system administrator.<br> Add correct host key in /home/jose/.ssh/known_hosts to get rid of this message.<br> Offending ECDSA key in /home/jose/.ssh/known_hosts:103<br>   remove with:<br>   ssh-keygen -f "/home/jose/.ssh/known_hosts" -R "172.22.200.74"<br> ECDSA host key for 172.22.200.74 has changed and you have requested strict checking.</code></pre>
<p>El mensaje nos indica que la clave pública del servidor al cual nos queremos conectar ha cambiado con respecto a la que teníamos guardadada para esa dirección IP en nuestro fichero <code>know_hosts</code>.</p>
<p>Esta alerta sale porque así se realizan los ataques Man-In-The-Middle, pero si estamos seguros de que somos nosotros o una máquina que conocemos, borramos la línea correspondiente en nuestro <code>know_hosts</code> de la antigua conexión y volvemos a conectar o podemos ejecutar el siguiente comando:</p>
<pre class="language-txt"><code class="language-txt">   ssh-keygen -f "/home/jose/.ssh/known_hosts" -R "&lt;&lt;DIRECCION.IP.DEL.SERVIDOR>>"</code></pre>
<h4 id="6.-%C2%BFqu%C3%A9-guardamos-y-para-qu%C3%A9-sirve-el-fichero-en-el-servidor-~%2F.ssh%2Fauthorized_keys%3F" tabindex="-1">6. ¿Qué guardamos y para qué sirve el fichero en el servidor ~/.ssh/authorized_keys?</h4>
<p>Es un fichero que existe para cada usuario del sistema y guarda las claves públicas de los clientes que entran a ese usuario mediante ssh.</p>
<hr>
<h2 id="documento-realizado-por%3A" tabindex="-1"><strong>Documento realizado por:</strong></h2>
<p>✒️ <strong>Alejandro Montes Delgado</strong> - <em>2º ASIR</em></p>

        </div>
            <p class="uppercase text-xs mt-6">Siguiente post</p>
            <p class="font-bold mb-2">
                <a href="/post/montaje-servidor-y-cliente-nfs-mediante-systemd./">Montaje Servidor y cliente NFS mediante Systemd.</a>
            </p>
        
            <p class="uppercase text-xs mt-6">Post anterior.</p>

            <p class="font-bold">
                <a href="/post/boletin-individual-plsql/">Boletín individual PL/SQL</a>
            </p>
        
    </div>

    </main>
    <footer class="bg-gray-900 pb-10">
  <p class="block text-center text-sm mb-6">
    Built by
    <a target="_blank" href="https://github.com/reeseschultz">
      Reese Schultz
    </a>
  </p>

  <a class="block text-center text-sm" href="/privacy-policy">Privacy Policy</a>
</footer>
    <script src="https://unpkg.com/clipboard@2/dist/clipboard.min.js"></script>
    <script src="/assets/main.bundle.js"></script>
  </body>
</html>
