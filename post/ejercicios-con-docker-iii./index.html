<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">

    
    <meta itemprop="name" content="Ejercicios con Docker III. | Cutreblog">
    <meta itemprop="description" content="Tercer taller de la unidad de Docker.">

    
    <meta name="twitter:title" content="Ejercicios con Docker III. | Cutreblog">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:description" content="Tercer taller de la unidad de Docker.">
    <meta name="twitter:site" content="@ReeseCodes">
    <meta name="twitter:creator" content="@ReeseCodes">
    <meta name="twitter:image:src" content="https://reeseschultz.github.io/twitter.jpg">

    
    <meta name="og:title" content="Ejercicios con Docker III. | Cutreblog">
    <meta name="og:description" content="Tercer taller de la unidad de Docker.">
    <meta name="og:image" content="https://reeseschultz.github.io/og.jpg">
    <meta name="og:url" content="https://reeseschultz.github.io/">
    <meta name="og:site_name" content="Cutreblog">
    <meta name="og:locale" content="en_GB">
    <meta name="og:type" content="website">

    <link rel="icon" type="image/x-icon" href="/logo.png" />

    <title>Ejercicios con Docker III. | Cutreblog</title>

    <link rel="stylesheet" href="/assets/main.bundle.css">

    
  </head>
  <body class="flex flex-col min-h-screen">
    <header>
  <nav class="container mx-auto max-w-3xl px-8 pt-2 flex flex-wrap justify-between">
    <div>
      <h1>
        <a href="/">Cutreblog</a>
      </h1>
      <p>Blog de Alejandro Montes</p>
    </div>

    <ul class="flex flex-wrap sm:w-32 w-full mt-6 md:justify-between justify-evenly">
      <li>
        <a href="/404.html">404</a>
      </li>

      <li>
        <a href="/about">Sobre mí.</a>
      </li>
    </ul>
  </nav>
</header>

    <main class="container mx-auto max-w-3xl p-8 grow">
      
    <p></p>
    <div>
        <h2>Ejercicios con Docker III.</h2>

        
            <p class="excerpt">Tercer taller de la unidad de Docker.</p>
        

        
            <div class="mb-2">
                <a class="tag Docker" href="/tag/Docker">Docker</a><a class="tag SRI" href="/tag/SRI">SRI</a>
            </div>
        

        
            
                <p class="text-sm italic">Creado en
                    <span datetime="Tue Feb 07 2023 01:00:00 GMT+0100 (hora estándar de Europa central)">February 7, 2023</span>.</p>
            
        

        <div class="content post">
            
                <hr />

                <h3>Tabla de Contenido.</h3>

                <nav class="toc">
                <ol>
                    
                    <li><a href="#crea-una-p%C3%A1gina-web-est%C3%A1tica-(por-ejemplo-busca-una-plantilla-html5).-o-simplemente-crea-un-index.html.">Crea una página web estática (por ejemplo busca una plantilla HTML5). O simplemente crea un index.html.</a>
            		</li>

                    <li><a href="#crea-un-fichero-dockerfile-que-permita-crear-una-imagen-con-un-servidor-web-sirviendo-la-p%C3%A1gina.-puedes-usar-una-imagen-base-debian-o-ubuntu%2C-o-una-imagen-que-tenga-ya-un-servicio-web%2C-como-hemos-visto-en-el-apartado-ejemplo-1%3A-construcci%C3%B3n-de-im%C3%A1genes-con-una-p%C3%A1gina-est%C3%A1tica.">Crea un fichero Dockerfile que permita crear una imagen con un servidor web sirviendo la página. Puedes usar una imagen base debian o ubuntu, o una imagen que tenga ya un servicio web, como hemos visto en el apartado Ejemplo 1: Construcción de imágenes con una página estática.</a>
            		</li>

                    <li><a href="#ejecuta-el-comando-docker-que-crea-la-nueva-imagen.-la-imagen-se-debe-llamar-%2Fmi_servidor_web%3Av1.">Ejecuta el comando docker que crea la nueva imagen. La imagen se debe llamar /mi_servidor_web:v1.</a>
            		</li>

                    <li><a href="#con%C3%A9ctate-a-docker-hub-y-sube-la-imagen-que-acabas-de-crear.">Conéctate a Docker Hub y sube la imagen que acabas de crear.</a>
            		</li>

                    <li><a href="#descarga-la-imagen-en-otro-ordenador-donde-tengas-docker-instalado%2C-y-crea-un-contenedor-a-partir-de-ella.-(si-no-tienes-otro-ordenador-con-docker-instalado%2C-borra-la-imagen-en-tu-ordenador-y-b%C3%A1jala-de-docker-hub).">Descarga la imagen en otro ordenador donde tengas docker instalado, y crea un contenedor a partir de ella. (Si no tienes otro ordenador con docker instalado, borra la imagen en tu ordenador y bájala de Docker Hub).</a>
            		</li>

                    <li><a href="#vamos-a-hacer-una-modificaci%C3%B3n-de-la-p%C3%A1gina-web%3A-haz-una-modificaci%C3%B3n-al-fichero-index.html.">Vamos a hacer una modificación de la página web: haz una modificación al fichero index.html.</a>
            		</li>

                    <li><a href="#vuelve-a-crear-una-nueva-imagen%2C-en-esta-caso-pon-ta-etiqueta-v2.-s%C3%BAbela-a-docker-hub.">Vuelve a crear una nueva imagen, en esta caso pon ta etiqueta v2. Súbela a Docker Hub.</a>
            		</li>

                    <li><a href="#por-%C3%BAltimo%2C-baja-la-nueva-imagen-en-el-ordenador-donde-est%C3%A1-corriendo-el-contenedor.-para-hacer-la-implantaci%C3%B3n-de-la-nueva-versi%C3%B3n-debes-borrar-el-contenedor-y-crear-uno-nuevo-desde-la-nueva-versi%C3%B3n-de-la-imagen.">Por último, baja la nueva imagen en el ordenador donde está corriendo el contenedor. Para hacer la implantación de la nueva versión debes borrar el contenedor y crear uno nuevo desde la nueva versión de la imagen.</a>
            		</li>
                </ol>
            </nav>

                <hr />
            

            <h1 id="taller-3%3A-creaci%C3%B3n-de-im%C3%A1genes-docker." tabindex="-1">Taller 3: Creación de imágenes Docker.</h1>
<h2 id="creaci%C3%B3n-de-una-imagen-a-partir-de-un-dockerfile." tabindex="-1">Creación de una imagen a partir de un Dockerfile.</h2>
<p>Lo primero que haremos será una cuenta en Docker Hub.</p>
<h3 id="crea-una-p%C3%A1gina-web-est%C3%A1tica-(por-ejemplo-busca-una-plantilla-html5).-o-simplemente-crea-un-index.html." tabindex="-1">Crea una página web estática (por ejemplo busca una plantilla HTML5). O simplemente crea un index.html.</h3>
<p>Yo usaré una página web estática que creé el curso anterior. Para ello mediante scp pasaré la página estática a la máquina donde uso docker.</p>
<h3 id="crea-un-fichero-dockerfile-que-permita-crear-una-imagen-con-un-servidor-web-sirviendo-la-p%C3%A1gina.-puedes-usar-una-imagen-base-debian-o-ubuntu%2C-o-una-imagen-que-tenga-ya-un-servicio-web%2C-como-hemos-visto-en-el-apartado-ejemplo-1%3A-construcci%C3%B3n-de-im%C3%A1genes-con-una-p%C3%A1gina-est%C3%A1tica." tabindex="-1">Crea un fichero Dockerfile que permita crear una imagen con un servidor web sirviendo la página. Puedes usar una imagen base debian o ubuntu, o una imagen que tenga ya un servicio web, como hemos visto en el apartado Ejemplo 1: Construcción de imágenes con una página estática.</h3>
<pre class="language-txt"><code class="language-txt">usuario@debian:~/docker/taller3$ nano Dockerfile</code></pre>
<p>Añadimos lo siguiente:</p>
<pre class="language-txt"><code class="language-txt">FROM debian:latest<br>MAINTAINER alemd01 "aaleemd11@gmail.com"<br>RUN apt update &amp;&amp; apt install -y apache2 &amp;&amp; apt clean &amp;&amp; rm -rf /var/lib/apt/lists/* /tmp/* /var/tmp/*<br>ADD miresa /var/www/html/<br>EXPOSE 80<br>CMD ["/usr/sbin/apache2ctl", "-D", "FOREGROUND"]</code></pre>
<h3 id="ejecuta-el-comando-docker-que-crea-la-nueva-imagen.-la-imagen-se-debe-llamar-%2Fmi_servidor_web%3Av1." tabindex="-1">Ejecuta el comando docker que crea la nueva imagen. La imagen se debe llamar /mi_servidor_web:v1.</h3>
<pre class="language-txt"><code class="language-txt">usuario@debian:~/docker/taller3$ docker build -t alemd01/mi_servidor_web:v1 .<br>Sending build context to Docker daemon  3.989MB<br>Step 1/6 : FROM debian:latest<br>latest: Pulling from library/debian<br>699c8a97647f: Pull complete <br>Digest: sha256:92277f7108c432febe41beffd367dbb6dac60b9fbfe517c77208e6457eafe22b<br>Status: Downloaded newer image for debian:latest<br> ---> 20473158e8b3<br>Step 2/6 : MAINTAINER alemd01 "aaleemd11@gmail.com"<br> ---> Running in 1bfd4864f4ba<br>Removing intermediate container 1bfd4864f4ba<br> ---> ea9811fb5ce2<br>Step 3/6 : RUN apt update &amp;&amp; apt install -y apache2 &amp;&amp; apt clean &amp;&amp; rm -rf /var/lib/apt/lists/* /tmp/* /var/tmp/*<br> ---> Running in 1f3515239860<br></code></pre>
<p>Ejecuto el contenedor para probarlo.</p>
<p><img src="/img/IAW-T6-T3.1.png" alt="IAW-T6-T3.1.png"></p>
<h3 id="con%C3%A9ctate-a-docker-hub-y-sube-la-imagen-que-acabas-de-crear." tabindex="-1">Conéctate a Docker Hub y sube la imagen que acabas de crear.</h3>
<p>Para conectarnos a Docker Hub, ejecutamos lo siguiente:</p>
<pre class="language-txt"><code class="language-txt">usuario@debian:~/docker/taller3$ docker login -u alemd01<br>Password: <br>WARNING! Your password will be stored unencrypted in /home/usuario/.docker/config.json.<br>Configure a credential helper to remove this warning. See<br>https://docs.docker.com/engine/reference/commandline/login/#credentials-store<br><br>Login Succeeded</code></pre>
<p>Como contraseña podemos usar un <code>access token</code>, lo podemos obtener yendo a los ajustes de nuestro perfil de docker hub y en el apartado de <code>Security</code> nos aparecerá para crear un nuevo token de acceso.</p>
<p>Ahora subiremos nuestra imagen:</p>
<pre class="language-txt"><code class="language-txt">usuario@debian:~/docker/taller3$ docker push alemd01/mi_servidor_web:v1<br>The push refers to repository [docker.io/alemd01/mi_servidor_web]<br>fb9bbbdf2bba: Pushed <br>de157d4f9d2d: Pushed <br>8fcfc59d80ac: Mounted from library/debian <br>v1: digest: sha256:1f518a3a8db31e1cf556ddeeec920e35545cf5d117dbb58f0462bfb1834a5850 size: 952<br></code></pre>
<p>Como podemos ver se ha subido correctamente:</p>
<p><img src="/img/IAW-T6-T3.2.png" alt="IAW-T6-T3.2.png"></p>
<h3 id="descarga-la-imagen-en-otro-ordenador-donde-tengas-docker-instalado%2C-y-crea-un-contenedor-a-partir-de-ella.-(si-no-tienes-otro-ordenador-con-docker-instalado%2C-borra-la-imagen-en-tu-ordenador-y-b%C3%A1jala-de-docker-hub)." tabindex="-1">Descarga la imagen en otro ordenador donde tengas docker instalado, y crea un contenedor a partir de ella. (Si no tienes otro ordenador con docker instalado, borra la imagen en tu ordenador y bájala de Docker Hub).</h3>
<p>Como no tengo otra máquina con docker, borraré la imagen:</p>
<pre class="language-txt"><code class="language-txt">usuario@debian:~/docker/taller3$ docker rm -f mi_servidor_web <br>mi_servidor_web<br>usuario@debian:~/docker/taller3$ docker rmi alemd01/mi_servidor_web:v1<br>Untagged: alemd01/mi_servidor_web:v1<br>Untagged: alemd01/mi_servidor_web@sha256:1f518a3a8db31e1cf556ddeeec920e35545cf5d117dbb58f0462bfb1834a5850<br>Deleted: sha256:b1421e4328a124a2d5d79cbcdaee041a6a5cc540281f3dee34a4a4a2bb9b8c5b<br>Deleted: sha256:f41cc79ea6eb3e88d31d8e6ea80c3a66847423f757f828801f91fc828105496f<br>Deleted: sha256:14fedc712e4013f7b8fbac9a90497f599f92ad737dd9c9dc348c3206b46c8356<br>Deleted: sha256:7a41ce465264e588eb8efe17edccd0f1589b95c8f609f604da9da717f3ee5923<br>Deleted: sha256:fc066f3915bee0e6cdece071401e09403d26848e875cf5beef9d1f6f8faf9a91<br>Deleted: sha256:a1cbbce8a51991a52ea414bf88a33fa04adf85d34b64cfcd9a93d6b08727a291<br>Deleted: sha256:ea9811fb5ce2d965671ba62b2eeebfdc3268a4f71f01a16ff5eb7ced271d02f2<br></code></pre>
<p>Ahora vuelvo a descargar la imagen:</p>
<pre class="language-txt"><code class="language-txt">usuario@debian:~/docker/taller3$ docker pull alemd01/mi_servidor_web:v1<br>v1: Pulling from alemd01/mi_servidor_web<br>699c8a97647f: Already exists <br>b70b6b1f6935: Pull complete <br>6cb65f0b958b: Pull complete <br>Digest: sha256:1f518a3a8db31e1cf556ddeeec920e35545cf5d117dbb58f0462bfb1834a5850<br>Status: Downloaded newer image for alemd01/mi_servidor_web:v1<br>docker.io/alemd01/mi_servidor_web:v1<br></code></pre>
<p>Y creamos el contenedor:</p>
<pre class="language-txt"><code class="language-txt">usuario@debian:~/docker/taller3$ docker run -d -p 8080:80 --name mi_servidor_web alemd01/mi_servidor_web:v1<br>c372915cce45d36f14c433e5ef4f877bc1efc59b87e3bdc788aee2e79b5a71c9<br></code></pre>
<h3 id="vamos-a-hacer-una-modificaci%C3%B3n-de-la-p%C3%A1gina-web%3A-haz-una-modificaci%C3%B3n-al-fichero-index.html." tabindex="-1">Vamos a hacer una modificación de la página web: haz una modificación al fichero index.html.</h3>
<pre class="language-txt"><code class="language-txt">usuario@debian:~/docker/taller3$ nano miresa/index.html </code></pre>
<p>Esta es la línea que he editado:</p>
<pre class="language-html"><code class="language-html">      <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h3</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>heading<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Utrera en el siglo XX. Docker Taller 3.<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h3</span><span class="token punctuation">></span></span></code></pre>
<h3 id="vuelve-a-crear-una-nueva-imagen%2C-en-esta-caso-pon-ta-etiqueta-v2.-s%C3%BAbela-a-docker-hub." tabindex="-1">Vuelve a crear una nueva imagen, en esta caso pon ta etiqueta v2. Súbela a Docker Hub.</h3>
<p>Construyo la nueva imagen:</p>
<pre class="language-txt"><code class="language-txt">usuario@debian:~/docker/taller3$ docker build -t alemd01/mi_servidor_web:v2 .<br>Sending build context to Docker daemon   3.99MB<br>Step 1/6 : FROM debian:latest<br> ---> 20473158e8b3<br>Step 2/6 : MAINTAINER alemd01 "aaleemd11@gmail.com"<br> ---> Running in 9c6ce0fe2cd4<br>Removing intermediate container 9c6ce0fe2cd4<br> ---> c5a25059498d<br>Step 3/6 : RUN apt update &amp;&amp; apt install -y apache2 &amp;&amp; apt clean &amp;&amp; rm -rf /var/lib/apt/lists/* /tmp/* /var/tmp/*<br> ---> Running in 5cc2d230d04e</code></pre>
<p>La subo a Docker Hub:</p>
<pre class="language-txt"><code class="language-txt">usuario@debian:~/docker/taller3$ docker push alemd01/mi_servidor_web:v2<br>The push refers to repository [docker.io/alemd01/mi_servidor_web]<br>c93977927766: Pushed <br>2e2c716f2c7f: Pushed <br>8fcfc59d80ac: Layer already exists <br>v2: digest: sha256:04c70a813837a0fbbc176a499732a7d3fa99dd36f6ed3d60bf56b5b9afbf0b1d size: 952<br></code></pre>
<h3 id="por-%C3%BAltimo%2C-baja-la-nueva-imagen-en-el-ordenador-donde-est%C3%A1-corriendo-el-contenedor.-para-hacer-la-implantaci%C3%B3n-de-la-nueva-versi%C3%B3n-debes-borrar-el-contenedor-y-crear-uno-nuevo-desde-la-nueva-versi%C3%B3n-de-la-imagen." tabindex="-1">Por último, baja la nueva imagen en el ordenador donde está corriendo el contenedor. Para hacer la implantación de la nueva versión debes borrar el contenedor y crear uno nuevo desde la nueva versión de la imagen.</h3>
<p>Elimino el contenedor y la imagen:</p>
<pre class="language-txt"><code class="language-txt">usuario@debian:~/docker/taller3$ docker rm -f mi_servidor_web <br>mi_servidor_web<br>usuario@debian:~/docker/taller3$ docker rmi alemd01/mi_servidor_web:v2<br>Untagged: alemd01/mi_servidor_web:v2<br>Untagged: alemd01/mi_servidor_web@sha256:04c70a813837a0fbbc176a499732a7d3fa99dd36f6ed3d60bf56b5b9afbf0b1d<br>Deleted: sha256:4c59dc832620ef19a0c7c8cfc2c8c5aab5b252ee5a95682d1dbb021c7644f8b1<br>Deleted: sha256:9009b939999f9230485edd5be57919a22a076493fb95eb53eea4dde3896f56db<br>Deleted: sha256:1b5da554f6e3376a9dd6cc76706945a46cc49ba8b1217c19b2f9a44938af005f<br>Deleted: sha256:d8e4f0fdb9ec151d0b3e8740cf63c34444e411956a3315aadd9e0075bb2b0c0f<br>Deleted: sha256:291028a34b7b79422480095d3ccef56d931a7d723e7c4c36af9cb0092ecaae4e<br>Deleted: sha256:329429045bff31241bf29767b5f37a38ec89d9430a12c8f874adc346b46534f9<br>Deleted: sha256:c5a25059498db80665ae7743cefdd116beee2b9e433aefdd12f1ecf167aedc01</code></pre>
<p>Hacemos un pull de la imagen en Docker Hub:</p>
<pre class="language-txt"><code class="language-txt">usuario@debian:~/docker/taller3$ docker pull alemd01/mi_servidor_web:v2<br>v2: Pulling from alemd01/mi_servidor_web<br>699c8a97647f: Already exists <br>e45857a00bba: Pull complete <br>5ec4abd0fb7e: Pull complete <br>Digest: sha256:04c70a813837a0fbbc176a499732a7d3fa99dd36f6ed3d60bf56b5b9afbf0b1d<br>Status: Downloaded newer image for alemd01/mi_servidor_web:v2<br>docker.io/alemd01/mi_servidor_web:v2<br></code></pre>
<p>Creamos el contenedor a partir de la imagen:</p>
<pre class="language-txt"><code class="language-txt">usuario@debian:~/docker/taller3$ docker run -d -p 8080:80 --name mi_servidor_web alemd01/mi_servidor_web:v2<br>41549244e7a29291ae4eb1f9ef090ec385fbf4bcb52ee9e29ecbebbd02588f09<br></code></pre>
<p>Accedo mediante mi navegador para comprobar que funciona correctamente:</p>
<p><img src="/img/IAW-T6-T3.3.png" alt="IAW-T6-T3.3.png"></p>
<hr>
<h2 id="documento-realizado-por%3A" tabindex="-1"><strong>Documento realizado por:</strong></h2>
<p>✒️ <strong>Alejandro Montes Delgado</strong> - <em>2º ASIR</em></p>

        </div>
            <p class="uppercase text-xs mt-6">Post anterior.</p>

            <p class="font-bold">
                <a href="/post/ejercicios-con-docker-ii./">Ejercicios con Docker II.</a>
            </p>
        
    </div>

    </main>
    <footer class="bg-gray-900 pb-10">
  <p class="block text-center text-sm mb-6">
    Built by
    <a target="_blank" href="https://github.com/reeseschultz">
      Reese Schultz
    </a>
  </p>

  <a class="block text-center text-sm" href="/privacy-policy">Privacy Policy</a>
</footer>
    <script src="https://unpkg.com/clipboard@2/dist/clipboard.min.js"></script>
    <script src="/assets/main.bundle.js"></script>
  </body>
</html>
