<h2 id="funcionamiento-de-los-ejercicios" tabindex="-1">Funcionamiento de los ejercicios</h2>
<h3 id="3.-a%C3%B1ade-dos-columnas-llamadas-distancia-y-duraci%C3%B3n-(en-formato-hh%3Ami)-a-la-tabla-vuelos-y-rell%C3%A9nalas-adecuadamente.-realiza-un-trigger-que-garantice-que-un-avi%C3%B3n-asignado-a-un-viaje-tenga-una-autonom%C3%ADa-superior-al-menos-en-un-25%25-a-la-distancia-a-recorrer." tabindex="-1">3. Añade dos columnas llamadas Distancia y Duración (en formato hh:mi) a la tabla Vuelos y rellénalas adecuadamente. Realiza un trigger que garantice que un avión asignado a un viaje tenga una autonomía superior al menos en un 25% a la distancia a recorrer.</h3>
<p><strong>Pruebas con el update:</strong></p>
<ul>
<li>Update que la autonomía del avión es superior en un 25% superior a la distancia:</li>
</ul>
<pre class="language-sql"><code class="language-sql"><span class="token keyword">UPDATE</span> VUELOS <span class="token keyword">SET</span> DISTANCIA<span class="token operator">=</span><span class="token number">800</span> <span class="token keyword">WHERE</span> CODVUELO<span class="token operator">=</span><span class="token string">'IB-5940'</span><span class="token punctuation">;</span></code></pre>
<p><img src="/img/BD-AMD.1.png" alt="BD-AMD.1.png"></p>
<ul>
<li>Update que la autonomía del avión es menor del 25% de la distancia a recorrer.</li>
</ul>
<pre class="language-sql"><code class="language-sql"><span class="token keyword">UPDATE</span> VUELOS <span class="token keyword">SET</span> DISTANCIA<span class="token operator">=</span><span class="token number">5000</span> <span class="token keyword">WHERE</span> CODVUELO<span class="token operator">=</span><span class="token string">'IB-5940'</span><span class="token punctuation">;</span></code></pre>
<p><img src="/img/BD-AMD.2.png" alt="BD-AMD.2.png"></p>
<p><strong>Pruebas con el insert:</strong></p>
<ul>
<li>Insert que la autonomía del avión es superior en un 25% superior a la distancia:</li>
</ul>
<pre class="language-sql"><code class="language-sql"><span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> VUELOS <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><br>    <span class="token string">'UX-6013'</span><span class="token punctuation">,</span><br>    <span class="token string">'PMI'</span><span class="token punctuation">,</span><br>    <span class="token string">'MAD'</span><span class="token punctuation">,</span><br>    <span class="token string">'Air Europa'</span><span class="token punctuation">,</span><br>    <span class="token string">'Jueves'</span><span class="token punctuation">,</span><br>    TO_DATE<span class="token punctuation">(</span><span class="token string">'10:15'</span><span class="token punctuation">,</span> <span class="token string">'HH24:MI'</span><span class="token punctuation">)</span><span class="token punctuation">,</span><br>    <span class="token string">'EJK000333'</span><span class="token punctuation">,</span><br>    <span class="token string">'HYJ000568'</span><span class="token punctuation">,</span><br>    <span class="token number">782</span><span class="token punctuation">,</span><br>    TO_DATE<span class="token punctuation">(</span><span class="token string">'01:30'</span><span class="token punctuation">,</span><span class="token string">'HH24:MI'</span><span class="token punctuation">)</span><br><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p><img src="/img/BD-AMD.4.png" alt="BD-AMD.4.png"></p>
<ul>
<li>Insert que la autonomía del avión es menor del 25% de la distancia a recorrer.</li>
</ul>
<pre class="language-sql"><code class="language-sql"><span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> VUELOS <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><br>    <span class="token string">'UX-6013'</span><span class="token punctuation">,</span><br>    <span class="token string">'PMI'</span><span class="token punctuation">,</span><br>    <span class="token string">'MAD'</span><span class="token punctuation">,</span><br>    <span class="token string">'Air Europa'</span><span class="token punctuation">,</span><br>    <span class="token string">'Jueves'</span><span class="token punctuation">,</span><br>    TO_DATE<span class="token punctuation">(</span><span class="token string">'10:15'</span><span class="token punctuation">,</span> <span class="token string">'HH24:MI'</span><span class="token punctuation">)</span><span class="token punctuation">,</span><br>    <span class="token string">'EJK000333'</span><span class="token punctuation">,</span><br>    <span class="token string">'HYJ000568'</span><span class="token punctuation">,</span><br>    <span class="token number">7820</span><span class="token punctuation">,</span><br>    TO_DATE<span class="token punctuation">(</span><span class="token string">'01:30'</span><span class="token punctuation">,</span><span class="token string">'HH24:MI'</span><span class="token punctuation">)</span><br><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p><img src="/img/BD-AMD.3.png" alt="BD-AMD.3.png"></p>
<h3 id="7.-realiza-los-m%C3%B3dulos-de-programaci%C3%B3n-necesarios-para-garantizar-que-una-misma-compa%C3%B1%C3%ADa-no-tiene-m%C3%A1s-de-dos-vuelos-con-el-mismo-origen-y-destino-en-un-mismo-d%C3%ADa-de-la-semana." tabindex="-1">7. Realiza los módulos de programación necesarios para garantizar que una misma compañía no tiene más de dos vuelos con el mismo origen y destino en un mismo día de la semana.</h3>
<p>Inserto un vuelo con el mismo origen y destino y en el mismo día de la semana.</p>
<pre class="language-sql"><code class="language-sql"><span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> VUELOS <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><br>    <span class="token string">'CD-6015'</span><span class="token punctuation">,</span><br>    <span class="token string">'PMI'</span><span class="token punctuation">,</span><br>    <span class="token string">'MAD'</span><span class="token punctuation">,</span><br>    <span class="token string">'Air Europa'</span><span class="token punctuation">,</span><br>    <span class="token string">'Jueves'</span><span class="token punctuation">,</span><br>    TO_DATE<span class="token punctuation">(</span><span class="token string">'14:15'</span><span class="token punctuation">,</span> <span class="token string">'HH24:MI'</span><span class="token punctuation">)</span><span class="token punctuation">,</span><br>    <span class="token string">'CVF000126'</span><span class="token punctuation">,</span><br>    <span class="token string">'FHY000456'</span><span class="token punctuation">,</span><br>    <span class="token number">782</span><span class="token punctuation">,</span><br>    TO_DATE<span class="token punctuation">(</span><span class="token string">'01:30'</span><span class="token punctuation">,</span><span class="token string">'HH24:MI'</span><span class="token punctuation">)</span><br><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p><img src="/img/BD-AMD.5.png" alt="BD-AMD.5.png"></p>
<p>Si insertamos otro vuelo con el mismo origen y destino y en el mismo día de la semana, se dispara el trigger.</p>
<pre class="language-sql"><code class="language-sql"><span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> VUELOS <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><br>    <span class="token string">'CD-6017'</span><span class="token punctuation">,</span><br>    <span class="token string">'PMI'</span><span class="token punctuation">,</span><br>    <span class="token string">'MAD'</span><span class="token punctuation">,</span><br>    <span class="token string">'Air Europa'</span><span class="token punctuation">,</span><br>    <span class="token string">'Jueves'</span><span class="token punctuation">,</span><br>    TO_DATE<span class="token punctuation">(</span><span class="token string">'14:15'</span><span class="token punctuation">,</span> <span class="token string">'HH24:MI'</span><span class="token punctuation">)</span><span class="token punctuation">,</span><br>    <span class="token string">'CVF000126'</span><span class="token punctuation">,</span><br>    <span class="token string">'FHY000456'</span><span class="token punctuation">,</span><br>    <span class="token number">782</span><span class="token punctuation">,</span><br>    TO_DATE<span class="token punctuation">(</span><span class="token string">'01:30'</span><span class="token punctuation">,</span><span class="token string">'HH24:MI'</span><span class="token punctuation">)</span><br><span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p><img src="/img/BD-AMD.6.png" alt="BD-AMD.6.png"></p>
<p>El trigger no funciona bien, ya que al eliminar un vuelo no lo detecta y si se vuelve a insertar salta el trigger cuando no debería de hacerlo.</p>
<h3 id="8.-realiza-los-m%C3%B3dulos-de-programaci%C3%B3n-necesarios-para-garantizar-que-el-n%C3%BAmero-de-auxiliares-de-vuelo-en-un-viaje-es-de-al-menos-uno-por-cada-5-pasajeros-que-realizan-ese-viaje." tabindex="-1">8. Realiza los módulos de programación necesarios para garantizar que el número de auxiliares de vuelo en un viaje es de al menos uno por cada 5 pasajeros que realizan ese viaje.</h3>
<p>Vamos a ingresar pasajeros hasta que salte la excepción. No dejo los inserts aquí ya que el código sería muy largo, todos los inserts se encuentran en el archivo del ejercicio 8. Dejo aquí el resultado de hacer todos los inserts.</p>
<p><img src="img/BD-AMD.7.png" alt="BD-AMD.7.png"></p>
<p>He tenido problemas con la tabla temporal, para que se rellene tenemos que actualizar la tabla auxiliares de viaje para que se rellene</p>
<h3 id="3.-(pl%2Fpgsql)-a%C3%B1ade-dos-columnas-llamadas-distancia-y-duraci%C3%B3n-(en-formato-hh%3Ami)-a-la-tabla-vuelos-y-rell%C3%A9nalas-adecuadamente.-realiza-un-trigger-que-garantice-que-un-avi%C3%B3n-asignado-a-un-viaje-tenga-una-autonom%C3%ADa-superior-al-menos-en-un-25%25-a-la-distancia-a-recorrer." tabindex="-1">3. (pl/pgsql) Añade dos columnas llamadas Distancia y Duración (en formato hh:mi) a la tabla Vuelos y rellénalas adecuadamente. Realiza un trigger que garantice que un avión asignado a un viaje tenga una autonomía superior al menos en un 25% a la distancia a recorrer.</h3>
<p>El primer insert funciona correctamente, en el segundo salta el error.</p>
<pre class="language-sql"><code class="language-sql"> <span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> VUELOS <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><br>     <span class="token string">'UX-6013'</span><span class="token punctuation">,</span><br>     <span class="token string">'PMI'</span><span class="token punctuation">,</span><br>     <span class="token string">'MAD'</span><span class="token punctuation">,</span><br>     <span class="token string">'Air Europa'</span><span class="token punctuation">,</span><br>     <span class="token string">'Jueves'</span><span class="token punctuation">,</span><br>     TO_TIMESTAMP<span class="token punctuation">(</span><span class="token string">'10:15'</span><span class="token punctuation">,</span> <span class="token string">'HH24:MI'</span><span class="token punctuation">)</span><span class="token punctuation">,</span><br>     <span class="token string">'EJK000333'</span><span class="token punctuation">,</span><br>     <span class="token string">'HYJ000568'</span><span class="token punctuation">,</span><br>     TO_TIMESTAMP<span class="token punctuation">(</span><span class="token string">'01:30'</span><span class="token punctuation">,</span><span class="token string">'HH24:MI'</span><span class="token punctuation">)</span><span class="token punctuation">,</span><br>      <span class="token number">782</span><br> <span class="token punctuation">)</span><span class="token punctuation">;</span><br></code></pre>
<p>Este es el insert el cual hace que se dispare el trigger.</p>
<pre class="language-sql"><code class="language-sql"> <span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> VUELOS <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><br>     <span class="token string">'UX-6013'</span><span class="token punctuation">,</span><br>     <span class="token string">'PMI'</span><span class="token punctuation">,</span><br>     <span class="token string">'MAD'</span><span class="token punctuation">,</span><br>     <span class="token string">'Air Europa'</span><span class="token punctuation">,</span><br>     <span class="token string">'Jueves'</span><span class="token punctuation">,</span><br>     TO_TIMESTAMP<span class="token punctuation">(</span><span class="token string">'10:15'</span><span class="token punctuation">,</span> <span class="token string">'HH24:MI'</span><span class="token punctuation">)</span><span class="token punctuation">,</span><br>     <span class="token string">'EJK000333'</span><span class="token punctuation">,</span><br>     <span class="token string">'HYJ000568'</span><span class="token punctuation">,</span><br>     TO_TIMESTAMP<span class="token punctuation">(</span><span class="token string">'01:30'</span><span class="token punctuation">,</span><span class="token string">'HH24:MI'</span><span class="token punctuation">)</span><span class="token punctuation">,</span><br>      <span class="token number">7820</span><br> <span class="token punctuation">)</span><span class="token punctuation">;</span></code></pre>
<p><img src="img/BD-AMD.8.png" alt="BD-AMD.8.png"></p>
